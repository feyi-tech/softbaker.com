"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[52],{30929:function(e,t,n){n.d(t,{j:function(){return i}});var o=n(11163),a=n(67294);const i={error:"ERROR",info:"INFO",warning:"WARNING",warn:"WARNING"};t.Z=()=>{const{pathname:e}=(0,o.useRouter)(),t=()=>{if(window.localStorage)try{const e=JSON.parse(localStorage.getItem("APP_LOGS")||"[]");if("undefined"!==typeof Blob){const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="APP_LOGS_FILE.json",o.click(),URL.revokeObjectURL(n)}else{const t="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),n=document.createElement("a");n.href=t,n.download="APP_LOGS_FILE.json",n.click()}}catch(e){console.error("Failed to download logs",e)}};return(0,a.useEffect)((()=>{console.log("path",e),"/status/download-debug"===e&&t()}),[e]),{logger:(e,t)=>{if(window.localStorage){let o=[];try{o=JSON.parse(localStorage.getItem("APP_LOGS")||"[]")}catch(n){console.error("Failed to parse logs from localStorage",n)}o.push("".concat((new Date).toISOString()," => [").concat(t,"] ").concat(e));let a=JSON.stringify(o);for(;new Blob([a]).size>5120;)o.shift(),a=JSON.stringify(o);try{localStorage.setItem("APP_LOGS",a)}catch(n){console.error("Failed to save logs to localStorage",n)}}},downloadLogs:t}}},35052:function(e,t,n){var o=n(85893),a=n(67294),i=n(94345),r=n(85461),s=n(55154),l=n(48783),c=n(71293),d=n(34292),g=n(6089),f=n(77181),h=n(57369),u=n(13653),p=n(30929);t.Z=e=>{let{galleryKey:t,onClose:n,onImage:m,maxFileSize:w,isOtherFiles:y,onThumb:S,title:v,message:x,hoverMessage:j,ruleMessage:b,useImageText:I,accept:O}=e;const{logger:F}=(0,p.Z)(),[R,L]=(0,a.useState)(!1),[z,C]=(0,a.useState)(!1),[E,D]=(0,a.useState)(null),[U,A]=(0,a.useState)();(0,a.useEffect)((()=>{if(t){const e=(0,h.fe)(t);if(e){D(e);const t=(0,u.g8)(e);e&&A(t)}}}),[t]);const[N,k]=(0,a.useState)();return(0,a.useEffect)((()=>{U&&E&&S?S(U,E).then((e=>{k(e)})).catch((e=>{console.error("handleUseImage: ",e.message),k(void 0)})):k(E)}),[E]),(0,o.jsx)(i.Z,{title:v,isOpen:!0,onClose:()=>n(),children:(0,o.jsxs)(l.g,{p:"0.5rem",id:"upload-area",justifyContent:"center",alignItems:"center",mb:4,width:"100%",height:"300px",cursor:"pointer",border:"4px dashed ".concat(R?"#dd6b20":"#ccc"),onDragEnter:e=>{e.preventDefault(),L(!0)},onDragOver:e=>{e.preventDefault()},onDragLeave:e=>{e.preventDefault(),L(!1)},onDrop:async e=>{if(z)return;e.preventDefault(),L(!1);const t=e.dataTransfer.files;if(t.length>0){const e=new FileReader,n=t[0];e.onload=async e=>{if(w&&w>0&&!y&&n.size>w){C(!0);const e=await(0,f.t)(n,w);D(e.base64),A(e.file),C(!1)}else{var t;const o=null===(t=e.target)||void 0===t?void 0:t.result;D(o),A(n)}},e.readAsDataURL(n)}},children:[(0,o.jsx)(s.DUB,{size:"2rem"}),(0,o.jsxs)(l.g,{alignItems:"center",children:[(0,o.jsx)(c.x,{as:"div",fontSize:"12px",children:R?j:x}),(0,o.jsx)(c.x,{as:"div",fontSize:"14px",children:"OR"}),(0,o.jsx)(r.Z,{status:"info",mb:"1rem",onClick:()=>{if(F("handleClickUpload.called:",p.j.info),z)return void F("handleClickUpload.aborted: processing in progress",p.j.warning);const e=document.createElement("input");e.type="file",e.accept=O||"image/*",e.style.display="none",document.body.appendChild(e),e.addEventListener("change",(async t=>{const n=t.target.files;if(document.body.removeChild(e),n&&n.length>0){const e=n[0];F("File selected: ".concat(JSON.stringify({name:e.name,size:e.size,type:e.type})),p.j.info);const t=new FileReader;t.onload=async t=>{var n;F("FileReader.onload fired:",p.j.info);const o=null===(n=t.target)||void 0===n?void 0:n.result;if(o)if(w&&w>0&&!y&&e.size>w){F("File size exceeds maxFileSize, resizing...",p.j.info),C(!0);const t=await(0,f.t)(e,w);F("Image resized.size: ".concat(t.base64.length),p.j.info),D(t.base64),A(t.file),C(!1)}else F("File within size limit, setting base64 image",p.j.warn),D(o),A(e);else F("FileReader result is empty or undefined",p.j.error)},t.onerror=e=>{F("FileReader.onerror fired: ".concat((null===e||void 0===e?void 0:e.message)||e),p.j.error)},t.readAsDataURL(e)}else F("No file selected or file input is empty",p.j.warn)})),e.click()},display:z?"none":"block",children:"Click to Upload"}),(0,o.jsxs)(c.x,{as:"div",fontSize:"12px",textAlign:"center",children:["(",b,")"]}),z?(0,o.jsx)(c.x,{as:"div",fontSize:"12px",fontStyle:"italic",color:"#3182ce",children:"Processing image. Please wait..."}):null,(0,o.jsx)(d.U,{justifyContent:"center",alignItems:"flex-end",flexWrap:"wrap",children:E&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.E,{src:N||"",bg:"#cfcfcf",width:"auto",height:"70px",border:"4px ridge #dd6b20"}),(0,o.jsx)(r.Z,{status:"warning",h:"70px",onClick:()=>{m(U,E,N)},disabled:z,fontStyle:z?"italic":"normal",children:z?"Please wait...":I})]})})]})]})})}},13653:function(e,t,n){function o(e,t,n){var o;const[a,i]=e.split(",");if(n=n||(null===(o=a.match(/:(.*?);/))||void 0===o?void 0:o[1]),!t){const e=(null===n||void 0===n?void 0:n.split("/")[1])||"bin";t="file_".concat(Date.now(),".").concat(e)}const r=window.atob(i),s=r.length,l=new Uint8Array(s);for(let d=0;d<s;d++)l[d]=r.charCodeAt(d);const c=new Blob([l],{type:n});return new File([c],t,{type:n})}n.d(t,{g8:function(){return o}})},57369:function(e,t,n){n.d(t,{OL:function(){return i},fe:function(){return a},ht:function(){return o}});const o={faceshot:"SOFTBAKER_FACESHOT"},a=e=>localStorage.getItem(e),i=e=>{((e,t)=>{try{localStorage.setItem(e,t)}catch(n){try{localStorage.clear(),localStorage.setItem(e,t)}catch(n){}}})(o.faceshot,e)}},77181:function(e,t,n){n.d(t,{t:function(){return o}});const o=async(e,t)=>new Promise(((n,o)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=async o=>{var a;const i=new Image;i.src=null===(a=o.target)||void 0===a?void 0:a.result,i.onload=()=>{const o=document.createElement("canvas"),a=o.getContext("2d");o.width=i.width,o.height=i.height,a.drawImage(i,0,0);const r=a.getImageData(0,0,o.width,o.height).data.length/(o.width*o.height),s=t/r,l=Math.sqrt(s);let c,d;i.width>=i.height?(c=l,d=i.height*(l/i.width)):(d=l,c=i.width*(l/i.height)),o.width=c,o.height=d,a.drawImage(i,0,0,c,d),o.toBlob((t=>{if(t){const a=new File([t],e.name,{type:e.type});n({base64:o.toDataURL(),file:a})}}),e.type)}},a.onerror=e=>o(e)}))}}]);