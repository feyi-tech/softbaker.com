"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[843],{70485:function(e,t,n){n.d(t,{Z:function(){return Z}});var i=n(85893),a=n(67294),o=n(57747),r=n(48783),l=n(34292),s=n(93717),c=n(15948),d=n(98687),u=n(75863),h=n(14132),f=n(36238),p=n(55154),g=n(53754),m=n(38118),v=n(94345),x=n(71293),y=n(85461),b=n(33471),w=n(73804),k=n(96918);var j=e=>{let{textAreaData:t,delimiter:n,value:l,onChange:s,suggestions:c,onSuggestionSelected:d,...u}=e;const[h,p]=(0,a.useState)(l||""),[g,m]=(0,a.useState)([]),[v,y]=(0,a.useState)(!1),[b,j]=(0,a.useState)(0);(0,a.useEffect)((()=>{p(l||"")}),[l]);const S=e=>{((e,t)=>{if(null==e||void 0==e)return;p(e),j(t);const i=e.slice(0,t).lastIndexOf(n),a=e.slice(i+n.length,t),o=["id",...c];if(-1===i||!/^[a-zA-Z]*$/.test(a)&&0!==a.length)y(!1);else{let e;e=0===a.length?o:o.filter((e=>e.toLowerCase().startsWith(a.toLowerCase()))),m(e),y(e.length>0)}s&&s(e)})(e.target.value,e.target.selectionStart||0)};return(0,i.jsxs)(o.xu,{w:"100%",overflowX:"hidden",...u,children:[(0,i.jsx)(f.Z,{w:"100%",value:h,onChange:(e,t)=>S(t),onClick:e=>S(e),onKeyUp:e=>S(e),...t}),v&&(0,i.jsx)(r.g,{position:"absolute",zIndex:"5",w:"100%",boxShadow:"md",borderRadius:"md",height:"120px",width:"100%",overflowY:"auto",overflowX:"hidden",bg:(0,k.Z)("dropDownBg.light","dropDownBg.dark"),children:(0,i.jsx)(w.aV,{w:"100%",overflowX:"hidden",children:g.map(((e,t)=>(0,i.jsx)(w.HC,{overflowX:"hidden",p:"2",cursor:"pointer",_hover:{border:"1px solid",borderRadius:"3px"},onClick:()=>(e=>{const t=h.slice(0,b).lastIndexOf(n),i=h.slice(0,t+n.length)+e+h.slice(b);p(i),y(!1),n.length,e.length,d(e,t+n.length,i)})(e),children:(0,i.jsx)(x.x,{as:"div",children:e})},t)))})})]})},S=n(467),C=n(86455),T=n.n(C);const E="FIELDS_SETTINGS",_=()=>{const e=localStorage.getItem(E);let t={};try{e&&(t=JSON.parse(e))}catch(n){}return t};var I=e=>{let{fields:t,field:n,images:r,submitButtonText:s,onSettingsUpdated:c,onDelete:d}=e;const[u,h]=(0,a.useState)({}),[g,m]=(0,a.useState)({}),[w,k]=(0,a.useState)(null),[C,I]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(n){var e,t,i,a,o,r;const l={...n};let s=_();!l.helperText&&(null===(e=s[n.id])||void 0===e?void 0:e.helperText)&&(l.helperText=s[n.id].helperText),!l.info&&(null===(t=s[n.id])||void 0===t?void 0:t.info)&&(l.info=s[n.id].info),!l.ruleMessage&&(null===(i=s[n.id])||void 0===i?void 0:i.ruleMessage)&&(l.ruleMessage=s[n.id].ruleMessage),!l.placeholder&&(null===(a=s[n.id])||void 0===a?void 0:a.placeholder)&&(l.placeholder=s[n.id].placeholder),!l.name&&(null===(o=s[n.id])||void 0===o?void 0:o.name)&&(l.name=s[n.id].name),!l.optional&&(null===(r=s[n.id])||void 0===r?void 0:r.optional)&&(l.optional=s[n.id].optional),h(l)}}),[n]),(0,a.useEffect)((()=>{}),[u]);const[F,M]=(0,a.useState)(!1),O=e=>{if(n.id){if(Object.values(e).length>0){const t=Object.values(e)[0];if(!("string"===typeof t&&0==t.length)){let t=_();t[n.id]={...t[n.id]||{},...e},localStorage.setItem(E,JSON.stringify(t))}}h({...u,...e})}},A=e=>{const t={},n=e.split(",");for(const i of n){const e=i,[n,a]=e.split(":").map((e=>e));if(console.log("mapifyList:0",i,n,a),void 0!=a){t[n.trim().toLowerCase().replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_")]={name:n,value:a}}else{t[n.trim().toLowerCase().replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_")]={name:n,value:n}}}return console.log("mapifyList",t),t};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.U,{children:[(0,i.jsx)(o.xu,{onClick:()=>{M(!0)},cursor:"pointer",mr:4,children:(0,i.jsx)(p.rU2,{size:"1.5rem",color:["gen","defgen","date"].includes(n.type)?"#dd6b20":"text_select"==n.type?"#3182ce":"#38a169"})}),(0,i.jsx)(o.xu,{onClick:d,cursor:"pointer",justifyContent:"flex-start",alignItems:"center",children:(0,i.jsx)(p.Xm5,{size:"1.2rem",color:"#e53e3e"})})]}),F?(0,i.jsxs)(v.Z,{title:"".concat(n.name||""," settings"),isOpen:!0,onClose:()=>{M(!1)},dontCloseOnOverlayClick:C,children:[(0,i.jsxs)(o.xu,{height:"50vh",pos:"relative",overflowY:"auto",overflowX:"hidden",px:"0.5rem",children:[(0,i.jsx)(x.x,{as:"div",display:"none",children:n.type}),(0,i.jsx)(f.Z,{w:"100%",mb:4,title:"Field Type",placeholder:"Select Field Type",helperText:"Select the type you want for this field.",value:null===u||void 0===u?void 0:u.type,type:f.Z.TYPES.select,options:S.eh,onOptionValue:e=>e,onOptionName:e=>e,onChange:e=>{e&&h({...u,type:e})},errorMessage:g.type}),["gen","defgen","date"].includes(null===u||void 0===u?void 0:u.type)?(0,i.jsx)(j,{w:"100%",textAreaData:{id:"gen",key:"gen",title:"Text Generation Code",helperText:"".concat((0,b.VH)(n.placeholder||""),"."),info:"This is where you enter the code for the text generation: ".concat((0,b.VH)(n.placeholder||""),"."),type:f.Z.TYPES.textarea,value:null===u||void 0===u?void 0:u.code,onChange:e=>{e&&h({...u,code:e})},errorMessage:g.code},mb:4,delimiter:"{",suggestions:Object.keys(t),onSuggestionSelected:(e,t,n)=>{n&&h({...u,code:n})}}):null,["text_select"].includes(null===u||void 0===u?void 0:u.type)?(0,i.jsx)(f.Z,{w:"100%",id:"selections",title:"Options",mb:4,helperText:"Separate the options you want to list with commas. Exaple: 'Blue:BLU, Green'",info:"This is where you list the options you want to show by separating them with commas.",type:f.Z.TYPES.textarea,value:(e=>{const t=[];for(const n in e){const{name:i,value:a}=e[n];i===a?t.push(i):t.push("".concat(i,":").concat(a))}return t.join(",")})(null===u||void 0===u?void 0:u.selections),onChange:e=>{e&&O({selections:A(e)})},errorMessage:g.selections},"selections"):null,["image_upload","faceshot"].includes(null===u||void 0===u?void 0:u.type)?(0,i.jsx)(f.Z,{w:"100%",id:"upload",title:"File Rule",mb:4,helperText:'Enter the rule of the file. e.g "For best result, upload a 300x300 image."',info:'This is where you enter the rule of the file. e.g "For best result, upload a 300x300 image."',type:f.Z.TYPES.text,value:null===u||void 0===u?void 0:u.ruleMessage,onChange:e=>{e&&O({ruleMessage:e})},errorMessage:g.ruleMessage},"upload"):null,(0,i.jsx)(f.Z,{w:"100%",id:"name",title:"Name",mb:4,helperText:"Enter the text that will show as the name of the field.",info:"This is where you enter the text that will show as the name of the field.",type:f.Z.TYPES.text,value:null===u||void 0===u?void 0:u.name,onChange:e=>{if(e)if("image_select"!=u.type)O({name:e});else{const t=u.options||{},n={};for(const[i,a]of Object.entries(t))n[i]={...a,name:((null===a||void 0===a?void 0:a.name)||"").replace(u.name,e)};O({name:e,options:n})}},errorMessage:g.name},"name"),["text","textarea","defgen","text_select","date"].includes(null===u||void 0===u?void 0:u.type)?(0,i.jsx)(f.Z,{w:"100%",id:"placeholder",title:"Placeholder",mb:4,helperText:"Enter the text that will show behind the text field as an example input.",info:"This is where you enter the text that will show behind the text field as an example input.",type:f.Z.TYPES.textarea,value:null===u||void 0===u?void 0:u.placeholder,onChange:e=>{e&&O({placeholder:e})},errorMessage:g.placeholder},"placeholder"):null,"textarea"==(null===u||void 0===u?void 0:u.type)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{w:"100%",id:"maxCharsPerLine",title:"Max Chars Per Line",mb:4,helperText:"Enter the maximum number of characters per line.",info:"This is where you enter the maximum number of characters per line.",type:f.Z.TYPES.number,value:null===u||void 0===u?void 0:u.maxCharsPerLine,onChange:e=>{e&&O({maxCharsPerLine:e})},errorMessage:g.maxCharsPerLine,numberDecimals:0},"maxCharsPerLine"),(0,i.jsx)(f.Z,{w:"100%",id:"maxChars",title:"Max Chars",mb:4,helperText:"Enter the maximum number of total characters.",info:"This is where you enter the maximum number of total characters per line.",type:f.Z.TYPES.number,value:null===u||void 0===u?void 0:u.maxChars,onChange:e=>{e&&O({maxChars:e})},errorMessage:g.maxChars,numberDecimals:0},"maxChars")]}):null,["text","textarea","defgen"].includes(null===u||void 0===u?void 0:u.type)?(0,i.jsx)(f.Z,{w:"100%",id:"maxCharsBeforeScale",title:"Font Scale-Down Max Chars",mb:4,helperText:"Enter the maximum number of total characters before the font size is scaled down.",info:"This is where you enter the maximum number of total characters the font size is scaled down.",type:f.Z.TYPES.number,value:null===u||void 0===u?void 0:u.maxTextBeforeScaleDown,onChange:e=>{e&&O({maxTextBeforeScaleDown:e})},errorMessage:g.maxTextBeforeScaleDown,numberDecimals:0},"maxCharsBeforeScale"):null,"gen"!==(null===u||void 0===u?void 0:u.type)?(0,i.jsx)(f.Z,{w:"100%",id:"helper_text",title:"Helper Text",mb:4,helperText:"Enter the text that will show below this field just like this.",info:"This is where you enter the text that will show below this field.",type:f.Z.TYPES.text,value:null===u||void 0===u?void 0:u.helperText,onChange:e=>{e&&O({helperText:e})},errorMessage:g.helperText},"helper_text"):null,["qrcode","checkbox","gen"].includes(null===u||void 0===u?void 0:u.type)?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(f.Z,{w:"100%",id:"info",title:"Info Text",mb:4,helperText:"Enter the text that will show when the user clicks the info icon on this field.",info:"This is where you enter the text that will show when the user clicks the info icon on this field just like this.",type:f.Z.TYPES.textarea,value:null===u||void 0===u?void 0:u.info,onChange:e=>{e&&O({info:e})},errorMessage:g.info},"info"),(0,i.jsx)(f.Z,{w:"100%",id:"optional",title:"Make Optional",mb:4,helperText:"Enable this if you want this field to be optional.",type:f.Z.TYPES.checkbox,value:null===u||void 0===u?void 0:u.optional,onChange:e=>{O({optional:e})},errorMessage:g.optional},"optional")]}),(0,i.jsx)(j,{w:"100%",textAreaData:{id:"visibility",key:"visibility",title:(0,i.jsxs)(x.x,{as:"div",children:["Visibility Anchor",(0,i.jsx)("br",{}),"(CompareCodeResult == ToThis)"]}),helperText:"Enter the field comparison conditional visibility code",info:"This is where you enter the field comparison conditional visibility code.",type:f.Z.TYPES.textarea,value:null===u||void 0===u?void 0:u.visibility_code,onChange:e=>{e&&h({...u,visibility_code:e})},errorMessage:g.code},mb:4,delimiter:"{",suggestions:Object.keys(t),onSuggestionSelected:(e,t,n)=>{n&&h({...u,visibility_code:n})}})]}),(0,i.jsx)(o.xu,{mb:"1rem",children:(0,i.jsx)(y.Z,{status:"warning",mb:"1rem",onClick:()=>{C||((null===u||void 0===u?void 0:u.type)!=(null===n||void 0===n?void 0:n.type)?T().fire({icon:"warning",title:"Field Change Warning!!",text:"You're about to change this field type from ".concat(null===n||void 0===n?void 0:n.type," to ").concat(null===u||void 0===u?void 0:u.type,"! Changing field type without properly understanding how it affects the users can cause a bad user experience and might require deleting the tool and then re-uploading disruptively to fix."),confirmButtonText:"I Understand, Continue",cancelButtonText:"Cancel",showConfirmButton:!0,showCancelButton:!0}).then((e=>{M(!1),e.isConfirmed?c(u,null):c({...u,type:null===n||void 0===n?void 0:n.type},null)})):(M(!1),c(u,null)))},disabled:C,children:C?"Please wait...":s||"Submit Settings"})})]}):null]})},F=n(23596),M=n(10151),O=n(57369),A=n(20967);var P=e=>{let{onAdd:t,...n}=e;const{isOpen:r,onOpen:s,onClose:c}=(0,A.q)(),[d,u]=(0,a.useState)(),[h,g]=(0,a.useState)(),[m,x]=(0,a.useState)(),[b,w]=(0,a.useState)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.U,{justifyContent:"flex-end",alignItems:"center",...n,children:(0,i.jsx)(y.Z,{leftIcon:(0,i.jsx)(p.wEH,{}),status:"warning",onClick:s,children:"Add Field"})}),r?(0,i.jsxs)(v.Z,{title:"Ad Field",isOpen:!0,onClose:c,children:[(0,i.jsxs)(o.xu,{height:"50vh",pos:"relative",overflowY:"auto",overflowX:"hidden",px:"0.5rem",children:[(0,i.jsx)(f.Z,{w:"100%",mb:4,name:"Field Type",placeholder:"Select Field Type",helperText:"Select the type of the field to add.",value:d,type:f.Z.TYPES.select,options:S.Z9,onOptionValue:e=>e,onOptionName:e=>e,onChange:u,errorMessage:m}),(0,i.jsx)(f.Z,{w:"100%",id:"name",title:"Field Name",mb:4,helperText:"Enter the text that will show as the name of the field.",info:"This is where you enter the text that will show as the name of the field.",type:f.Z.TYPES.text,value:h,onChange:g,errorMessage:b},"name")]}),(0,i.jsx)(o.xu,{mb:"1rem",children:(0,i.jsx)(y.Z,{status:"warning",mb:"1rem",onClick:()=>{x(""),w("");var e,n=!1;d?S.Z9.includes(d)||(n=!0,x("Invalid field type.")):(n=!0,x("Please select a field type.")),h&&0!=h.length||(n=!0,w("Please enter the field name.")),n||(c(),t({type:d,name:h,id:"".concat((e=h,e.trim().toLowerCase().replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_")),".").concat(d)}))},children:"Submit Field"})})]}):null]})},N=n(5555),D=n(30929);var Z=e=>{let{created:t,showFieldsErrors:n,fields:v,images:x,masks:y,data:w,isFieldsEditMode:k,isDragable:j,onDragged:S,onFieldDataChange:C,onAllFieldsDataChange:E,fieldDataErrorMessage:_,onSetFieldDataErrorMessage:A,minSignatureWidth:Z,maxSignatureWidth:L,editableFields:z}=e;const{logger:Y}=(0,D.Z)(),[R,U]=(0,a.useState)(Object.values(v)),[B,W]=(0,a.useState)(!1);(0,a.useEffect)((()=>{U(Object.values(v));const e={...w};for(const t of Object.values(v))"image_select"==t.type&&t.options&&!e[t.id]&&(e[t.id]=Object.keys(t.options)[0]);Object.keys(e).length>0&&JSON.stringify(e)!=JSON.stringify(w)&&E(e)}),[v,w]);const H=(e,t)=>{let n=null;return e.maxChars&&"".concat(t).length>e.maxChars&&(n="".concat(e.name," should not be greater than ").concat(e.maxChars," characters.")),A({..._,[e.id]:n}),n};return R&&0!=R.length?(0,i.jsxs)(o.xu,{as:c.Z5,onDragEnd:e=>{if(!e.destination||!S)return;const t=Array.from(R),[n]=t.splice(e.source.index,1);t.splice(e.destination.index,0,n);const i=t.reduce(((e,t,n)=>(e[t.id]={...t,index:n},e)),{});console.info("parsedSvg:updatedFields",i),S(i)},p:"0px !important",children:[k?(0,i.jsx)(P,{my:4,onAdd:e=>{if(v[e.id])T().fire({icon:"error",title:"Field Error",text:"Duplicate field error!"});else{if(!S)return;const t=[e,...R].reduce(((e,t,n)=>(e[t.id]={...t,index:n},e)),{});console.info("parsedSvg:updatedFields",t),S(t)}}}):null,(0,i.jsx)(c.bK,{droppableId:"fields",children:e=>(0,i.jsxs)(r.g,{w:"100%",ref:e.innerRef,...e.droppableProps,children:[R.map(((e,a)=>(0,i.jsx)(c._l,{draggableId:e.id,index:a,isDragDisabled:!j,children:a=>{const r=(e=>{const a={key:e.id,id:e.id,disabled:t&&!(z||[]).includes(e.id),title:"".concat(e.name||"").concat(e.optional?"(Optional)":""),helperText:e.helperText||"",info:e.info||"",placeholder:(0,b.VH)(e.placeholder||e.name||""),onChange:t=>{H(e,t),C(e.id,t)},errorMessage:n?_[e.id]:null,labelEndIcon:k?(0,i.jsx)(I,{fields:v,field:e,images:x,onDelete:()=>{T().fire({icon:"warning",title:"Delete field",text:"Are you sure you want to delete this field?",showCancelButton:!0,showConfirmButton:!0,confirmButtonText:"Yes, Delete",cancelButtonText:"No!"}).then((t=>{if(t.isConfirmed){const t={...v};if(delete t[e.id],!S)return;const n=Object.values(t).reduce(((e,t,n)=>(e[t.id]={...t,index:n},e)),{});S(n)}}))},onSettingsUpdated:(t,n)=>{const i={...v,[t.id]:{...e,...t}},a=n?{...y||{},...n}:null;S&&S(i,a),console.info("onSettingsUpdated.updated",i,a)}}):null,message:"Drag and Drop image here",hoverMessage:"Drop the image here",ruleMessage:e.ruleMessage||"Make sure you're uploading an image file.",useImageText:"Use Image"};if(!(0,F.LV)(e,v,w))return k?(0,i.jsx)(f.Z,{width:"100%",...a,value:w[e.id]||"",type:f.Z.TYPES.none}):null;switch(e.type){case"image_upload":case"faceshot":return(0,i.jsx)(d.Z,{galleryKey:"faceshot"==e.type?O.ht.faceshot:void 0,width:"100%",...a,disabled:!1,thumbnail:w[e.id]&&!(0,F.zI)(w[e.id])?(0,g.VT)("other_tools_data",w.id,e.id):w[e.id]&&(0,F.zI)(w[e.id])?w[e.id]:void 0,maxFileSize:1048576,removeBackground:"faceshot"==e.type,imageCropArg:"faceshot"==e.type?{message:"Make sure the image is cropped from the top of the head to above the chests with the shoulders visible as shown in the sample image.",sampleImage:"/res/sample-image-crop.png"}:void 0,onChange:(t,n)=>{if(n)try{if(Y("faceshot.base64String.size: ".concat(n.length),D.j.info),"faceshot"==e.type)try{(0,O.OL)(n),Y("faceshot.saved.ok",D.j.info)}catch(i){Y("faceshot.save.error: ".concat(null===i||void 0===i?void 0:i.message),D.j.error)}try{H(e,n),Y("faceshot.onFieldDataCheckInfo.ok",D.j.info)}catch(i){Y("faceshot.onFieldDataCheckInfo.error: ".concat(null===i||void 0===i?void 0:i.message),D.j.error)}try{C(e.id,n),Y("faceshot.onFieldDataChange.ok",D.j.info)}catch(i){Y("faceshot.onFieldDataChange.error: ".concat(null===i||void 0===i?void 0:i.message),D.j.error)}}catch(i){Y("faceshot.x.error: ".concat(null===i||void 0===i?void 0:i.message),D.j.error)}else Y("faceshot.base64String.empty",D.j.warning)}});case"sign":return(0,i.jsx)(h.Z,{width:"100%",...a,disabled:!1,minSignatureWidth:Z||1,maxSignatureWidth:L||1,thumbnail:w[e.id]&&!(0,F.zI)(w[e.id])?(0,g.VT)("other_tools_data",w.id,e.id):w[e.id]&&(0,F.zI)(w[e.id])?w[e.id]:void 0});case"image_select":var r;const t=Object.values(e.options||{}).map((t=>({id:t.id,title:(0,F.Ok)(e.name,t.name),thumbnail:(0,F.gJ)(t.id,x,"_thumbnail"),image:{base:(0,F.gJ)(t.id,x,"_512"),md:(0,F.gJ)(t.id,x,"_728"),lg:(0,F.gJ)(t.id,x)}})))||[];return(0,i.jsx)(u.Z,{width:"100%",...a,thumbnail:(0,F.gJ)(w[e.id],x,"_thumbnail"),imageTitle:(0,F.Ok)(e.name,e.options?null===(r=e.options[w[e.id]])||void 0===r?void 0:r.name:""),onChange:t=>{const n=t;H(e,n.id),C(e.id,n.id)},options:t});case"text":case"textarea":return(0,i.jsx)(f.Z,{width:"100%",...a,value:w[e.id]||"",type:e.type,maxTextLimit:e.maxChars?e.maxChars:void 0});case"date":return(0,i.jsx)(f.Z,{width:"100%",...a,value:(0,N.Ft)(w[e.id]),title:k?"".concat(a.title," (").concat((0,b.VH)(e.placeholder||""),")"):a.title,type:e.type,onChange:t=>{H(e,(0,N.SG)(t)),C(e.id,(0,N.SG)(t))}});case"text_select":return(0,i.jsx)(f.Z,{w:"100%",...a,placeholder:"-- Select ".concat((0,g.kC)(e.name||"")," --"),value:w[e.id]||"",type:f.Z.TYPES.select,options:Object.keys(e.selections||{}),onOptionValue:e=>e,onOptionName:t=>{var n,i;const a=((null===(n=(e.selections||{})[t]||"")||void 0===n?void 0:n.name)||"").trim(),o=((null===(i=(e.selections||{})[t]||"")||void 0===i?void 0:i.value)||"").trim();var r=k&&a!=o?"(".concat(o,")"):"";return"".concat(a).concat(r)}});case"defgen":return(0,i.jsx)(f.Z,{width:"100%",...a,type:f.Z.TYPES.text,value:w[e.id]||""});case"gen":return k?(0,i.jsx)(f.Z,{width:"100%",...a,type:f.Z.TYPES.viewonly,placeholder:"",helperText:(0,b.VH)(e.placeholder||""),value:(0,M.l)(e.code,w,F.oh,((e,t)=>{var n,i;return"text_select"==(null===(n=v[e])||void 0===n?void 0:n.type)?((null===(i=v[e].selections[t])||void 0===i?void 0:i.value)||"").trim():t}))}):null;case"checkbox":return(0,i.jsx)(f.Z,{...a,type:e.type,value:w[e.id]||!1});case"qrcode":return k?(0,i.jsxs)(o.xu,{w:"100%",h:"40px",border:"1px solid #dfdfdf",children:["QR CODE | ",a.title]}):null;default:return null}})(e);return r?(0,i.jsx)("div",{ref:a.innerRef,...a.draggableProps,...a.dragHandleProps,style:{...a.draggableProps.style,width:"100%"},children:(0,i.jsxs)(l.U,{w:"100%",justifyContent:"center",alignItems:e.helperText||["gen"].includes(e.type)&&e.placeholder?"center":"flex-end",mb:4,children:[(0,i.jsx)(o.xu,{width:{base:"100%",md:j?"90%":"100%"},children:r}),(0,i.jsxs)(s.k,{display:{base:"none",md:j?"flex":"none"},w:"40px",h:"40px",border:"1px dashed",pos:"relative",justifyContent:"center",alignItems:"center",children:[(0,i.jsx)(o.xu,{as:p.ZTc,position:"absolute",mb:"25px",size:"10px"}),(0,i.jsx)(o.xu,{as:p.NWQ,position:"absolute",mt:"25px",size:"10px"})]})]})}):(0,i.jsx)("div",{ref:a.innerRef,...a.draggableProps,...a.dragHandleProps,style:{display:"none"}})}},e.id))),e.placeholder]})})]}):(0,i.jsx)(m.Z,{message:"Loading template assets...",minH:"100px"})}},98226:function(e,t,n){n.d(t,{ZP:function(){return ne},OD:function(){return q}});var i=n(85893),a=n(56691),o=n(96918),r=n(34292),l=n(71293),s=n(98303),c=n(57747),d=n(48783),u=n(55154),h=n(67294),f=n(79230),p=n(85431),g=n(33871),m=n(23596),v=n(36238),x=n(88772),y=n(81136),b=n(6089),w=n(80203),k=n(94345),j=n(59501),S=n(85461);const C=(e,t,n)=>new Promise(((i,a)=>{const o=document.createElement("canvas"),r=o.getContext("2d");if(!r)return a(new Error("Canvas not supported"));const l=new Image;l.src=e,l.onload=()=>{o.width=l.width,o.height=l.height,r.drawImage(l,0,0);const e=r.getImageData(0,0,o.width,o.height);t(e,n),r.putImageData(e,0,0),i(o.toDataURL())},l.onerror=a})),T=["0.1","0.2","0.3","0.4","0.5","0.6","0.7"],E={Whitescale:{id:"Whitescale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=255,t[n+1]=255,t[n+2]=255}))},Blackscale:{id:"Blackscale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+1]=0,t[n+2]=0}))},Greyscale:{id:"Greyscale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4){const e=(t[n]+t[n+1]+t[n+2])/3;t[n]=e,t[n+1]=e,t[n+2]=e}}))},Redscale:{id:"Redscale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n+1]=0,t[n+2]=0}))},Greenscale:{id:"Greenscale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+2]=0}))},Bluescale:{id:"Bluescale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+1]=0}))},Sepia:{id:"Sepia",filter:(e,t)=>C(e,(e=>{var n;const i=null!==(n=null===t||void 0===t?void 0:t.rMult)&&void 0!==n?n:.393;var a;const o=null!==(a=null===t||void 0===t?void 0:t.gMult)&&void 0!==a?a:.769;var r;const l=null!==(r=null===t||void 0===t?void 0:t.bMult)&&void 0!==r?r:.189;var s;const c=null!==(s=null===t||void 0===t?void 0:t.rAdd)&&void 0!==s?s:.349;var d;const u=null!==(d=null===t||void 0===t?void 0:t.gAdd)&&void 0!==d?d:.686;var h;const f=null!==(h=null===t||void 0===t?void 0:t.bAdd)&&void 0!==h?h:.272,p=e.data;for(let t=0;t<p.length;t+=4){const e=p[t],n=p[t+1],a=p[t+2],r=i*e+o*n+l*a,s=c*e+u*n+f*a,d=f*e+f*n+f*a;p[t]=r>255?255:r,p[t+1]=s>255?255:s,p[t+2]=d>255?255:d}}))},Guassianblur:{id:"Guassianblur",filter:(e,t)=>C(e,((e,t)=>{const n=Number(T[0]),i=Number(T[T.length-1]);var a=(null===t||void 0===t?void 0:t.radius)&&!isNaN(t.radius)?Number(t.radius):n;a>i&&(a=n),a*=10;const o=e.data,r=e.width,l=e.height,s=new Uint8ClampedArray(o);!function(){for(let e=0;e<l;e++)for(let t=0;t<r;t++){let n=0,i=0,l=0,c=0,d=0;for(let o=-a;o<=a;o++){const a=t+o;if(a>=0&&a<r){const t=4*(e*r+a);n+=s[t],i+=s[t+1],l+=s[t+2],c+=s[t+3],d++}}const u=4*(e*r+t);o[u]=n/d,o[u+1]=i/d,o[u+2]=l/d,o[u+3]=c/d}}(),function(){for(let e=0;e<r;e++)for(let t=0;t<l;t++){let n=0,i=0,c=0,d=0,u=0;for(let o=-a;o<=a;o++){const a=t+o;if(a>=0&&a<l){const t=4*(a*r+e);n+=s[t],i+=s[t+1],c+=s[t+2],d+=s[t+3],u++}}const h=4*(t*r+e);o[h]=n/u,o[h+1]=i/u,o[h+2]=c/u,o[h+3]=d/u}}()}),t),render:e=>{let{filterArgs:t,setFilterArgs:n}=e;return(0,i.jsx)(c.xu,{w:"100%",children:(0,i.jsx)(v.Z,{w:"100%",id:"filter_arg",title:"Blur radius",mb:4,helperText:"Select the blur radius.",info:"This is where you select the blur radius.",type:v.Z.TYPES.select,value:null===t||void 0===t?void 0:t.radius,options:T,onOptionValue:e=>T.includes(e)?e:T[0],onOptionName:e=>T.includes(e)?e:T[0],onChange:e=>{n({...t,radius:(isNaN(e),e)})}},"filter_arg")})}},ImageTransform:{id:"ImageTransform",filter:(e,t)=>(0,w.cr)(t,e,2),render:e=>{let{filterArgs:t,setFilterArgs:n,onShowSvgArgsInput:a}=e;return(0,i.jsx)(c.xu,{w:"100%",children:(0,i.jsx)(S.Z,{status:"warning",onClick:()=>{a&&a()},children:"Edit Rotation"})})},isAutomatic:!0}},_=e=>{let{filterElementId:t,id:n,value:a,onRender:o,onChange:r,onShowSvgArgsInput:l,...s}=e;var u;return(0,i.jsxs)(d.g,{w:"100%",justifyContent:"flex-start",alignItems:"flex-start",border:"1px",p:"0.5rem",borderRadius:"3px",...s,children:[(0,i.jsx)(x.X,{id:n,isChecked:a.selected,onChange:e=>{var t;r({...a,selected:null===(t=e.target)||void 0===t?void 0:t.checked})},children:n}),o?(0,i.jsx)(c.xu,{mb:2,w:"100%",children:o({filterArgs:null===(u=a.mask)||void 0===u?void 0:u.args,setFilterArgs:e=>{r({...a,mask:{...a.mask,args:{...a.mask.args||{},...e}}})},onShowSvgArgsInput:()=>{l&&l(t,a.mask)}})}):null]})},I=e=>{let{filterElementId:t,title:n,filters:a,isOpen:o,onComplete:l,onClose:s,onShowSvgArgsInput:c}=e;const[u,f]=(0,h.useState)();(0,h.useEffect)((()=>{u||f((e=>{const t={},n=Object.values(E);for(const i of n)t[i.id]={id:i.id,selected:null!=e[i.id]&&void 0!=e[i.id],mask:e[i.id]||{filter_id:i.id},render:i.render};return t})(a||{}))}),[a]),(0,h.useEffect)((()=>{}),[u]);return(0,i.jsxs)(k.Z,{title:n,isOpen:o,onClose:s,dontCloseOnOverlayClick:!0,w:"100%",h:"90vh",children:[(0,i.jsx)(d.g,{justifyContent:"flex-start",alignItems:"flex-start",w:"100%",height:"60vh",pos:"relative",overflowY:"auto",px:"0.5rem",children:u?Object.values(u).sort(((e,t)=>(e.id||"").localeCompare(t.id||""))).map(((e,n)=>(0,i.jsx)(_,{id:e.id,value:u[e.id],onRender:e.render,filterElementId:t,onShowSvgArgsInput:c,onChange:t=>{f({...u,[e.id]:t})},mb:4},n))):(0,i.jsx)(r.U,{w:"100%",justifyContent:"center",children:(0,i.jsx)(y.$,{size:"xl"})})}),(0,i.jsx)(j.Z,{onClick:()=>{if(u){const e={},t=Object.values(E).filter((e=>e.isAutomatic));for(const i of t)a[i.id]&&(e[i.id]=a[i.id]);const n=Object.values(u).filter((e=>e.selected));for(const i of n)e[i.id]=i.mask;l(e),s()}else s()},children:"Submit Filters"})]})},F=e=>{let{id:t,image:n,onClick:a,...o}=e;return(0,i.jsxs)(r.U,{w:"100%",justifyContent:"flex-start",alignItems:"flex-end",border:"1px",p:"0.5rem",borderRadius:"3px",...o,onClick:a,cursor:"pointer",children:[(0,i.jsx)(b.E,{src:n||"",w:"60px",h:"60px"}),(0,i.jsx)(l.x,{as:"div",children:t})]})},M=e=>{let{images:t,onSelected:n,onClose:a}=e;return(0,i.jsx)(k.Z,{title:"Select Image",isOpen:!0,onClose:a,dontCloseOnOverlayClick:!0,w:"100%",h:"90vh",children:(0,i.jsx)(d.g,{justifyContent:"flex-start",alignItems:"flex-start",w:"100%",height:"60vh",pos:"relative",overflowY:"auto",px:"0.5rem",children:0==t.length?(0,i.jsx)(r.U,{w:"100%",justifyContent:"center",children:(0,i.jsx)(y.$,{size:"xl"})}):t.map((e=>(0,i.jsx)(F,{id:e.id,image:e.image,onClick:()=>{n(e)},mb:4},e.id)))})})};var O=E,A=n(53754),P=n(10151),N=n(41160),D=n(93239),Z=n(83612),L=n(34365),z=n(38451);function Y(e,t){if(t<0||t>100)throw new Error("Percentage should be between 0 and 100");const n=e.length,i=[];for(let r=0;r<n;r++)" "!==e[r]&&i.push(r);const a=Math.round(t/100*i.length);for(let r=i.length-1;r>0;r--){const e=Math.floor(Math.random()*(r+1));[i[r],i[e]]=[i[e],i[r]]}const o=new Set(i.slice(0,a));return e.split("").map(((e,t)=>" "===e||o.has(t)?e:"*")).join("")}async function R(e,t,n){return new Promise((i=>{const a=function(e){const t=(new DOMParser).parseFromString(e,"image/svg+xml"),n=Array.from(t.querySelectorAll("style")).map((e=>e.textContent||"")).join(" ");function i(e){const t=new RegExp("".concat(e,"\\s*{[^}]*fill:\\s*([^;]+);"),"gi"),i=Array.from(n.matchAll(t)),a=i.length>0?i[i.length-1][1].trim():null;return console.log("findFillInCSS:",e,a),a}console.log("styleContent:",n);const a=t.querySelectorAll("text"),o={};return a.forEach((e=>{let t=e.getAttribute("fill");if(!t){var n;const a=(null===(n=e.getAttribute("class"))||void 0===n?void 0:n.split(/\s+/))||[],o=e.getAttribute("id");for(const e of a)t||(t=i("\\.".concat(e)));!t&&o&&(t=i("#".concat(o)))}t&&(t=t.toLowerCase(),o[t]=(o[t]||0)+1)})),Object.entries(o).sort(((e,t)=>t[1]-e[1])).map((e=>{let[t]=e;return t}))[0]||"black"}(e),o=new Image;o.src="data:image/svg+xml;base64,".concat(btoa(e)),o.onload=()=>{var e;const o=document.createElement("canvas");o.width=t,o.height=n;const r=o.getContext("2d");if(!r)return void i("");r.clearRect(0,0,t,n),r.font="20px Arial",r.globalAlpha=.9;const l="Fake Sample",s=r.measureText(l).width,c=Math.floor(t*n/(20*s*3));for(let i=0;i<c;i++){const e=Math.random()*t,i=Math.random()*n,o=(60*Math.random()-30)*(Math.PI/180);r.save(),r.translate(e,i),r.rotate(o),r.fillStyle=a,r.fillText(l,0,0),r.restore()}const d='Remove watermark to remove "Fake Sample" and show all hidden texts.';let u=Math.floor(t/30);var h;r.font="".concat(u,"px Arial"),r.globalAlpha=1;const f=null!==(h=null===(e=a.match(/\d+/g))||void 0===e?void 0:e.map(Number))&&void 0!==h?h:[0,0,0],p=.299*f[0]+.587*f[1]+.114*f[2];r.fillStyle=p>128?"black":"white";let g=r.measureText(d).width;const m=.45*t;for(;g>m&&u>10;)u-=2,r.font="".concat(u,"px Arial"),g=r.measureText(d).width;const v=.8*u,x=.05*t;[{x:x,y:.15*n},{x:x,y:.6*n}].forEach((e=>{let{x:t,y:n}=e;const i=g+2*v,a=u+1.5*v,o=t-.5*v,l=n-u-v;r.globalAlpha=.5,r.fillStyle="black",r.fillRect(o,l,i,a),r.globalAlpha=1,r.fillStyle="white",r.fillText(d,t,n)})),i(o.toDataURL("image/png"))}}))}const U=e=>{let{children:t}=e;return(0,i.jsxs)(r.U,{justifyContent:"flex-start",alignItems:"center",m:"0px !important",mb:"1rem !important",children:[(0,i.jsx)(u.gJy,{color:"#e53e3e"}),"\xa0",(0,i.jsx)(l.x,{as:"div",color:"#e53e3e",children:t})]})},B=e=>{const[t,n]=e.split(".");return"".concat(t,".").concat((n||"").split("_")[0].trim()).trim()},W=async(e,t,n)=>{const i=!t[0]||n&&n.includes(t[0].filter_id)?e:await O[t[0].filter_id].filter(e,t[0].args);return t.shift(),0==t.length?i:W(i,t,n)},H=(e,t,n)=>new Promise((async(i,a)=>{try{i(await W(e,t,n))}catch(o){a(o)}}));function J(e,t,n,i,a){const o=t+i/2,r=n+a/2;return"rotate(".concat(e," ").concat(o," ").concat(r,")")}const V=(e,t,n,i,a,o,r)=>{if(e.attributes.width&&(e.attributes.width="".concat((0,L.Qj)(Number(e.attributes.width),t,i,3))),e.attributes.height&&(e.attributes.height="".concat((0,L.Yg)(Number(e.attributes.height),n,a,3))),e.attributes.x&&(e.attributes.x="".concat((0,L.Qj)(Number(e.attributes.x),t,i,3))),e.attributes.y&&(e.attributes.y="".concat((0,L.Yg)(Number(e.attributes.y),n,a,3))),e.attributes.transform&&(e.attributes.transform=(0,z.IP)(e.attributes.transform,(e=>(0,L.Qj)(e,t,i,3)),(e=>(0,L.Yg)(e,n,a,3)),o,r)),"path"==e.name&&e.attributes.d&&(e.attributes.d=(0,z.sS)(e.attributes.d,(e=>(0,L.Qj)(e,t,i,3)),(e=>(0,L.Yg)(e,n,a,3)))),e.attributes.dy&&(e.attributes.dy="".concat((0,L.Yg)(Number(e.attributes.dy),n,a,3))),e.children.length>0)for(var l=0;l<e.children.length;l++)V(e.children[l],t,n,i,a,o,r)},q=(e,t,n,i,a)=>{let o=0;const r=t?t.split("\n"):[],l=r.length,s=[],c=(e,t)=>{const n=[];let i="";for(const a of e.split(" "))(i+a).length>t?(i.length>0&&n.push(i.trim()),i=a+" "):i+=a+" ";return i.trim().length>0&&n.push(i.trim()),n};for(let d=0;d<e.children.length;d++){if(e.children[d].value.length>0)if(o++,s.push(e.children[d].value),r.length>0){let t=r[0];if(i&&t.length>i){const e=c(t,i);t=e.shift()||"",r[0]=e.join("\n")}else r.shift();e.children[d].value=a?Y(t,70):t}else l>0&&(e.children[d].value="");if(e.children[d].children.length>0)for(let t=0;t<e.children[d].children.length;t++)if(e.children[d].children[t].value.length>0)if(o++,s.push(e.children[d].children[t].value),r.length>0){let n=r[0];if(i&&n.length>i){const e=c(n,i);n=e.shift()||"",r[0]=e.join("\n")}else r.shift();e.children[d].children[t].value=a?Y(n,70):n}else l>0&&(e.children[d].children[t].value="")}return{maxLines:o,defaultInputLines:s}},X=(e,t,n,i,a,o,r,l,s,c,d,u)=>{if(!(0,m.LV)(a,e,r))return void(t.children[i].attributes.class="hide");"image"!=t.children[i].name||(null===a||void 0===a?void 0:a.type)||(t.children[i].attributes["xlink:href"]=(0,m.gJ)(n,o,c?"_".concat(c):null));if("defs"!=t.children[i].name&&(t.children[i].attributes["data-svg-id"]=t.children[i].attributes.id),"image_select"==(null===a||void 0===a?void 0:a.type)){if(r[a.id]){const e=r[a.id];t.children[i].attributes["xlink:href"]=(0,m.gJ)(e,o,c?"_".concat(c):null)}}else if(["image_upload","sign","faceshot"].includes(null===a||void 0===a?void 0:a.type))o[n]&&(t.children[i].attributes["xlink:href"]=o[n],"sign"==(null===a||void 0===a?void 0:a.type)||null===a||void 0===a||a.type);else if("checkbox"==(null===a||void 0===a?void 0:a.type))o[n]&&r[a.id]&&"image"==t.children[i].name&&(t.children[i].attributes["xlink:href"]=(0,m.gJ)(n,o,c?"_".concat(c):null));else if("qrcode"==(null===a||void 0===a?void 0:a.type))o[n]&&"image"==t.children[i].name&&(t.children[i].attributes["xlink:href"]=(0,m.gJ)(n,o,c?"_".concat(c):null));else if(["text","defgen"].includes(null===a||void 0===a?void 0:a.type)){for(var h=t.children[i].children[0];h.children&&h.children.length>0;)h,h=h.children[0];r[a.id]&&(h.value=d?Y(r[a.id],70):r[a.id])}else if(["textarea"].includes(null===a||void 0===a?void 0:a.type))q(t.children[i],r[a.id],a.id,null===a||void 0===a?void 0:a.maxCharsPerLine,d);else if(["gen","date"].includes(null===a||void 0===a?void 0:a.type)){for(h=t.children[i].children[0];h.children&&h.children.length>0;)h,h=h.children[0];h.value=(0,P.l)(a.code,r,m.oh,((t,n)=>{var i,a;return"text_select"==(null===(i=e[t])||void 0===i?void 0:i.type)?((null===(a=e[t].selections[n])||void 0===a?void 0:a.value)||"").trim():n}))}else if(["text_select"].includes(null===a||void 0===a?void 0:a.type)){var f;for(h=t.children[i].children[0];h.children&&h.children.length>0;)h,h=h.children[0];if(r[a.id])h.value=((null===(f=a.selections[r[a.id]])||void 0===f?void 0:f.value)||"").trim()}},Q={"letter-spacing":e=>{const{value:t,unit:n}=(0,Z.Zl)(e);let i;return i="psd"==n?"".concat(parseFloat(t)/1e3,"em"):e,i}},G=e=>{const t={...e};for(const[i,a]of Object.entries(e)){const e=[...a.declarations];for(var n=0;n<e.length;n++){const t=Q[a.declarations[n].property];t&&(e[n]={...e[n],value:t(a.declarations[n].value)})}t[i].declarations=e}return t};function $(e,t,n){const i=Number(e.x),a=i+Number(e.width),o=Number(e.y),r=o+Number(e.height);var l=Number(t.x),s=l+Number(t.width),c=Number(t.y),d=c+Number(t.height);return l+5*l/100>=i&&s-5*s/100<=a&&c+5*c/100>=o&&d-5*d/100<=r?t.id:null}const K=(e,t,n)=>{const i=[e.attributes.id];for(var a=n.length-1;a>=0;a--)if(t!=a&&"image"==n[a].name&&n[a].attributes){const t=$(e.attributes,n[a].attributes,"".concat(e.attributes.id,":").concat(n[a].attributes.id));t&&i.push(t)}return i},ee=(e,t,n,i,a,o)=>new Promise((async(r,l)=>{(0,f.parse)(t.svg).then((async s=>{const c=Object.keys(t.fields),d=Number("".concat(s.attributes.width||0)),u=Number("".concat(s.attributes.height||0));var h=a&&"max"!=a?a:d;const v=h/d*u;let x=await((e,t,n,i)=>new Promise((async(a,o)=>{try{const o=Object.entries(e).map((async a=>{let[o,r]=a;var l,s,c=B(o);let d;var u;if(["image_upload","faceshot","sign"].includes(null===(l=n.fields[c])||void 0===l?void 0:l.type))d=t[c]&&(0,m.zI)(t[c])?t[c]:(0,A.VT)("other_tools_data",t.id,c),null===(u=n.fields[c])||void 0===u||u.type;else if(o.endsWith("_thumbnail"))d=null;else{const t=(0,m.gJ)(o,e,i?"_".concat(i):null);t&&(d=await(0,p.tY)(t))}const h="image_select"==(null===(s=n.fields[c])||void 0===s?void 0:s.type)?c:o;var f,g;return c.startsWith("Logo.upload"),d&&!(0,A.N4)(d)&&(0,m.zI)(d)&&n.masks&&n.masks[h]&&(d="sign"==(null===(f=n.fields[c])||void 0===f?void 0:f.type)||"image_upload"==(null===(g=n.fields[c])||void 0===g?void 0:g.type)?await H(d,Object.values(n.masks[h]),["ImageTransform"]):await H(d,Object.values(n.masks[h]))),[o,d]})),r=await Promise.all(o);a(Object.fromEntries(r))}catch(r){o(r)}})))(t.images,e,t,h),y=0,b=0,w=0,k=0;var j=-1;s.attributes.width="".concat(h),s.attributes.height="".concat(v),s.attributes.viewBox&&(s.attributes.viewBox=(0,z.C)(s.attributes.viewBox,(e=>(0,L.Qj)(e,h,d,3)),(e=>(0,L.Yg)(e,v,u,3))));for(var S=s.children.length-1;S>=0;S--){const n=s.children[S],{name:a,type:r,selectIndex:l,typeAndSelectIndex:f}=(0,g.py)(n.attributes.id),p="".concat(a,".").concat(r),m=t.fields[p];if(n.attributes.id,V(n,h,v,d,u,e[(null===m||void 0===m?void 0:m.id)||""],null===m||void 0===m?void 0:m.maxTextBeforeScaleDown),"defs"==n.name)j=S;else if(c.includes(p)||"image"==n.name){var C=B(n.attributes.id);const a="image_select"==r?C:n.attributes.id;X(t.fields,s,n.attributes.id,S,t.fields[p],x,e,0,0,h,i,(o||{})[a]||((null===t||void 0===t?void 0:t.masks)||{})[a]),((o||{})[a]||{}).ImageTransform&&(y=parseFloat(n.attributes.width),b=parseFloat(n.attributes.height),w=parseFloat(n.attributes.x),k=parseFloat(n.attributes.y))}}var T=[];for(S=s.children.length-1;S>=0;S--){const e=s.children[S];if("image"==e.name){const t=K(e,S,s.children).filter((e=>!T.includes(e)));T=T.concat(t),s.children[S].attributes["data-click-element-id"]=0==t.length?s.children[S].attributes.id:t.join()}}if(j>-1){const e=s.children[j];e.children&&e.children.forEach((e=>{if("style"===e.name&&e.children&&e.children.length>0){const n=e.children[0].value,i=(0,Z.sn)(n,((e,n)=>{const i=(e=>{if(!e)return null;const t={...e};return t.if_selector&&(t.if_selector=G(t.if_selector)),t.if_property&&(t.if_property=G(t.if_property)),t.if_property_and_value&&(t.if_property_and_value=G(t.if_property_and_value)),t})(t.cssActions),a=(null===i||void 0===i?void 0:i.if_selector)||{},o=(null===i||void 0===i?void 0:i.if_property)||{},r=(null===i||void 0===i?void 0:i.if_property_and_value)||{};var l=[...n];const s=a["*"],c=a[(0,Z.xC)(e)];s&&(l=s.shouldReplace?s.declarations:[...l,...s.declarations]),c&&(l=c.shouldReplace?c.declarations:[...l,...c.declarations]);for(var f=0;f<n.length;f++){const e=n[f],t=o["*"],i=o[(0,Z.xC)(e.property)],a=r["*"],s=r[(0,Z.xC)(e.property,e.value)];t&&(l=t.shouldReplace?t.declarations:[...l,...t.declarations]),i&&(l=i.shouldReplace?i.declarations:[...l,...i.declarations]),a&&(l=a.shouldReplace?a.declarations:[...l,...a.declarations]),s&&(l=s.shouldReplace?s.declarations:[...l,...s.declarations]),"font-size"===e.property&&l.push({property:"font-size",value:(0,z.MB)(e.value,d,u,h,v)})}return l}));e.children[0].value=i}}));const i=[];if(i.push({name:"style",type:"element",value:"",attributes:{},children:[{name:"",type:"text",value:".hide { opacity: 0 !important;}",attributes:{},children:[]}]}),i.push({name:"style",type:"element",value:"",attributes:{},children:[{name:"",type:"text",value:"#softbaker-slider-handle, #softbaker-button-background, #softbaker-button-text, #softbaker-cancel-background, #softbaker-cancel-text, #softbaker-slider-track { cursor: pointer !important;}",attributes:{},children:[]}]}),s.children[j].children=i.concat(s.children[j].children),n){const e=[];for(const t of Object.values(n))t.dataUrl&&t.ext&&e.push({name:"style",type:"element",value:"",attributes:{},children:[{name:"",type:"text",value:'\n      @font-face {\n        font-family: "'.concat(t.name,'";\n        src: url(').concat(t.dataUrl,") format(").concat((0,D.bX)(t.ext),");\n      }"),attributes:{},children:[]}]});e.length>0&&(s.children[j].children=e.concat(s.children[j].children))}}if(o){var E;const e=Object.keys(o)[0],t=((o||{})[e]||{}).ImageTransform,n="#dd6b20",i={name:"rect",type:"element",value:"",attributes:{id:"softbaker-slider-track",x:w+"",y:k+b+10+"",width:y+"",height:"10",fill:"#2a2a2a"},children:[]},a={name:"circle",type:"element",value:"",attributes:{id:"softbaker-slider-handle",cx:w+((null===t||void 0===t||null===(E=t.args)||void 0===E?void 0:E.rotationAngle)||0)*parseFloat(i.attributes.width)/360+"",cy:parseFloat(i.attributes.y)+parseFloat(i.attributes.height)/2+"",r:parseFloat(i.attributes.height)+"",fill:n},children:[]},r={name:"rect",type:"element",value:"",attributes:{id:"softbaker-button-background",x:w+"",y:parseFloat(i.attributes.y)+parseFloat(i.attributes.height)+10+"",width:"40",height:"20",rx:"10",ry:"10",fill:n},children:[]},l={name:"text",type:"element",value:"",attributes:{id:"softbaker-button-text",x:w+parseFloat(r.attributes.width)/2+"",y:parseFloat(r.attributes.y)+parseFloat(r.attributes.height)/2+5+"","font-size":"14","text-anchor":"middle",fill:"#FFFFFF"},children:[{name:"",type:"text",value:"\u2714",parent:null,attributes:{},children:[]}]},c=50,d={name:"rect",type:"element",value:"",attributes:{id:"softbaker-cancel-background",x:w+c+"",y:parseFloat(i.attributes.y)+parseFloat(i.attributes.height)+10+"",width:"40",height:"20",rx:"10",ry:"10",stroke:n},children:[]},u={name:"text",type:"element",value:"",attributes:{id:"softbaker-cancel-text",x:w+c+parseFloat(r.attributes.width)/2+"",y:parseFloat(r.attributes.y)+parseFloat(r.attributes.height)/2+5+"","font-size":"14","text-anchor":"middle",fill:"#FFFFFF"},children:[{name:"",type:"text",value:"\u274c",parent:null,attributes:{},children:[]}]};s.children=s.children.concat([i,a,r,l,d,u])}i?R((0,f.stringify)(s),d,u).then((e=>{s.children.push({name:"image",type:"element",value:"",attributes:{id:"watermark-"+(0,m.Bu)(8),width:d+"",height:u+"","xlink:href":e},children:[]}),r((0,f.stringify)(s))})).catch((e=>{l(e)})):r((0,f.stringify)(s))})).catch((e=>{l(e)}))})),te=e=>{let{fonts:t,isLoading:n,data:l,templateData:u,showWatermark:f,width:p,onFiltersUpdated:g,filterEnabled:m}=e;const v=(0,h.useRef)(null),x=(0,s.S)(p||{base:0}),[y,b]=(0,h.useState)(),[w,k]=(0,h.useState)(),[j,S]=(0,h.useState)(),[C,T]=(0,h.useState)(null);(0,h.useEffect)((()=>{}),[y]),(0,h.useEffect)((()=>{l&&u?(k(!0),S(void 0),ee(l,u,t,f,x,C).then((e=>{k(!1),b(e)})).catch((e=>{k(!1),S(e.message)}))):u||(k(!0),b(""))}),[l,u,f,x,C,t]);const[E,_]=(0,h.useState)(),[F,O]=(0,h.useState)(),[A,P]=(0,h.useState)(),[D,Z]=(0,h.useState)(),[L,z]=(0,h.useState)(),Y=e=>{_(null),P(null),Z(null),O(null)},R=e=>{const t=e.target;if(t)if(t.hasAttribute("data-click-element-id")&&!C){((e,t)=>{if(m)if(e.includes(",")){const i=e.split(","),a=[];for(var n=0;n<i.length;n++){const e=i[n];if(0==n)a.push({id:e,image:t});else{const t=document.getElementById(e);if(t){const n=t.getAttribute("xlink:href");a.push({id:e,image:n})}}}z(a)}else _(e),O(t),e&&(null===u||void 0===u?void 0:u.masks)&&(null===u||void 0===u?void 0:u.masks[e])&&Z(u.masks[e].args)})(t.getAttribute("data-click-element-id"),t.getAttribute("xlink:href"))}else if(["softbaker-button-background","softbaker-button-text"].includes(t.getAttribute("id"))){if(g&&C){const e=document.querySelector("[data-svg-id='".concat(Object.keys(C)[0],"']"));if(!e)return;const t=e.getAttribute("data-degree");if(void 0!=t){var n,i;const e=Number(t),a=((null===u||void 0===u?void 0:u.masks)||{})[Object.keys(C)[0]]||{},o={...a,ImageTransform:{filter_id:(null===a||void 0===a||null===(n=a.ImageTransform)||void 0===n?void 0:n.filter_id)||"",args:{...(null===a||void 0===a||null===(i=a.ImageTransform)||void 0===i?void 0:i.args)||{},rotationAngle:e}}};g({...(null===u||void 0===u?void 0:u.masks)||{},[Object.keys(C)[0]]:o})}T(null)}}else["softbaker-cancel-background","softbaker-cancel-text"].includes(t.getAttribute("id"))&&T(null)},B=e=>{const t=e.target;"softbaker-slider-handle"===t.getAttribute("id")&&t.setAttribute("data-rotating","1")},W=()=>{const e=document.getElementById("softbaker-slider-handle");e&&e.setAttribute("data-rotating","0")},H=e=>{const t=document.getElementById("softbaker-slider-track");if(t&&C&&"softbaker-slider-handle"===e.target.getAttribute("id")){if(!("1"===e.target.getAttribute("data-rotating")))return;const n=t.getBoundingClientRect(),i=t.getBBox(),a=Math.min(Math.max(e.clientX-n.left,0),n.width);e.target.setAttribute("cx","".concat(i.x+a));const o=a/n.width*360;if(Object.keys(C)[0]){const e=document.querySelector("[data-svg-id='".concat(Object.keys(C)[0],"']"));if(!e)return;const t=J(o,parseFloat(e.getAttribute("x")||0),parseFloat(e.getAttribute("y")||0),parseFloat(e.getAttribute("width")||0),parseFloat(e.getAttribute("height")||0));e.setAttribute("transform",t),e.setAttribute("data-degree","".concat(o))}}};return(0,h.useEffect)((()=>{const e=v.current;return e&&(e.addEventListener("click",R),e.addEventListener("mousedown",B),e.addEventListener("mouseup",W),e.addEventListener("mousemove",H)),()=>{e&&(e.removeEventListener("click",R),e.removeEventListener("mousedown",B),e.removeEventListener("mouseup",W),e.removeEventListener("mousemove",H))}}),[y,u,l,C,m]),(0,i.jsx)(N.Z,{disableDrag:null!=C,width:"100%",message:"Drag around to view the whole tool",height:{base:500,md:728,lg:1024},children:(0,i.jsxs)(c.xu,{id:"AirlineDocWrapper",pos:"relative",w:"100%",children:[y?(0,i.jsx)(c.xu,{ref:v,w:"100%",h:"100%",dangerouslySetInnerHTML:{__html:y}}):null,C?null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.U,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"1",bg:"#dfdfdf",opacity:"0.7",justifyContent:"flex-start",pl:{base:"0px",md:"0px"},alignItems:"center",display:w||n?"flex":"none",w:"100%",h:"100%",children:(0,i.jsx)(a.Z,{type:a.Z.TYPES.grid,color:(0,o.Z)("colorAccent.light","colorAccent.dark"),size:"70px"})}),(0,i.jsx)(d.g,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"1",bg:"#fff",opacity:"0.7",justifyContent:"center",pl:"1rem",alignItems:"flex-start",display:j?"flex":"none",w:"100%",h:"100%",children:j?(0,i.jsx)(U,{children:(V=j,(null===V||void 0===V?void 0:V.message)?V.message:V)}):null})]}),L?(0,i.jsx)(M,{images:L,onClose:()=>{z(void 0)},onSelected:e=>{_(e.id),O(e.image),e.id&&(null===u||void 0===u?void 0:u.masks)&&(null===u||void 0===u||u.masks[e.id]),z(void 0)}}):E&&g?(0,i.jsx)(I,{filterElementId:E,title:"".concat(E||""," filter"),filters:((null===u||void 0===u?void 0:u.masks)||{})[E]||{},isOpen:!0,onClose:()=>{Y()},onComplete:e=>{g({...(null===u||void 0===u?void 0:u.masks)||{},[E]:e})},onShowSvgArgsInput:(e,t)=>{T({[e]:{[t.filter_id]:t}}),Y()}}):null]})});var V};te.getSvg=ee;var ne=te},38451:function(e,t,n){n.d(t,{C:function(){return o},IP:function(){return i},MB:function(){return r},sS:function(){return a}});function i(e,t,n,i,a){return e.replace(/(translate|rotate|scale|matrix|skewX|skewY)\(([^)]+)\)/g,((e,o,r)=>{let l=r.split(/[ ,]+/).map(Number);if("translate"===o)l[0]=t(l[0]),l[1]=n(l[1]);else if("scale"===o){if(l[0]=l[0],l.length>1?l[1]=l[1]:l[1]=l[0],a){const{scaleH:e,scaleV:t}=((e,t,n,i)=>{if(i<=n)return{scaleH:e,scaleV:t};const a=n/i;return{scaleH:e*a,scaleV:t*a}})(l[0],l[1],a,(i||"").length);[1.499].includes(l[1]),l[0]=e,l[1]=t}}else if("matrix"===o)l[4]=t(l[4]),l[5]=n(l[5]);else{if("rotate"===o)return"".concat(o,"(").concat(r,")");if("skewX"===o)return"".concat(o,"(").concat(t(Number(r.trim())),")");if("skewY"===o)return"".concat(o,"(").concat(n(Number(r.trim())),")")}return"".concat(o,"(").concat(l.join(" "),")")}))}function a(e,t,n){return e.replace(/([MLHVCSQTZ])([^MLHVCSQTZ]*)/gi,((e,i,a)=>{let o=a.trim().split(/([, ])/).map((e=>e.trim()));for(let r=0;r<o.length;r++)isNaN(parseFloat(o[r]))||("H"===i.toUpperCase()?o[r]=t(parseFloat(o[r])):"V"===i.toUpperCase()?o[r]=n(parseFloat(o[r])):o[r]=r%2===0?t(parseFloat(o[r])):n(parseFloat(o[r])));return"".concat(i).concat(o.join(""))}))}function o(e,t,n){let i=e.trim().split(" ").map((e=>parseFloat(e)));if(4!==i.length)throw new Error("Invalid viewBox format. Expected format: 'min-x min-y width height'");return i[0]=t(i[0]),i[1]=n(i[1]),i[2]=t(i[2]),i[3]=n(i[3]),i.join(" ")}function r(e,t,n,i,a){const o=i/t,r=a/n,l=Math.min(o,r),s=e.match(/^(\d+(\.\d+)?)([a-z%]*)$/i);if(!s)throw new Error("Invalid font size format");const c=parseFloat(s[1]),d=s[3]||"";return"".concat(c*l).concat(d)}},83612:function(e,t,n){n.d(t,{Zl:function(){return a},sn:function(){return o},xC:function(){return i}});const i=(e,t)=>"".concat(e.replace(/\s/g,"")).concat(t?":".concat(t.replace(/\s/g,"")):"");function a(e){const t=e.match(/^([-+]?\d*\.?\d+)([a-zA-Z]+)$/);if(t)return{value:t[1],unit:t[2]};throw new Error("Invalid input format: ".concat(e))}function o(e,t){const n={},i=/([^{]+)\{([^}]+)\}/g;let a;for(;null!==(a=i.exec(e));){const e=a[1].trim(),t=a[2].trim().split(";").filter(Boolean).map((e=>{const[t,n]=e.split(":").map((e=>e.trim()));return{property:t,value:n}}));n[e]=t}Object.keys(n).forEach((e=>{const i=n[e],a=t(e,i);n[e]=a}));let o="";return Object.keys(n).forEach((e=>{const t=n[e].map((e=>{let{property:t,value:n}=e;return"".concat(t,": ").concat(n,";")})).join(" ");o+="".concat(e," { ").concat(t," }\n")})),o}},74054:function(e,t,n){var i=n(67294),a=n(10151),o=n(23596),r=n(5555);t.Z=(e,t,n,l)=>{const[s,c]=(0,i.useState)(),[d,u]=(0,i.useState)();(0,i.useEffect)((()=>{const i=n?JSON.stringify(n):void 0;if(e&&t&&n&&s!=i){i&&c(i),l&&u(l);const s={};for(const t of Object.values(n))"checkbox"==t.type?s[t.id]=!0:"date"==t.type?s[t.id]=(0,r.SG)(new Date):"defgen"==t.type&&t.code?e&&(s[t.id]=(0,a.l)(t.code,e,o.oh)):!["image_upload","faceshot","sign"].includes(t.type)&&t.placeholder&&"string"===typeof t.placeholder&&t.placeholder.length>0&&(s[t.id]=t.placeholder);Object.keys(s).length>0&&t&&t({...s,is_freemium:!0,template_id:l||""})}else d!=l&&t&&(l&&u(l),t({...e||{},is_freemium:!0,template_id:l||""}))}),[n,e,t,l])}},83613:function(e,t,n){var i=n(67294),a=n(93239),o=n(25723),r=n(73391),l=n(53754),s=n(23596);t.Z=e=>{const[t,n]=(0,i.useState)(),[c,d]=(0,i.useState)(),[u,h]=(0,i.useState)(),{user:f}=(0,r.P)(),[p,g]=(0,i.useState)(!0);(0,i.useEffect)((()=>{}),[c]);return(0,i.useEffect)((()=>{e&&(0,a.fY)(e).then((async e=>{h(e)})).catch((e=>{n(e.message)}))}),[e]),(0,i.useEffect)((()=>{u&&(0,a.Xx)(u,["ttf","otf","woff","woff2","eot","svg"]).then((e=>{d({...c,...e}),g(!1)})).catch((e=>{n(e.message),g(!1)}))}),[u]),{loadingFonts:p,error:t,fonts:c,setFonts:d,uploadFonts:e=>new Promise((async(t,n)=>{if(c){e&&e("Preparing fonts for upload...");const i=[];for(const e of Object.values(c))!e.url&&e.file&&i.push({id:e.id,file:e.file,fileName:"".concat((0,s.vq)(e.id),".").concat(e.ext),dir:"fonts"});if(i.length>0){if(!f)return e&&e("Sign In Requred..."),n(new Error("Please sign in"));e&&e("Uploading fonts..."),(0,o.dq)(f,i,"https://r2.softbaker.com/").then((a=>{const o={...c},r={};a.forEach((e=>{if((0,l.N4)(e.error))o[e.id].url=e.url;else{const t=new Error(e.error);o[e.id].readError=t.message,r[e.id]=t.message}})),Object.keys(r).length==i.length?(e&&e('Fonts upload failed with the error, "'.concat(JSON.stringify(r),'"...')),n(new Error("The font(s) failed to upload: ".concat(JSON.stringify(r))))):Object.keys(r).length>0?(d(o),e&&e('Fonts upload failed with the error, "'.concat(JSON.stringify(r),'"...')),n(new Error("Some or all fonts failed to upload: ".concat(JSON.stringify(r))))):(d(o),e&&e("Fonts uploaded..."),t(c))})).catch((t=>{e&&e('Fonts upload failed with the error, "'.concat(t.message,'"...')),n(t)}))}else e&&e("No font to Prepare for upload..."),t({})}else e&&e("No fonts to upload..."),t(null)}))}}},93239:function(e,t,n){n.d(t,{Xx:function(){return d},YW:function(){return h},bX:function(){return u},fY:function(){return l}});var i=n(79230),a=n(23596);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;return e.attributes&&e.attributes["font-family"]&&t.add(e.attributes["font-family"]),"defs"===e.name&&e.children&&e.children.forEach((e=>{if("style"===e.name&&e.children&&e.children.length>0){r(e.children[0].value,t)}})),e.children&&e.children.length>0&&e.children.forEach((e=>o(e,t))),t}function r(e,t){const n=/font-family:\s*([^;]+);/g;let i;for(;null!==(i=n.exec(e));)t.add(i[1].trim())}function l(e){return(0,i.parse)(e).then((e=>{const t=o(e);return Array.from(t)}))}async function s(e){try{const t=await fetch(e);if(!t.ok)throw new Error("HTTP status ".concat(t.status));const n=await t.blob();return new Promise(((e,t)=>{const i=new FileReader;i.onloadend=()=>e(i.result),i.onerror=t,i.readAsDataURL(n)}))}catch(t){throw new Error("Failed to fetch font data from ".concat(e,": ").concat(t.message))}}function c(e){let t=e.toLowerCase();return t=t.replace(/["']/g,""),t=t.replace(/[\s]+/g,"-"),t=t.replace(/[^a-z0-9-]+/g,""),t=t.replace(/-+/g,"-"),t=t.replace(/^-|-$/g,""),t}function d(e,t){return new Promise((async(n,i)=>{const o={};for(const l of e){const e={name:l.replace(/["']/g,""),id:c(l)};let n=!1;for(const i of t){const t="https://r2.softbaker.com/fonts/".concat((0,a.vq)(e.id),".").concat(i,"?v=1");try{const a=await s(t);e.url=t,e.dataUrl=a,e.ext=i,n=!0;break}catch(r){e.readError=r.message}}n||(e.readError="No valid font found for ".concat(l," with extensions: ").concat(t.join(", "))),o[e.id]=e}n(o)}))}function u(e){return{ttf:"truetype",otf:"opentype",woff:"woff",woff2:"woff2",eot:"embedded-opentype",svg:"svg"}[e.toLowerCase()]||"unknown"}function h(e,t){return{ttf:"font/ttf",otf:"font/otf",woff:"font/woff",woff2:"font/woff2",eot:"font/eot",svg:"svg"}[t.toLowerCase()]?new Promise(((t,n)=>{new FontFace("CustomFont","url(".concat(e,")")).load().then((e=>{document.fonts.add(e);const n=document.createElement("canvas");n.width=100,n.height=100;const i=n.getContext("2d");if(!i)return;i.clearRect(0,0,n.width,n.height),i.fillStyle="#FFFFFF",i.fillRect(0,0,n.width,n.height),i.fillStyle="#000000",i.font="50px CustomFont",i.textAlign="center",i.textBaseline="middle",i.fillText("Aa",n.width/2,n.height/2);const a=n.toDataURL("image/png");t(a)})).catch((e=>{n(e)}))})):Promise.reject(new Error("Unsupported font format"))}},3683:function(e,t,n){var i=n(67294),a=n(87066),o=n(23596),r=n(33871),l=n(53754),s=n(73391);t.Z=(e,t)=>{const{user:n}=(0,s.P)(),[c,d]=(0,i.useState)(),[u,h]=(0,i.useState)(),[f,p]=(0,i.useState)({}),[g,m]=(0,i.useState)(!1),[v,x]=(0,i.useState)(!1),[y,b]=(0,i.useState)(!1),[w,k]=(0,i.useState)(),[j,S]=(0,i.useState)(),[C,T]=(0,i.useState)(),[E,_]=(0,i.useState)(),[I,F]=(0,i.useState)(),[M,O]=(0,i.useState)(),[A,P]=(0,i.useState)();(0,i.useEffect)((()=>{}),[M]);const N=e=>{if(!e)return null;var t=e.split("-")[1];return t?t.split(".")[0].trim():null},D=e=>{if(1==Object.keys(e).length)return Object.keys(e)[0];for(const t of Object.values(e))if(t.is_default)return t.id;return Object.keys(e)[0]};(0,i.useEffect)((()=>{const t=N(e);e&&e!=c&&t?(d(e),m(!0),k(null),h(null),p({}),T(null),_(null),F(null),O(null),a.Z.get(e).then((e=>{h(t),p((0,o.Dn)(e.data)),m(!1)})).catch((e=>{k(e.message),m(!1)}))):e||(d(null),m(!1),k(null),h(null),p({}),T(null),_(null),F(null),O(null))}),[e]),(0,i.useEffect)((()=>{!t&&f&&Object.keys(f).length>0&&!C&&L(D(f))}),[f]);const Z=(e,t)=>{a.Z.get(e.data_url).then((t=>{F({...e}),O({...t.data}),T({...e}),_({...t.data}),x(!1)})).catch((n=>{!t||(t||0)<3?Z(e,(t||0)+1):(S(n.message),x(!1))}))},L=(e,t)=>{t&&t&&P(e);const n=f[e];n&&!(0,l.N4)(n.data_url)&&(x(!0),S(null),Z(n))},z=(e,t)=>{F(e),O(t)};return{templatesLoading:g,templatesError:w,selectedTemplateLoading:v,selectedTemplateError:j,parsingTemplate:y,templates:f,selectedTemplate:C,selectedTemplateData:E,workingTemplate:I,workingTemplateData:M,setAsDefaulTemplate:e=>{if(I&&(F({...I,is_default:e}),e&&Object.keys(f).length>1)){for(const e of Object.keys(f))e!=I.id&&(f[e].is_default=!1);p(f)}},setWorkingTemplate:F,setWorkingTemplateData:O,selectTemplate:L,parseTemplateSvg:(e,t)=>(b(!0),new Promise(((n,i)=>{(0,r.xz)(e).then((e=>{if(console.log("parsedSvg2:result.ok!!!: ",e),e){var a=C,r=E;t&&(a=null,r=null),(0,o.s7)(e,r).then((e=>{const t={id:(null===a||void 0===a?void 0:a.id)||(0,o.Bu)(8),name:(null===a||void 0===a?void 0:a.name)||"",logo:(null===a||void 0===a?void 0:a.logo)||"",data_url:(null===a||void 0===a?void 0:a.data_url)||"",is_default:(null===a||void 0===a?void 0:a.is_default)||!1,split_on_download:(null===a||void 0===a?void 0:a.split_on_download)||!1};F(t),O(e),b(!1),n({template:t,templateData:e})})).catch((e=>{b(!1),i(e)}))}else b(!1),n(null)})).catch((e=>{b(!1),i(e)}))}))),saveTemplate:e=>new Promise(((t,i)=>n?I&&M?void(0,o.t9)(n,u||(0,o.Bu)(8),f,I,M,C,E,c,z,e).then((e=>{if(e){d(e);const t=N(e);h(t),p({...f,[I.id]:I}),T(I),_(M),F(I),O(M)}t(e)})).catch(i):i(new Error("No template provided yet.")):i(new Error("Please sign in")))),deleteTemplate:e=>{Object.keys(f).includes(e)||(null===I||void 0===I?void 0:I.id)!=e||L(D(f))},getDefaultTemplateId:D,currentTemplateId:A}}},85431:function(e,t,n){n.d(t,{_P:function(){return l},pu:function(){return o},sH:function(){return s},tY:function(){return a},zD:function(){return r}});var i=n(23596);const a=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((async(n,a)=>{if(!(0,i.Ri)(e))return n(e);try{const t=await fetch(e),i=await t.blob(),o=new FileReader;o.onloadend=()=>{n(o.result)},o.onerror=a,o.readAsDataURL(i)}catch(o){if(console.info("parsedSvg:masks.fe",o.message),t)return n(null);a(o)}}))};function o(e,t){return console.info("parsedSvg:base64A: ",e.substring(0,32)),console.info("parsedSvg:base64B: ",t.substring(0,32)),e===t.split(",")[1]}function r(e){return function(e,t){try{const n=new URL(e);return n.searchParams.delete(t),n.toString()}catch(n){return console.error("Invalid URL:",n),e}}(e,"updates")}function l(e){const t=new URL(e),n=t.searchParams.get("updates"),i="".concat(n?parseInt(n,10)+1:1);return t.searchParams.set("updates",i),t.toString()}function s(e,t){return new Promise((async(n,i)=>{try{for(const n in e)if(e.hasOwnProperty(n)&&t.hasOwnProperty(n)){const i=e[n],r=t[n];if(i.startsWith("http")&&r.startsWith("data:image")){const e=await a(i,!0);e&&o(e,r)&&(t[n]=i)}}n(t)}catch(r){i(r)}}))}},33871:function(e,t,n){n.d(t,{mA:function(){return d},py:function(){return c},xz:function(){return h}});var i=n(79230),a=n(23596),o=n(13653),r=n(53754),l=n(80203),s=n(98226);const c=e=>{const[t,n]=e.split(".",2);if(!n)return{name:t};const[i,a]=[n.split("_")[0],n.split("_").slice(1).join(" ")];return{name:t,type:i,selectIndex:a,typeAndSelectIndex:n}},d=e=>{const[t,n]=e.split("@");return{name:t,directive:n}},u=(e,t,n)=>{const i=n.name,{name:o,type:l,selectIndex:d,typeAndSelectIndex:u}=c(t);if(!u||!l)return{field:null,updatedFields:e};const h={};switch(l){case"select":if(h.id="".concat(o,".").concat(l),h.name=(0,a.Dy)(o),h.type="".concat(i,"_").concat(l),"image"==i){var f;const n={name:"".concat((0,a.Dy)(o)," ").concat(d),id:t,index:d||0,type:i};h.options=(0,a.VS)({...(null===(f=e[h.id])||void 0===f?void 0:f.options)||{},[n.id]:n})}break;case"upload":h.id="".concat(o,".").concat(l),h.name=(0,a.Dy)(o),h.type="".concat(i,"_").concat(l);break;case"faceshot":default:h.id="".concat(o,".").concat(l),h.name=(0,a.Dy)(o),h.type=l;break;case"text":case"gen":case"defgen":case"date":h.id="".concat(o,".").concat(l),h.name=(0,a.Dy)(o),h.type=l,h.placeholder=(e=>{for(var t=e.children[0];t.children&&t.children.length>0;)t=t.children[0];const n=t.value;return(0,r.N4)(n)?null:n})(n)||h.name;break;case"textarea":h.id="".concat(o,".").concat(l),h.name=(0,a.Dy)(o),h.type=l,h.placeholder=(0,s.OD)(n).defaultInputLines.join("\n")}return Object.keys(h).length>0&&(e[h.id]=h),{field:h,updatedFields:e}},h=e=>new Promise((async(t,n)=>{try{e?(0,i.parse)((0,a.rY)(e)).then((async e=>{const r=[],s={};var h=[],f=[];const p=[];var g={};const m=[],v=[],x={};var y,b;const w=[];for(const t of e.children){const e=(t.attributes["data-name"]||t.attributes.id||(0,a.Bu)(8)).replace(/^_+|_+$/g,"");t.attributes.id=e;const{field:n,updatedFields:i}=u(g,e,t);if(g=i,"image"==t.name){if((null===n||void 0===n?void 0:n.type)&&["image_upload","sign","faceshot"].includes((null===n||void 0===n?void 0:n.type)||""))w.push(new Promise((async(n,i)=>{const a=await(0,l.qM)(t.attributes["xlink:href"]);try{const t=await(0,l.RA)(a,!0);n({imageId:e,filterId:"ImageTransform",mask:{filter_id:"ImageTransform",args:t}})}catch(o){r.push("".concat(t.attributes.id," has image annotation error: ").concat(o.message)),i(o)}}))),s[e]="";else if(h.includes(t.attributes["xlink:href"])){const n=h.indexOf(t.attributes["xlink:href"]);s[e]=f[n]}else s[e]=t.attributes["xlink:href"],h.push(t.attributes["xlink:href"]),f.push(e);t.attributes["xlink:href"]="",n&&"image_select"==n.type&&p.push(e)}if(n)if(["image_select","text_select","textarea_select"].includes(null===n||void 0===n?void 0:n.type))t.attributes.id=n.id,v.includes(t.attributes.id)||(m.push(t),v.push(t.attributes.id));else{const{name:n}=c(e),{directive:i}=d(n);i&&"name"==i?y=e:i&&"desc"==i&&(b=e),m.push(t)}else m.push(t)}let k;if(w.length>0)try{const e=await Promise.all(w);for(const t of e)x[t.imageId]={[t.filterId]:t.mask}}catch(j){k=j}if(r.length>0)return n(new Error(r.join(" ")));if(k)return k;if(!y||!b){let e;return e=y||b?y?"Make sure that at least @desc is declared on a text field. @small is optional.":"Make sure that at least @name is declared on a text field. @small is optional.":"Make sure that at least @name and @desc is declared on some text fields. @small is optional.",n(new Error(e))}h=[],f=[],e.children=m;await(0,a.WN)(s,(async(e,t)=>{const{width:n}=await(0,o.pz)(t);var i={};return i={["".concat(e)]:t},n>=728&&(i={...i,["".concat(e)]:t,["".concat(e,"_512")]:await(0,o.gu)(t,512)}),n>=1024&&(i={...i,["".concat(e)]:t,["".concat(e,"_728")]:await(0,o.gu)(t,728)}),n>=2047&&(i={...i,["".concat(e)]:t,["".concat(e,"_1024")]:await(0,o.gu)(t,1024)}),p.includes(e)&&(i["".concat(e,"_thumbnail")]=await(0,o.gu)(t,70)),Object.keys(i).length>0?i:null}));t({svg:(0,i.stringify)(e),fields:g,images:s,masks:x,cssActions:{if_selector:{"*":{declarations:[{property:"white-space",value:"pre"}]}}}})})).catch((e=>{n(e)})):t(null)}catch(r){n(r)}}))},23596:function(e,t,n){n.d(t,{Bu:function(){return d},Dn:function(){return g},Dy:function(){return C},LV:function(){return T},OL:function(){return _},Ok:function(){return S},Ri:function(){return x},VS:function(){return p},WN:function(){return u},gJ:function(){return b},oh:function(){return E},rY:function(){return c},s7:function(){return v},t9:function(){return j},vq:function(){return k},zI:function(){return y}});var i=n(25723),a=n(53754),o=n(85431),r=n(33871),l=n(10151),s=n(21876).Buffer;function c(e){const t="data:image/svg+xml;base64,";e.startsWith(t)&&(e=e.slice(t.length));const n=function(e){if("undefined"!==typeof s)return s.from(e,"base64").toString("binary");if("function"===typeof window.atob)return window.atob(e);throw new Error("Base64 decoding not supported in this environment")}(e),i=new Array(n.length);for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o);const a=new Uint8Array(i);return new TextDecoder("utf-8").decode(a)}function d(e){const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let i=0;i<e;i++){const e=Math.floor(Math.random()*t.length);n+=t.charAt(e)}return n}function u(e,t){return new Promise((async(n,i)=>{try{const i={...e};for(const[n,a]of Object.entries(e))if(a&&y(a)){const e=await t(n,a);e&&Object.assign(i,e)}n(i)}catch(a){i(a)}}))}function h(e,t){const[n,i]=t.split(","),a=n.match(/data:(.*?);base64/);if(!a)throw new Error("Invalid base64 data format");const o=a[1],r=atob(i),l=r.length,s=new Uint8Array(l);for(let u=0;u<l;u++)s[u]=r.charCodeAt(u);const c=new Blob([s],{type:o}),d="".concat(k(e),".").concat(o.split("/")[1]);return{id:e,image:new File([c],d,{type:o})}}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data.json";const n=JSON.stringify(e,null,2),i=new Blob([n],{type:"application/json"}),a=new File([i],t,{type:"application/json"});return a}function p(e){const t=Object.entries(e);t.sort(((e,t)=>{let[,n]=e,[,i]=t;const a=(n.index||"").toString(),o=(i.index||"").toString();return a.localeCompare(o)}));const n={};for(const[i,a]of t)n[i]=a;return n}const g=e=>{const t=Object.entries(e);t.sort(((e,t)=>{const n=e[1].name.toUpperCase(),i=t[1].name.toUpperCase();return n<i?-1:n>i?1:0}));const n={};return t.forEach((e=>{let[t,i]=e;n[t]=i})),n};function m(e,t){return!(!e||!t)&&(x(e)&&(0,o.zD)(e).toLowerCase()===(0,o.zD)(t).toLowerCase())}const v=(e,t)=>new Promise((async(n,i)=>{if(!t)return n(e);const a={};a.svg=e.svg;const r=[];for(const[o,l]of Object.entries(t.fields)){const t=e.fields[o];if(t){if(t.type!=l.type)r.push("The ".concat(l.type.split("_").join(" "),' field, "').concat(l.name,'" is misrepresented as "').concat(t.type.split("_").join(" "),'" in the new template.'));else if(l.options&&!(null===t||void 0===t?void 0:t.options))r.push("The ".concat(l.type.split("_").join(" "),' field, "').concat(l.name,'" is missing options in the new template.'));else if(l.options&&t.options)for(const e of Object.values(l.options))t.options[e.id]?t.options[e.id].type!=e.type&&r.push("The ".concat(l.type.split("_").join(" ")," ").concat(l.name,' option, "').concat(e.name,'" is misrepresented as "').concat(t.options[e.id].type.split("_").join(" "),'" in the new template.')):r.push("The ".concat(l.type.split("_").join(" ")," ").concat(l.name,' option, "').concat(e.name,'" is missing in the new template.'))}else r.push("The ".concat(l.type.split("_").join(" "),' field, "').concat(l.name,'" is missing in the new template.'))}if(Object.keys(t.images||{}).length>0&&0==Object.keys(e.images||{}).length)r.push("Images are missing in missing in the new template.");else if(Object.keys(t.images||{}).length>0)for(const o of Object.keys(t.images))e.images[o]||o.includes(".select")||r.push("The image with the id, ".concat(o," is missing in the new template."));a.fields={...t.fields,...e.fields};for(const[e,t]of Object.entries(a.fields))t.options&&(a.fields[e].options=p(t.options));if(a.images=await(0,o.sH)(t.images,{...t.images,...e.images}),r.length>0)return i(new Error(r.join("\n")));n(a)})),x=e=>e.startsWith("http"),y=e=>e.startsWith("data:image")||e.startsWith("data:img"),b=(e,t,n)=>{if(!e)return"";var i=t[e];if(e.includes("."),!i||x(i)||y(i)?i&&(i=t["".concat(e).concat(n||"")],e.includes(".")):(i=t["".concat(t[e]).concat(n||"")],e.includes(".")),!i&&n){const n=e.split("_"),a=n[n.length-1];(isNaN(Number(a.trim()))||Number(a.trim())<512)&&(i=t[e])}return e.includes("."),i},w=async(e,t,n,o,r)=>{const l=await(0,i.dq)(e,t,"https://r2.softbaker.com/"),s=[...n],c=[],d=[],u=[];return l.forEach((e=>{(0,a.N4)(e.error)?(s.push(e),c.push(e.id)):(r&&r("Failed to upload file with error, ".concat(e.error||"",". Would be retried later."),e.id,!0),d.push(e))})),t.forEach((e=>{c.includes(e.id)||u.push(e)})),u.length>0?o?(r&&r("Failed files upload retry stopped for ".concat(u.length," files.")),[...s,...d]):(r&&r("Sleeping for 5 seconds to retry ".concat(u.length," failed file uploads. Make sure you're connected to the internet....")),await(0,i._v)(5e3),r&&r("Resuming program to retry the ".concat(u.length," failed file uploads. Make sure you're connected to the internet...")),w(e,u,s,u.length==t.length,r)):s};function k(e){return e.trim().replace(/[/\\?%*:|"<>]/g,"").replace(/\s+/g,"-")}const j=(e,t,n,r,l,s,c,d,u,p)=>{console.log("uploadTemplates: ","toolId",t,"templates",n,"template",r,"templateData",l,"oldTemplate",s,"oldTemplateData",c,"oldTemplatesUrl",d);const g=(e,t)=>{p&&p(e,t)},v=e=>{g(e,0)};return new Promise((async(p,j)=>{try{g("Template assets upload started...");const I=[];if(r.id||I.push("ID is missing in the template"),r.name||I.push("Please provide the template's name"),r.logo||I.push("Please provide the template's logo"),I.length>0)return j(new Error(I.join("\n")));const F=r.id;if((null===s||void 0===s?void 0:s.logo)&&x(s.logo)&&y(r.logo)){const e=s.logo,t=await(0,o.tY)(e,!0);t&&(0,o.pu)(t,r.logo)&&(r.logo=s.logo)}g("Stacking template images and logo to upload...");const M=[];for(const[e,n]of Object.entries(l.images))if(y(n)){const{image:a}=h(e,n);M.push({id:e,file:a,fileName:"templates-".concat(t,"-").concat(F,"-").concat(k(e),"-image.").concat((0,i.tD)(a.name).ext),dir:"templates"})}const O="templates-".concat(t,"-").concat(F,"-logo");if(y(r.logo)){const e=h(O,r.logo);M.push({id:O,file:e.image,fileName:"".concat(O,".").concat((0,i.tD)(e.image.name).ext),dir:"templates"})}g("Uploading template images and logo...");const A=await w(e,M,[],!1,v),P={};var S=null,C=null;g("Linking template images IDs and logo to the uploaded images..."),A.forEach((e=>{(0,a.N4)(e.error)?e.id!=O?P[e.id]=e.url:S=e.url:(C=new Error(e.error),g('The image, "'.concat(e.id,"\" failed to upload. Please make sure you're connected to the internet.")))}));for(const[e,t]of Object.entries(P))c&&b(e,c.images)&&m(b(e,c.images),t)?l.images[e]=(0,o._P)(b(e,c.images)):l.images[e]=t;if(S&&((null===s||void 0===s?void 0:s.logo)&&m(s.logo,S)?r.logo=(0,o._P)(s.logo):r.logo=S),u&&u(r,l),C)return j(C);var T=null;if(g("Checking if any changes need to be written to the template data file..."),l.svg!=(null===c||void 0===c?void 0:c.svg)||JSON.stringify(l.fields||{})!=JSON.stringify((null===c||void 0===c?void 0:c.fields)||{})||JSON.stringify(l.images||{})!=JSON.stringify((null===c||void 0===c?void 0:c.images)||{})||JSON.stringify(l.masks||{})!=JSON.stringify((null===c||void 0===c?void 0:c.masks)||{})||JSON.stringify(l.cssActions||{})!=JSON.stringify((null===c||void 0===c?void 0:c.cssActions)||{})){g("Uploading the template data file with the changes made...");const n=f(l),o="templates-".concat(t,"-").concat(F,"-data");if(T=await w(e,[{id:o,file:n,fileName:"".concat(o,".").concat((0,i.tD)(n.name).ext),dir:"templates"}],[],!1,v),!(0,a.N4)(T[0].error))return j(new Error(T[0].error))}var E=null;if(r.name!==(null===s||void 0===s?void 0:s.name)||r.logo!==(null===s||void 0===s?void 0:s.logo)||r.is_default!==(null===s||void 0===s?void 0:s.is_default)||r.split_on_download!==(null===s||void 0===s?void 0:s.split_on_download)||T){T&&((null===s||void 0===s?void 0:s.data_url)&&m(s.data_url,T[0].url)?r.data_url=(0,o._P)(s.data_url):r.data_url=T[0].url,u&&u(r,l)),g("Updating the the tool's template list data file with the new template's data...");const c=f({...n,[F]:r}),d="templates-".concat(t);if(E=await w(e,[{id:d,file:c,fileName:"".concat(d,".").concat((0,i.tD)(c.name).ext),dir:"templates"}],[],!1,v),!(0,a.N4)(E[0].error))return j(new Error(E[0].error))}var _=E?E[0].url:null;d&&_&&m(d,_)?(_=(0,o._P)(d),g("Template updated with no error \u2714\u2714"),p(_)):d?(g("No changes found in the template."),p(null)):(g("Template created with no error \u2714\u2714"),p(_))}catch(I){j(I)}}))},S=(e,t)=>{if(!t)return t;var n=t.substring("".concat(e," ").length);if(isNaN(Number(n)))return"".concat(n,", ").concat(e);switch(n.substring(n.length-1)){case"1":return"".concat(n,"st ").concat(e);case"2":return"".concat(n,"nd ").concat(e);case"3":return"".concat(n,"rd ").concat(e);default:return"".concat(n,"th ").concat(e)}},C=e=>e.replace(/_/g," ").split("@")[0],T=(e,t,n)=>{const i=null===e||void 0===e?void 0:e.visibility_code;if(i&&i.length>0&&(i.includes("==")||i.includes("!="))){let e,a=i.split("==");i.includes("==")?(a=i.split("=="),e=!1):(a=i.split("!="),e=!0);const o=a[0].trim(),r=a[1].trim(),s=e=>(0,l.l)(o,n,E,e),c=[s(((e,n)=>{var i,a,o,r;return"text_select"===(null===(i=t[e])||void 0===i?void 0:i.type)&&(null===(a=t[e])||void 0===a||null===(o=a.selections)||void 0===o?void 0:o[n])?((null===(r=t[e].selections[n])||void 0===r?void 0:r.name)||"").trim():n})),s(((e,n)=>{var i,a,o,r,l;if("text_select"===(null===(i=t[e])||void 0===i?void 0:i.type)&&(null===(a=t[e])||void 0===a||null===(o=a.selections)||void 0===o?void 0:o[n]))return((null===(l=t[e].selections[n])||void 0===l?void 0:l.value)||"").trim();if("image_select"===(null===(r=t[e])||void 0===r?void 0:r.type)){var s,c;return(null===(s=((null===(c=t[e])||void 0===c?void 0:c.options)||{})[n])||void 0===s?void 0:s.name)||""}return n})),s(((e,n)=>{var i;if("image_select"===(null===(i=t[e])||void 0===i?void 0:i.type)){var a,o;return S(t[e].name,(null===(a=((null===(o=t[e])||void 0===o?void 0:o.options)||{})[n])||void 0===a?void 0:a.name)||"")}return n}))],d=e=>{const t=e.split(/\s*(\|\||&&)\s*/);e.includes("5th");let n=u(t[0]);for(let i=2;i<t.length;i++){const e=u(t[i]),a=t[i-1];"||"===a?n=n||e:"&&"===a&&(n=n&&e)}return n},u=t=>{const n=t.trim();return e?c.some((e=>e.toLowerCase()!==n.toLowerCase())):c.some((e=>e.toLowerCase()===n.toLowerCase()))};return d(r)}return!0},E=e=>{const{type:t}=(0,r.py)(e);return!(!t||!["text","textarea"].includes(t))},_=(e,t,n,i)=>{var a;return i&&n&&["gen","date"].includes(null===(a=i[e])||void 0===a?void 0:a.type)&&(t=(0,l.l)(i[e].code,n,E,((e,t)=>{var n,a;return"text_select"==(null===(n=i[e])||void 0===n?void 0:n.type)?((null===(a=i[e].selections[t])||void 0===a?void 0:a.value)||"").trim():t}))),t}},467:function(e,t,n){n.d(t,{Z9:function(){return a},eh:function(){return o},mP:function(){return i}});const i={newData:"New Tool",noDataError:"No Tool selected",newTitle:"Tool Type",updateTitle:"Update Cost",updateMessage:"The update will cost you {PRICE}.",freeTitle:"Test Tool(Free).",freeMessage:"The downloaded Tool will have watermark.",paidTitle:"Clean Tool({PRICE})",paidMessage:"The downloaded Tool will be clean with no watermark.",signInMessage:"Please sign in to save your Tool.",signUpMessage:"Please sign up to save your Tool.",createButtonText:"Create Tool",noChatToListMessage:"Your Tool will show here",deleteWarning:"Are you sure you want to permanently delete this already saved tool?"},a=["text","textarea","text_select","gen","defgen","checkbox","date"],o=[...a,"image_select","faceshot","qrcode"]},34365:function(e,t,n){n.d(t,{Iu:function(){return o},Qj:function(){return i},Yg:function(){return a},bA:function(){return r},e3:function(){return s},h$:function(){return l}});const i=(e,t,n,i)=>0==e?0:(e=e*t/n,i?parseFloat(e.toFixed(i)):Math.ceil(e)),a=(e,t,n,i)=>0==e?0:(e=e*t/n,i?parseFloat(e.toFixed(i)):Math.ceil(e)),o=(e,t,n,o,r,l)=>"translate(".concat(i(e,n,o,3)," ").concat(a(t,r,l,3),") "),r=(e,t,n,o,r,l)=>"scale(".concat(i(e,n,o,3)," ").concat(a(t,r,l,3),") ");const l=e=>e?Array.isArray(e)?e:"object"==typeof e?function(e){const t=[];return Object.keys(e).sort(((e,t)=>parseInt("".concat(e))-parseInt("".concat(t)))).forEach((n=>{t.push(e[n])})),t}(e):[]:[],s=(e,t)=>{if(!t)return e;var n="".concat(t.replace(/\n/g,"%0A")).replace(/[ ]/g,"%20");return e.split("?")[0]+"?text=".concat(n)}},75863:function(e,t,n){var i=n(85893),a=n(51857),o=n.n(a),r=n(34292),l=n(57747),s=n(71293),c=n(85970),d=n(5418),u=n(6089),h=n(67294),f=n(94345),p=n(53754),g=n(49626);const m=e=>{let{id:t,link:n,downloadImage:a,title:o,image:c,thumbnail:d,...u}=e;return(0,i.jsxs)(r.U,{cursor:"pointer",justifyContent:"flex-start",alignItems:"flex-end",mb:4,...u,children:[(0,i.jsx)(l.xu,{as:"image",w:"40px",h:"40px",backgroundColor:"#dfdfdf",style:{backgroundImage:"url(".concat(d,")")},backgroundRepeat:"no-repeat",backgroundSize:"cover"}),(0,i.jsx)(s.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:o})]})};t.Z=e=>{let{title:t,helperText:n,info:a,textTransform:v,labelEndIcon:x,image:y,thumbnail:b,imageTitle:w,options:k,onChange:j,disabled:S,...C}=e;const[T,E]=(0,h.useState)(!1);return(0,i.jsxs)(l.xu,{...C,children:[(0,i.jsxs)(c.NI,{opacity:S?.4:1,cursor:S?"not-allowed":"pointer",children:[(0,i.jsxs)(r.U,{w:"100%",justifyContent:"space-between",alignItems:"center",children:[!t||(0,p.N4)(a)||S?(0,i.jsx)(d.l,{textTransform:v||"capitalize",mb:"0px",children:t}):(0,i.jsx)(g.Z,{as:d.l,info:a,textTransform:v||"capitalize",children:t}),x||null]}),(0,i.jsxs)(r.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),S||E(!0)},children:[(0,i.jsx)(l.xu,{width:"auto",height:"40px",maxWidth:"50px",bg:"#dfdfdf",children:b?(0,i.jsx)(u.E,{src:b,width:"auto",h:"40px",objectFit:"cover"}):null}),(0,i.jsx)(s.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:w})]}),(0,p.N4)(n)||S?null:(0,i.jsx)(c.Q6,{children:n})]}),(0,i.jsx)(f.Z,{title:t,isOpen:T,onClose:()=>{E(!1)},overflowY:"auto",children:(k||[]).map(((e,t)=>(0,i.jsx)(m,{...e,onClick:()=>{j(e),E(!1)}},t)))}),(0,i.jsx)(o(),{id:"95178590041dfe1a",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})}},62122:function(e,t,n){var i=n(85893),a=n(51857),o=n.n(a),r=n(34292),l=n(6089),s=n(71293),c=n(57747),d=n(85970),u=n(49626),h=n(36238),f=n(67294),p=n(94345),g=n(98687),m=n(55154);const v=e=>{let{id:t,name:n,logo:a,onDelete:o,...d}=e;return(0,i.jsxs)(r.U,{cursor:"pointer",justifyContent:"space-between",alignItems:"flex-end",mb:1,mx:"0.5rem",...d,children:[(0,i.jsxs)(r.U,{justifyContent:"flex-start",alignItems:"flex-end",children:[(0,i.jsx)(l.E,{src:a||"/res/svg-icon.png",w:"35px",h:"35px",borderRadius:"5px",border:"1px solid #dfdfdf"}),(0,i.jsx)(s.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:n||"No name yet"})]}),o?(0,i.jsx)(c.xu,{p:"0.5rem",onClick:()=>{o(t)},children:(0,i.jsx)(m.Xm5,{color:"#e53e3e"})}):null]})};t.Z=e=>{let{id:t,title:n,templates:a,createdTemplatesKeys:m,value:x,onChange:y,onNewTemplateSvgUploaded:b,disabled:w,errorMessage:k,info:j,helperText:S,onDelete:C,contactLink:T,...E}=e;const[_,I]=(0,f.useState)(!1),[F,M]=(0,f.useState)(),[O,A]=(0,f.useState)([]);return(0,f.useEffect)((()=>{x&&M(x)}),[x]),(0,i.jsxs)(c.xu,{...E,children:[(0,i.jsxs)(d.NI,{opacity:w?.4:1,cursor:w?"not-allowed":"pointer",children:[(0,i.jsx)(u.Z,{textTransform:"capitalize",info:j,children:n}),(0,i.jsxs)(r.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),w||I(!0)},children:[F?(0,i.jsx)(l.E,{src:F.logo||"/res/svg-icon.png",w:"35px",h:"35px",borderRadius:"5px",border:"1px solid #dfdfdf"}):null,(0,i.jsx)(s.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:F?F.name||"No name yet":"Select Template"})]})]}),(0,i.jsx)(h.Z,{type:h.Z.TYPES.none,helperText:S,errorMessage:k}),_?(0,i.jsxs)(p.Z,{title:n,isOpen:!0,onClose:()=>{I(!1)},children:[b?(0,i.jsx)(r.U,{children:(0,i.jsx)(g.Z,{showAsButton:!0,isOtherFiles:!0,w:"100%",id:"Form_".concat(t,"logo"),title:"Add Template",mb:4,info:"This is where you upload your SVG file to generate a template from.",helperText:"Click to select upload an SVG file to use as a template.",message:"Drag and Drop file here",hoverMessage:"Drop the file here",ruleMessage:"Make sure you're uploading a .svg file.",useImageText:"Use File",onChange:(e,t)=>{I(!1),b(e,t)}},"Form_".concat(t,"logo"))}):null,(0,i.jsxs)(c.xu,{height:"50vh",pos:"relative",overflowY:"auto",children:[Object.values(a).map(((e,t)=>(0,i.jsx)(v,{...e,onClick:()=>{I(!1),y(e)},border:x&&x.id===(null===e||void 0===e?void 0:e.id)?"1px dashed":"none",borderRadius:x&&x.id===(null===e||void 0===e?void 0:e.id)?"5px":"0px",_hover:{opacity:"0.4"},onDelete:m&&m.length>0&&!m.includes(e.id)?C:null},t))),!b&&T?(0,i.jsxs)(c.xu,{w:"100%",textAlign:"center",fontSize:"14px",pb:"0.5rem",children:[(0,i.jsx)(s.x,{as:"div",children:"Can't find the type you want?"}),(0,i.jsx)(s.x,{as:"a",href:T,target:"_blank",color:"#38a169",textDecoration:"underline",children:"Click here to tell us what you want."})]}):null]})]}):null,(0,i.jsx)(o(),{id:"42ccd62b5c30613c",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})}},25723:function(e,t,n){n.d(t,{_v:function(){return r},dq:function(){return l},tD:function(){return o}});var i=n(87066),a=n(11802);function o(e){const t=e.split("."),n=t.length>1&&t.pop()||"";return{name:t.join("."),ext:n}}const r=e=>new Promise((t=>setTimeout(t,e))),l=async function(e,t,n){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s=[];for(const d of t){const{id:t,file:u,fileName:h,dir:f,onFileName:p}=d,{name:g,ext:m}=o(u.name),v=p?p(g,m):h||u.name;try{const o=await e.getIdToken(),r=await i.Z.post("".concat(a.Lu,"/get-presigned-url"),{id:t,fileName:v,fileType:u.type,dir:f},{headers:{Authorization:o}}),{presignedUrl:l}=r.data;if(200===(await i.Z.put(l,u,{headers:{"Content-Type":u.type}})).status){const e=n?"".concat(n).concat(n.endsWith("/")?"":"/").concat(f||"").concat((f||"").endsWith("/")?"":"/").concat(v):l.split("?")[0];s.push({id:t,url:e})}else s.push({id:t,url:"",error:"Upload failed"})}catch(c){s.push({id:t,url:"",error:c.message})}await r(l)}return s}},80203:function(e,t,n){n.d(t,{RA:function(){return d},cr:function(){return h},qM:function(){return a}});const i=(e,t,n)=>{const i=Math.max(t,n);return e>i&&Math.abs(e-i)>=16&&Math.abs(t-n)<=1};function a(e){return new Promise((t=>{const n=new Image;n.onload=()=>t(n),n.src=e}))}function o(e){return e.toDataURL()}function r(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;const a=document.createElement("canvas"),o=a.getContext("2d");if(o){o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high";var r=t,l=t/(e.naturalWidth/e.naturalHeight);if(a.width=t,a.height=n,n>l){const t=100*(n-l)/n,a=Math.min(i,t),s=a/100*e.naturalWidth,c=s/2;l+=a/100*l,o.drawImage(e,c,0,e.naturalWidth-s,e.naturalHeight,0,n-l,r,l)}else o.drawImage(e,0,0,e.width,e.height,0,0,r,l)}return a}function l(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function s(e,t){return new Promise(((n,i)=>{const a=document.createElement("canvas");a.width=e.naturalWidth,a.height=e.naturalHeight;const o=a.getContext("2d");if(!o)return i(new Error("Could not get canvas context"));o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(e,0,0);const r=o.getImageData(0,0,e.width,e.height).data,l=t=>{for(let n=0;n<e.width;n++){const i=4*(t*e.width+n);if(0!==r[i+3])return!1}return!0};let s=0;for(let t=0;t<e.height&&l(t);t++)s++;if(s>=t)return n(e);const c=t-s,d=document.createElement("canvas");d.width=e.width,d.height=e.height;const u=d.getContext("2d");if(!u)return i(new Error("Could not get canvas context"));u.clearRect(0,0,d.width,d.height),u.drawImage(e,0,0,e.width,e.height-c,0,c,e.width,e.height-c),n(d)}))}function c(e,t,n,i,a,o,r,l,s,c,d){const u=document.createElement("canvas"),h=u.getContext("2d");if(!h)throw new Error("Could not get canvas context");if(h.imageSmoothingEnabled=!0,h.imageSmoothingQuality="high",u.width=l,u.height=s,h.translate(l/2,s/2),h.rotate(t*Math.PI/180),h.transform(n,a,o,i,0,0),r){const e=r.x-l/2,t=r.y-s/2;h.translate(e,t)}h.drawImage(e,-e.width/2,-e.height/2);const f=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=document.createElement("canvas");i.width=e instanceof HTMLImageElement?e.naturalWidth:e.width,i.height=e instanceof HTMLImageElement?e.naturalHeight:e.height;const a=i.getContext("2d");if(!a)throw new Error("Could not get canvas context");a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high",a.clearRect(0,0,i.width,i.height);const{topLeft:o,topRight:r,bottomRight:l,bottomLeft:s}=t;return a.beginPath(),a.moveTo(o.x,o.y),a.lineTo(r.x,r.y),a.lineTo(l.x,l.y),a.lineTo(s.x,s.y),a.closePath(),a.save(),a.clip(),a.drawImage(e,0,0),a.restore(),n&&(a.strokeStyle=n,a.lineWidth=2,a.beginPath(),a.moveTo(o.x,o.y),a.lineTo(r.x,r.y),a.lineTo(l.x,l.y),a.lineTo(s.x,s.y),a.closePath(),a.stroke()),i}(u,c,null===d||void 0===d?void 0:d.border);return f}async function d(e,t){const n=await function(e){return new Promise(((t,n)=>{const a=document.createElement("canvas");a.width=e.naturalWidth,a.height=e.naturalHeight;const o=a.getContext("2d");if(!o)return n(new Error("Could not get canvas context"));o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(e,0,0);const r=o.getImageData(0,0,a.width,a.height),l=r.data,s=[];for(let e=0;e<r.height;e++)for(let t=0;t<r.width;t++){const n=4*(e*r.width+t),a=l[n],o=l[n+1],c=l[n+2];i(c,a,o)&&s.push({x:t,y:e})}if(0===s.length)return t(null);const c={x:1/0,y:1/0},d={x:-1/0,y:1/0},u={x:1/0,y:-1/0},h={x:-1/0,y:-1/0};s.forEach((e=>{e.x+e.y<c.x+c.y&&(c.x=e.x,c.y=e.y),e.x-e.y>d.x-d.y&&(d.x=e.x,d.y=e.y),e.x-e.y<u.x-u.y&&(u.x=e.x,u.y=e.y),e.x+e.y>h.x+h.y&&(h.x=e.x,h.y=e.y)})),t({topLeft:c,topRight:d,bottomRight:h,bottomLeft:u})}))}(e);if(!n)throw new Error("Blue border box not found!");const{topLeft:a,topRight:o,bottomLeft:r,bottomRight:s}=n;let c=await function(e){return new Promise(((t,n)=>{const a=document.createElement("canvas");a.width=e.naturalWidth,a.height=e.naturalHeight;const o=a.getContext("2d");if(!o)return n(new Error("Could not get canvas context"));o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(e,0,0);const r=o.getImageData(0,0,a.width,a.height).data;let l={x:[],y:[]};for(let e=0;e<a.height;e++)for(let t=0;t<a.width;t++){const n=4*(e*a.width+t),o=r[n],s=r[n+1],c=r[n+2];i(o,s,c)&&(l.x.push(t),l.y.push(e))}if(0==l.x.length)return n(new Error("No red dot found"));t(l)}))}(e);if(!a||!s)throw new Error("Bounding box corners not found");const d=await function(e){return new Promise(((t,n)=>{const a=document.createElement("canvas");a.width=e.naturalWidth,a.height=e.naturalHeight;const o=a.getContext("2d");if(!o)return n(new Error("Could not get canvas context"));o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(e,0,0);const r=o.getImageData(0,0,a.width,a.height).data;let l={x:1/0,y:0},s={x:0,y:1/0},c={x:0,y:0},d={x:0,y:0};for(let e=0;e<a.height;e++)for(let t=0;t<a.width;t++){const n=4*(e*a.width+t),o=r[n],u=r[n+1],h=r[n+2];i(u,o,h)&&(t<l.x&&(l={x:t,y:e}),t>c.x&&(c={x:t,y:e}),e<s.y&&(s={x:t,y:e}),e>d.y&&(d={x:t,y:e}))}const u=e.height>e.width,h=u?l:s,f=u?c:d;if(!h||!f)return n(new Error("No green line found"));t({startPoint:h,endPoint:f})}))}(e),{startPoint:u,endPoint:h}=d,f=(p=u,g=h,{x:Math.round((p.x+g.x)/2),y:Math.round((p.y+g.y)/2)});var p,g;const m={x:c.x[c.x.length-1],y:c.y[c.y.length-1]},v=Math.round(l(m,f)),x={x:m.x,y:m.y+v},y=2*(e.height>e.width?-1:1),b=y+Math.round(function(e,t,n){const{x:i,y:a}=e,{x:o,y:r}=t,{x:l,y:s}=n;function c(e,t){return Math.atan2(t-a,e-i)}const d=c(o,r);let u=c(l,s)-d;u<0&&(u+=2*Math.PI);return u*(180/Math.PI)}(m,x,f));let w=parseFloat((l(a,o)/e.naturalWidth).toPrecision(12)),k=parseFloat((l(a,r)/e.naturalHeight).toPrecision(12));w+=.04,k+=.04;return t&&console.log("analyzeImageV6:imageA",await async function(e){const t=await fetch(e),n=await t.blob(),i=await n.arrayBuffer(),a=await crypto.subtle.digest("SHA-256",i);return Array.from(new Uint8Array(a)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(e.src),"imageA.width",e.width,"imageA.height",e.height,"corners",n,"greenLineInfo",d,"redDots",c,"center",m,"greenLineCircleRadius",v,"greenLinePreviousPosition",x,"angleFill",y,"rotationAngle",b,"shearX",0,"shearY",0),{rotationAngle:b,scaleX:w,scaleY:k,shearX:0,shearY:0,center:m,width:e.width,height:e.height,corners:n}}const u=(e,t,n,i)=>{const a=function(e){const t=e%360;return Math.abs(t-90)<=30||Math.abs(t-270)<=30?"landscape":Math.abs(t-0)<=30||Math.abs(t-180)<=30||Math.abs(t-360)<=30?"portrait":"diagonal"}(i);return"portrait"==a||"diagonal"==a?r(e,t,n):r(e,n,t)};async function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3?arguments[3]:void 0,r=await a(t);const{rotationAngle:l,scaleX:d,scaleY:h,shearX:f,shearY:p,center:g,width:m,height:v,corners:x}=e,y=m,b=v;r.width===y&&r.height===b||(r=u(r,y,b,l));const w=Math.round(n*r.height/100);r=await s(r,w);const k=c(r,l-360,d,h,f,p,g,y,b,x,i);return o(k)}},10151:function(e,t,n){n.d(t,{l:function(){return o}});var i=n(5555);class a{random(){const e=1e4*Math.sin(this.seed++);return e-Math.floor(e)}randomInt(e,t){return Math.floor(this.random()*(t-e+1))+e}constructor(e){this.seed=e}}function o(e,t,n,o){if(!e||!t)return"";function r(i,o,r){const l=n?function(e,t,n,i){if(null===e||void 0===e||null===n||void 0===n||null===t||void 0===t||null===i||void 0===i)return 0;const a=(e+Object.keys(n).filter((e=>i(e))).map((e=>n[e].toString().replace(/\s+/g,""))).join("")+t.toString()).toLowerCase();let o=0;for(let r=0;r<a.length;r++)o=(o<<5)-o+a.charCodeAt(r),o|=0;return o}(e,r,t,n):1e6*Math.random(),s=new a(l),c=e=>"string"===typeof e&&e.endsWith("d"),d=e=>!isNaN(e)&&!c("".concat(e));if(d(i)&&d(o))return s.randomInt(parseInt(i),parseInt(o)).toString();if(c(i)&&c(o)){const e=parseInt(i),t=parseInt(o);let n="",a=0;const r=s.randomInt(e,t);for(;a<r;){n+=s.randomInt(1,9).toString(),a=n.length}return n}if(c(i)){const e=parseInt(i);let t=s.randomInt(1,9).toString();for(let n=1;n<e;n++){t+=s.randomInt(0,9).toString()}return t}return d(i)?Math.round(s.random()*parseInt(i)).toString():"Invalid arguments for randomNumber function: "+"Min: ".concat(i," - ").concat(typeof i," | Max: ").concat(o," - ").concat(typeof o)}function l(e){if(!t)return"";const n=(e=e.replace(/[{}]+/g,"")).match(/(.+)\[w(\d+)\]/);if(n){const[,e,i]=n,a=o?o(e,t[e]||""):t[e];return(a||"").split(" ")[parseInt(i)-1]||""}if(e in t){return o?o(e,t[e]||""):t[e]}return""}function s(e,t,n){var i=parseInt(t),a=parseInt(n||"");return isNaN(a)?e.substring(i-1):e.substring(i-1,a)}function c(e,t,n){var a=null;switch(t){case"cut":if(n&&[1,2].includes(n.length))try{a=s(e,n[0],n[1])}catch(r){}break;case"df":if(n&&[1,2,3].includes(n.length))try{var o=n[0];a=function(e,t){const n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=["January","February","March","April","May","June","July","August","September","October","November","December"];return{YYYY:e.getFullYear().toString(),YY:String(e.getFullYear()).slice(-2),MMMM:i[e.getMonth()],MMM:i[e.getMonth()].slice(0,3),MM:String(e.getMonth()+1).padStart(2,"0"),M:(e.getMonth()+1).toString(),DD:String(e.getDate()).padStart(2,"0"),D:e.getDate().toString(),dddd:n[e.getDay()],ddd:n[e.getDay()].slice(0,3),HH:String(e.getHours()).padStart(2,"0"),H:e.getHours().toString(),hh:String(e.getHours()%12||12).padStart(2,"0"),h:(e.getHours()%12||12).toString(),mm:String(e.getMinutes()).padStart(2,"0"),m:e.getMinutes().toString(),ss:String(e.getSeconds()).padStart(2,"0"),s:e.getSeconds().toString(),A:e.getHours()<12?"AM":"PM",a:e.getHours()<12?"am":"pm"}[t]||""}("_"==e?new Date:(0,i.Ft)(e),o),n.length>1&&(a=s(a,n[1],n[2]))}catch(r){console.log(r)}}return a}const d=[];let u=0,h=e.replace(/\(([^()]*)\)/g,((e,t)=>{if(t.startsWith("rn[")){const[e,n]=t.slice(3,-1).split(",");return r(e,n,u++)}if(t.match(/^([^*]+)(\*{1,2})(\d+)$/)){const[,e,n,i]=t.match(/^([^*]+)(\*{1,2})(\d+)$/)||[],a=parseInt(i);if("*"==n)return e.repeat(a);{const t="<".concat(Math.floor(1e9*Math.random()),">");return d.push({id:t,char:e,count:a}),t}}if(t.includes("{")&&t.includes("}")){var n=function(e){const t=/{([^{}]+?)}(\.\w+\[(.*?)\])?/g,n=[];let i;for(;null!==(i=t.exec(e));){const e=i[1],t=i[2]?i[2].split("[")[0].slice(1):null,a=i[3]?i[3].split(",").map((e=>e.trim())):[],o=i.index,r=i.index+i[0].length-1,l={varKey:e,varFunc:t||void 0,varFuncArgs:a.length?a:void 0,replacementStart:o,replacementEnd:r};n.push(l)}return n}(t);n.sort(((e,t)=>t.replacementStart-e.replacementStart));for(const e of n){var i=l(e.varKey);if(e.varFunc&&(i=c(i,e.varFunc,e.varFuncArgs)),!(i&&t.length>0)){t="";break}a=t,o=i,s=e.replacementStart,h=e.replacementEnd,t=a.slice(0,s)+o+a.slice(h+1)}return t}return t;var a,o,s,h}));for(const i of d){const e=h.length-i.id.length;if(e>=i.count)break;const t=i.char.repeat(i.count-e);h=h.replace(i.id,t)}return h}}}]);