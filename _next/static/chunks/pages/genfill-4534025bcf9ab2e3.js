(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[808],{13553:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/genfill",function(){return a(29047)}])},29047:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return I}});var n=a(85893),r=(a(5397),a(26935)),o=a(44669),l=a(67294),i=a(77626),s=a(99555),c=a(53348),u=a(63183),d=(a(53754),a(34365),a(11802)),g=a(55154),p=a(7963),h=a(48783),f=a(71293),m=a(33090),v=a(34292),w=a(14225),x=a(81136);var b=()=>{const e=(0,l.useRef)(null),t=(0,l.useRef)(null),[a,r]=(0,l.useState)(""),[o,i]=(0,l.useState)(!1),s=(0,p.p)(),{image:c,handleImageUpload:u}=function(e){const[t,a]=(0,l.useState)(null);return{image:t,handleImageUpload:t=>{var n;const r=null===(n=t.target.files)||void 0===n?void 0:n[0];if(!r)return;const o=new FileReader;o.onload=t=>{var n;if(!(null===(n=t.target)||void 0===n?void 0:n.result))return;const r=new Image;r.onload=()=>{a(r);const t=e.current;if(t){t.width=r.width,t.height=r.height;const e=t.getContext("2d");e&&e.drawImage(r,0,0)}},r.src=t.target.result},o.readAsDataURL(r)}}}(e),{startDrawing:d,stopDrawing:g,drawMask:b,clearMask:D}=function(e){const[t,a]=(0,l.useState)(!1);return{startDrawing:()=>a(!0),stopDrawing:()=>a(!1),drawMask:a=>{if(!t||!e.current)return;const n=e.current.getBoundingClientRect(),r=a.clientX-n.left,o=a.clientY-n.top,l=e.current.getContext("2d");l&&(l.fillStyle="red",l.globalAlpha=.8,l.beginPath(),l.arc(r,o,15,0,2*Math.PI),l.fill())},clearMask:()=>{if(!e.current)return;const t=e.current.getContext("2d");t&&t.clearRect(0,0,e.current.width,e.current.height)}}}(t);return(0,n.jsxs)(h.g,{spacing:4,p:4,maxW:"700px",mx:"auto",children:[(0,n.jsx)(f.x,{fontSize:"2xl",fontWeight:"bold",children:"AI-Powered Generative Fill"}),(0,n.jsx)(m.I,{type:"file",accept:"image/*",onChange:u}),c&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(v.U,{spacing:4,children:[(0,n.jsx)("canvas",{ref:e,className:"border"}),(0,n.jsx)("canvas",{ref:t,className:"border",onMouseDown:d,onMouseUp:g,onMouseMove:b})]}),(0,n.jsx)(m.I,{placeholder:"Describe the fill (e.g., 'A cute cat')",value:a,onChange:e=>r(e.target.value)}),(0,n.jsxs)(v.U,{children:[(0,n.jsx)(w.z,{colorScheme:"blue",onClick:async()=>{if(c&&a.trim()){i(!0);try{var n,r;const l=new FormData;null===(n=e.current)||void 0===n||n.toBlob((e=>{e&&l.append("image",e,"image.png")}),"image/png"),null===(r=t.current)||void 0===r||r.toBlob((e=>{e&&l.append("mask",e,"mask.png")}),"image/png"),l.append("prompt",a);const i=await fetch("http://localhost:8000/inpaint",{method:"POST",body:l}),s=await i.json();if(s.image){var o;const t=new Image;t.src="data:image/png;base64,"+s.image;const a=null===(o=e.current)||void 0===o?void 0:o.getContext("2d");a&&a.drawImage(t,0,0)}}catch(l){console.error("Error applying AI fill:",l),s({title:"Failed to apply AI fill",status:"error",duration:3e3})}i(!1)}else s({title:"Please upload an image and enter a prompt!",status:"warning",duration:3e3})},isDisabled:o,children:o?(0,n.jsx)(x.$,{}):"Apply AI Fill"}),(0,n.jsx)(w.z,{colorScheme:"gray",onClick:D,children:"Clear Mask"})]})]})]})},D=a(33775);var I=()=>{const e="5vCsgJJVsFYhV4dZYQdI",t="invoices",{toolsById:a,getTool:p}=(0,D.b5)(d.JP),[h,f]=(0,l.useState)();(0,l.useEffect)((()=>{if(a){const a=p(e);f(a?{...a,icon:(0,n.jsx)(g.RcD,{size:"100%"}),collectionRuleName:t}:null)}else f(null)}),[a]);const m=(0,s.Z)(20),{getCurrentTimelineData:v}=m,w=["logo"],x=["is_freemium"],I=(0,c.Z)(50,o.V,x,w,void 0,void 0,t),{selectedIsNew:j,selectedData:C}=I,S=(0,u.Z)({collectionName:t,fileFields:w,toolId:e,historyProps:m,dataSourceProps:I,publishTexts:i.m,updatableFields:x}),{savingData:k,setSavingData:P,handleUpdateData:_,handlePublishData:N}=S;(0,l.useMemo)((()=>(0,n.jsx)(r.Z,{tool:h,collectionName:t,isNew:j(),data:C,saving:k,setSaving:P,hasPendingSave:v((null===C||void 0===C?void 0:C.id)||"none").totalUpdates>1||j(),onUpdateData:_,onPublishData:N})),[C,k,h,t]);return(0,n.jsx)(b,{})}}},function(e){e.O(0,[400,847,646,48,614,123,751,596,731,908,729,15,687,218,774,888,179],(function(){return t=13553,e(e.s=t);var t}));var t=e.O();_N_E=t}]);