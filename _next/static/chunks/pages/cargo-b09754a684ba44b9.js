(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{3451:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cargo",function(){return n(8299)}])},8299:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return X}});var i=n(5893),a=n(1802),r=n(5397),o=n(7294),s=n(7963),c=n(4292),h=n(1293),p=n(7747);const l={processing:"processing",inTransit:"inTransit",delivered:"delivered"},d={processing:"Processing",inTransit:"In transit",delivered:"Delivered"};var m=n(7918);var g=e=>{let{children:t,...n}=e;return(0,i.jsx)(h.x,{w:"100%",bg:"#00adfe",color:"#fff",textTransform:"uppercase",fontWeight:"bold",fontSize:{base:"1.2rem",lg:"1.8rem"},my:"1rem !important",display:"block",p:"0.5rem",...n,children:t})},u=n(3658),x=n(5461),k=n(1303),b=n(6691),v=n(6455),f=n.n(v),w=n(3754),E=n(5555),S=n(419),C=n(5380),T=n(5154),_=n(3471),I=n(8627);const D={min:2,max:100},y={min:1,max:100},Z={min:1,max:100},N={min:1,max:100},P={min:1,max:100},j={min:1,max:100},F={min:1,max:100},A={min:1,max:100},W={min:1,max:100},M={min:1,max:100};var Y=e=>{let{data:t,isNew:n,onUpdateData:r,onPublishData:v,saving:Y,setSaving:U,hasPendingSave:R}=e;if(!t)return null;const z=(0,s.p)(),[O,L]=(0,o.useState)(!1),{senderNameError:X,senderNameChecker:G}=(0,k.Z)((e=>e&&0!=e.length?e.length<D.min?"The sender name is too short. It must be up to ".concat(D.min," characters."):e.length>D.max?"The sender name is too long. It must not be greater than ".concat(D.max," characters."):null:"Enter the sender's name."),"senderNameError","senderNameChecker"),{senderEmailError:V,senderEmailChecker:$}=(0,k.Z)((e=>e&&0!=e.length?e.length<y.min?"The sender email is too short. It must be up to ".concat(y.min," characters."):e.length>y.max?"The sender email is too long. It must not be greater than ".concat(y.max," characters."):(0,w.vV)(e)?null:"Invalid email address.":"Enter the sender's email."),"senderEmailError","senderEmailChecker"),{recipientNameError:B,recipientNameChecker:J}=(0,k.Z)((e=>e&&0!=e.length?e.length<Z.min?"The recipient name is too short. It must be up to ".concat(Z.min," characters."):e.length>Z.max?"The recipient name is too long. It must not be greater than ".concat(Z.max," characters."):null:"Enter the recipient's name."),"recipientNameError","recipientNameChecker"),{recipientAddressError:q,recipientAddressChecker:H}=(0,k.Z)((e=>e&&0!=e.length?e.length<N.min?"The recipient address is too short. It must be up to ".concat(N.min," characters."):e.length>N.max?"The recipient address is too long. It must not be greater than ".concat(N.max," characters."):null:"Enter the recipient's address."),"recipientAddressError","recipientAddressChecker"),{recipientEmailError:K,recipientEmailChecker:Q}=(0,k.Z)((e=>e&&0!=e.length?e.length<P.min?"The recipient email is too short. It must be up to ".concat(P.min," characters."):e.length>P.max?"The recipient email is too long. It must not be greater than ".concat(P.max," characters."):(0,w.vV)(e)?null:"Invalid email address.":"Enter the recipient's email."),"recipientEmailError","recipientEmailChecker"),{recipientPhoneError:ee,recipientPhoneChecker:te}=(0,k.Z)((e=>e&&0!=e.length?e.length<j.min?"The recipient phone number is too short. It must be up to ".concat(j.min," characters."):e.length>j.max?"The recipient phone number is too long. It must not be greater than ".concat(j.max," characters."):(0,w.kj)(e)?null:"Invalid phone number.":"Enter the recipient's phone number."),"recipientPhoneError","recipientPhoneChecker"),{packageContentError:ne,packageContentChecker:ie}=(0,k.Z)((e=>e&&0!=e.length?e.length<F.min?"The package content is too short. It must be up to ".concat(F.min," characters."):e.length>F.max?"The package content is too long. It must not be greater than ".concat(F.max," characters."):null:"Enter the package content."),"packageContentError","packageContentChecker"),{packageWeightError:ae,packageWeightChecker:re}=(0,k.Z)((e=>e&&0!=e.length?e.length<A.min?"The package weight is too short. It must be up to ".concat(A.min," characters."):e.length>A.max?"The package weight is too long. It must not be greater than ".concat(A.max," characters."):null:"Enter the package weight."),"packageWeightError","packageWeightChecker"),{invoiceError:oe,invoiceChecker:se}=(0,k.Z)((e=>e&&0!=e.length?e.length<W.min?"The invoice number is too short. It must be up to ".concat(W.min," characters."):e.length>W.max?"The invoice number is too long. It must not be greater than ".concat(W.max," characters."):null:"Enter the invoice number."),"invoiceError","invoiceChecker"),{feeError:ce,feeChecker:he}=(0,k.Z)((e=>(console.log("FeeChecker:1 ",e),e&&0!=e.length?e.length<M.min?"The data fee is too short. It must be up to ".concat(M.min," characters."):e.length>M.max?"The data fee is too long. It must not be greater than ".concat(M.max," characters."):null:"Enter the shipping fee.")),"feeError","feeChecker"),pe=e=>{if(O)return;L(!0);const t=Number((e.shipmentFee||"0").replace(/\D/g,"")),n=(0,w.rx)(10,15,t),i=t-n;console.log("Download.x => (",e.shipmentFee,") shippingFeeTotal: ",t,"tax: ",n,"shippingFee: ",i);const a=(0,_.Z)({trackingId:e.id||"",invoiceNumber:e.invoiceNumber||"",senderName:e.senderName||"",senderEmail:(e.senderEmail||"").toLowerCase(),recipientName:e.packageRecipientName||"",recipientEmail:(e.packageDestinationEmail||"").toLowerCase(),recipientAddress:e.packageDestinationAddress||"",shipmentDate:((0,E.Ft)(e.shipmentDate)||new Date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),packageContent:e.packageContent||"",packageWeight:e.packageWeight||"",shippingFee:"$".concat((0,w.xz)(i)),tax:"$".concat((0,w.xz)(n)),shippingFeeTotal:"$".concat((0,w.xz)(t)),hasNoWatermark:!e.is_freemium});z({description:"Your invoice will download shortly.",status:"info",duration:4e3,isClosable:!0}),(0,_.T)(a,"png","".concat((e.packageContent||"").replaceAll(" ","").toLowerCase(),"-").concat((new Date).toISOString(),"-shipping-invoice")).then((e=>{L(!1)})).catch((e=>{L(!1),f().fire({icon:"error",title:"Download Error",text:e.message})}))};return(0,i.jsx)(I.Z,{children:(0,i.jsxs)(m.Z,{w:"100%",maxW:"700px",h:"auto",children:[t.id!=a.XA?(0,i.jsxs)(c.U,{flexWrap:"wrap",justifyContent:"space-between",children:[(0,i.jsxs)(c.U,{flexWrap:"wrap",children:[(0,i.jsxs)(h.x,{m:"0px !important",mr:1,children:["Tracking ID:"," "]}),(0,i.jsx)(S.Z,{fontWeight:"bold",m:"0px !important",mr:2,children:t.id})]}),(0,i.jsx)(x.Z,{as:"a",href:"https://mycargoroute.com",target:"_blank",bg:(0,C.z)("warning"),rightIcon:(0,i.jsx)(T.CkN,{}),children:"Visit MyCargoRoute.com"})]}):(0,i.jsxs)(c.U,{flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",children:[(0,i.jsx)(T.C5q,{})," ",(0,i.jsx)(h.x,{m:"0px !important",mr:1,children:"New Invoice"})]}),(0,i.jsx)(g,{children:"Enter Tracking Info"}),(0,i.jsx)(u.Z,{w:"100%",mb:4,id:"ShippingForm_".concat(t.id,"_status"),title:"Shipping Status",helperText:t.id!=a.XA?"Only the shipping status can be edited.":"",info:'\n                    This is the status you want to show on the checking page. \n                    "Processing" means the package is currently being checked.\n                    "In transit" means the package is currently being shipped to the recipient\'s address.\n                    "Delivered" means the package has been delivered.\n                ',type:u.Z.TYPES.select,value:t.shippingStatus,options:Object.keys(l),onOptionValue:e=>e,onOptionName:e=>d[e],onChange:e=>{r&&r({id:t.id,shippingStatus:e})}},"ShippingForm_".concat(t.id,"_status")),(0,i.jsxs)(c.U,{w:"100%",flexWrap:"wrap",mb:{base:0,lg:4},p:"0px !important",children:[(0,i.jsx)(p.xu,{w:{base:"100%",lg:"100%"},mb:{base:4,lg:0},pr:"5px !important",mx:"0px !important",width:"100%",children:(0,i.jsx)(u.Z,{disabled:!n,w:"100%",id:"ShippingForm_".concat(t.id,"_sdate"),title:"Shipment Date",info:"This is the date that the package was dropped for shipping.",type:u.Z.TYPES.date,value:(0,E.Ft)(t.shipmentDate),onChange:e=>{r&&r({id:t.id,shipmentDate:(0,E.SG)(e)})}},"ShippingForm_".concat(t.id,"_sdate"))}),(0,i.jsx)(p.xu,{w:{base:"100%",lg:"100%"},mb:{base:4,lg:0},pr:"5px !important",mx:"0px !important",width:"100%",children:(0,i.jsx)(u.Z,{disabled:!n,w:"100%",mb:{base:4,lg:0},p:"0px !important",id:"ShippingForm_".concat(t.id,"_adate"),title:"Expected Arrival Date",info:"This is the date the package is expected to arrive at the recipient's address.",type:u.Z.TYPES.date,value:(0,E.Ft)(t.expectedArrivalDate),onChange:e=>{r&&r({id:t.id,expectedArrivalDate:(0,E.SG)(e)})}},"ShippingForm_".concat(t.id,"_adate"))})]}),(0,i.jsx)(g,{children:"Enter Sender Info"}),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",id:"ShippingForm_".concat(t.id,"_sname"),title:"Sender Name",mb:4,placeholder:"Enter sender's name",info:"The full name of the individual sending the package; that is you.",type:u.Z.TYPES.text,value:t.senderName,onChange:e=>{r&&r({id:t.id,senderName:e})},errorMessage:X,onCheckInfo:G},"ShippingForm_".concat(t.id,"_sname")),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",id:"ShippingForm_".concat(t.id,"_smail"),title:"Sender Email Address",placeholder:"Enter sender's email address",info:"The email address of the individual sending the package; that is yours.",type:u.Z.TYPES.email,value:t.senderEmail,onChange:e=>{r&&r({id:t.id,senderEmail:e})},errorMessage:V,onCheckInfo:$},"ShippingForm_".concat(t.id,"_smail")),(0,i.jsx)(g,{children:"Enter Shipping Info"}),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",id:"ShippingForm_".concat(t.id,"_rname"),title:"Recipient Name",mb:4,placeholder:"Enter recipient's name",info:"The full name of the individual the package is being sent to.",type:u.Z.TYPES.text,value:t.packageRecipientName,onChange:e=>{r&&r({id:t.id,packageRecipientName:e})},errorMessage:B,onCheckInfo:J},"ShippingForm_".concat(t.id,"_rname")),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",mb:4,id:"ShippingForm_".concat(t.id,"_raddr"),title:"Recipient Address",placeholder:"Enter recipient's address",info:"The home address of the individual the package is being sent to.",type:u.Z.TYPES.text,value:t.packageDestinationAddress,onChange:e=>{r&&r({id:t.id,packageDestinationAddress:e})},errorMessage:q,onCheckInfo:H},"ShippingForm_".concat(t.id,"_raddr")),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",mb:4,id:"ShippingForm_".concat(t.id,"_rmail"),title:"Recipient Email Address",placeholder:"Enter recipient's email address",info:"The email address of the individual the package is being sent to.",type:u.Z.TYPES.email,value:t.packageDestinationEmail,onChange:e=>{r&&r({id:t.id,packageDestinationEmail:e})},errorMessage:K,onCheckInfo:Q},"ShippingForm_".concat(t.id,"_rmail")),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",mb:4,id:"ShippingForm_".concat(t.id,"_rnum"),title:"Recipient Phone",placeholder:"Enter recipient's phone number",info:"The phone number of the individual the package is being sent to.",type:u.Z.TYPES.text,value:t.packageDestinationPhone,onChange:e=>{r&&r({id:t.id,packageDestinationPhone:e})},errorMessage:ee,onCheckInfo:te},"ShippingForm_".concat(t.id,"_rnum")),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",mb:4,id:"ShippingForm_".concat(t.id,"_content"),title:"Package Content",placeholder:"Enter content",info:"The content in the package you're shipping.",type:u.Z.TYPES.text,value:t.packageContent,onChange:e=>{r&&r({id:t.id,packageContent:e})},errorMessage:ne,onCheckInfo:ie},"ShippingForm_".concat(t.id,"_content")),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",id:"ShippingForm_".concat(t.id,"_weight"),title:"Package weight",placeholder:"Enter weight",info:"The weight of the package you're shipping.",type:u.Z.TYPES.text,value:t.packageWeight,onChange:e=>{r&&r({id:t.id,packageWeight:e})},errorMessage:ae,onCheckInfo:ie},"ShippingForm_".concat(t.id,"_weight")),(0,i.jsx)(g,{children:"Enter Invoice Info"}),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",id:"ShippingForm_".concat(t.id,"_inv"),title:"Invoice Number",mb:4,placeholder:"Enter Invoice number",info:"This is the invoice number you want to give to the package.",type:u.Z.TYPES.text,value:t.invoiceNumber,onChange:e=>{r&&r({id:t.id,invoiceNumber:e})},errorMessage:oe,onCheckInfo:se},"ShippingForm_".concat(t.id,"_inv")),(0,i.jsx)(u.Z,{disabled:!n,w:"100%",id:"ShippingForm_".concat(t.id,"_fee"),title:"Shipment Fee",placeholder:"Enter data fee",info:"This is the amount in US dollar you want to show as the cost of the shipping. E.g 2500",helperText:"Shipping fee/cost in US dollar. Do not put dollar symbol. Just numbers.",type:u.Z.TYPES.text,iconLeft:"$",numberDecimals:0,value:t.shipmentFee,onChange:e=>{r&&r({id:t.id,shipmentFee:e})},errorMessage:ce,onCheckInfo:he},"ShippingForm_".concat(t.id,"_fee")),(0,i.jsxs)(c.U,{w:"100%",justifyContent:"center",my:8,flexWrap:"wrap",children:[(0,i.jsx)(x.Z,{status:Y?"loading":"warning",fontStyle:Y?"italic":"normal",disabled:Y||!R&&!t.is_freemium,w:"100%",maxW:"400px",h:"70px",fontSize:"lg",onClick:async()=>{if(!v||Y)return;U(!0);const e=[G().checker(t.senderName),$().checker(t.senderEmail),J().checker(t.packageRecipientName),H().checker(t.packageDestinationAddress),Q().checker(t.packageDestinationEmail),te().checker(t.packageDestinationPhone),ie().checker(t.packageContent),re().checker(t.packageWeight),se().checker(t.invoiceNumber),he().checker(t.shipmentFee)];(await Promise.all(e)).includes(!1)?(U(!1),f().fire({text:"You have some errors in your form. Please check the error message(s) at the input(s) and try again."})):(U(!1),v().then((e=>{U(!1),z({description:n?"New Shipping successfully saved.":"Shipping successfully updated.",status:"success",duration:4e3,isClosable:!0}),n&&pe(e)})).catch((e=>{U(!1),((null===e||void 0===e?void 0:e.message)||"").length>0&&f().fire({icon:"error",title:n?"Shipping Creation Error":"Shipping Update Error",text:e.message})})))},rightIcon:Y?(0,i.jsx)(b.Z,{size:"1rem",color:"#fff",type:b.Z.TYPES.threeDots}):null,children:Y?"Please wait...":n?"Create Invoice":t.is_freemium?"Remove Watermark":"Update Invoice"}),(0,i.jsx)(x.Z,{status:Y?"loading":"warning",outlined:!0,fontStyle:Y?"italic":"normal",disabled:Y,w:"100%",maxW:"400px",h:"70px",fontSize:"lg",onClick:()=>{n?f().fire({icon:"error",title:"Download error",text:"You're yet to create the invoice. Create invoice first, then download."}):pe(t)},rightIcon:(0,i.jsx)(T.ZJh,{}),children:Y?"Please wait...":"Download Invoice"})]})]})})};const U=()=>{const e=new Date,t=new Date;t.setTime(t.getTime()+2592e5);return{shippingStatus:"processing",shipmentDate:(0,E.SG)(e),expectedArrivalDate:(0,E.SG)(t)}},R={newData:"New Shipment",noDataError:"No Shipment selected",newTitle:"Shipment Type",updateTitle:"Update Cost",updateMessage:"The update will cost you {PRICE}.",freeTitle:"Test Shipment(Free).",freeMessage:"The downloaded shipping invoice will have watermark. The shipping tracking website page will also have watermark.",paidTitle:"Clean Shipment({PRICE})",paidMessage:"The downloaded shipping invoice will be clean with no watermark. The shipping tracking website page will also be clean with no watermark.",signInMessage:"Please sign in to save your shipment.",signUpMessage:"Please sign up to save your shipment.",createButtonText:"Create Invoice",noChatToListMessage:"Your invoices will show here"};var z=n(9555),O=n(3348),L=n(3183);var X=()=>{const e="shipments",t=(0,z.Z)(5),{getCurrentTimelineData:n}=t,s=(0,O.Z)(e,50,U,["shippingStatus"]),{selectedIsNew:c,selectedData:h}=s,p=(0,L.Z)({collectionName:e,historyProps:t,dataSourceProps:s,publishTexts:R}),{savingData:l,setSavingData:m,handleUpdateData:g,handlePublishData:u}=p,x=(0,o.useMemo)((()=>(0,i.jsx)(Y,{isNew:c(),data:h,saving:l,setSaving:m,hasPendingSave:n((null===h||void 0===h?void 0:h.id)||"none").totalUpdates>1||c(),onUpdateData:g,onPublishData:u})),[c,h,l,m,n,g,u]);return(0,i.jsx)(r.Z,{tool:a.Tk.cargo,form:x,historyProps:t,dataSourceProps:s,dataHandlerProps:p,publishTexts:R,getItemName:e=>{var t="";return e.packageContent?t+=e.packageContent:e.id==a.XA&&(t+="New Invoice..."),e.invoiceNumber&&(t+=" - "+e.invoiceNumber),t},getItemBadge:e=>(null===e||void 0===e?void 0:e.shippingStatus)?d[e.shippingStatus]:null,getItemDescription:e=>(null===e||void 0===e?void 0:e.packageDestinationAddress)?null===e||void 0===e?void 0:e.packageDestinationAddress:null,onOverWriteCopiedData:e=>e})}}},function(e){e.O(0,[767,339,725,237,774,888,179],(function(){return t=3451,e(e.s=t);var t}));var t=e.O();_N_E=t}]);