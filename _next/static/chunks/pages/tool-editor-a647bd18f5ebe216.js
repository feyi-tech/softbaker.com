(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[244],{43023:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tool-editor",function(){return n(25117)}])},34365:function(e,t,n){"use strict";n.d(t,{Iu:function(){return i},Qj:function(){return a},Yg:function(){return o},bA:function(){return r},h$:function(){return s}});const a=(e,t,n,a)=>0==e?0:(e=e*t/n,a?parseFloat(e.toFixed(a)):Math.ceil(e)),o=(e,t,n,a)=>0==e?0:(e=e*t/n,a?parseFloat(e.toFixed(a)):Math.ceil(e)),i=(e,t,n,i,r,s)=>"translate(".concat(a(e,n,i,3)," ").concat(o(t,r,s,3),") "),r=(e,t,n,i,r,s)=>"scale(".concat(a(e,n,i,3)," ").concat(o(t,r,s,3),") ");const s=e=>e?Array.isArray(e)?e:"object"==typeof e?function(e){const t=[];return Object.keys(e).sort(((e,t)=>parseInt("".concat(e))-parseInt("".concat(t)))).forEach((n=>{t.push(e[n])})),t}(e):[]:[]},75863:function(e,t,n){"use strict";var a=n(85893),o=n(51857),i=n.n(o),r=n(34292),s=n(57747),l=n(71293),c=n(85970),d=n(5418),u=n(6089),h=n(67294),p=n(94345),m=n(53754),f=n(49626);const g=e=>{let{id:t,link:n,downloadImage:o,title:i,image:c,thumbnail:d,...u}=e;return(0,a.jsxs)(r.U,{cursor:"pointer",justifyContent:"flex-start",alignItems:"flex-end",mb:4,...u,children:[(0,a.jsx)(s.xu,{as:"image",w:"40px",h:"40px",backgroundColor:"#dfdfdf",style:{backgroundImage:"url(".concat(d,")")},backgroundRepeat:"no-repeat",backgroundSize:"cover"}),(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:i})]})};t.Z=e=>{let{title:t,helperText:n,info:o,textTransform:x,labelEndIcon:v,image:y,thumbnail:w,imageTitle:b,options:k,onChange:j,disabled:T,...S}=e;const[_,C]=(0,h.useState)(!1);return(0,a.jsxs)(s.xu,{...S,children:[(0,a.jsxs)(c.NI,{opacity:T?.4:1,cursor:T?"not-allowed":"pointer",children:[(0,a.jsxs)(r.U,{w:"100%",justifyContent:"space-between",alignItems:"center",children:[!t||(0,m.N4)(o)||T?(0,a.jsx)(d.l,{textTransform:x||"capitalize",mb:"0px",children:t}):(0,a.jsx)(f.Z,{as:d.l,info:o,textTransform:x||"capitalize",children:t}),v||null]}),(0,a.jsxs)(r.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),T||C(!0)},children:[(0,a.jsx)(s.xu,{width:"auto",height:"40px",bg:"#dfdfdf",children:w?(0,a.jsx)(u.E,{src:w,width:"auto",h:"40px",objectFit:"cover"}):null}),(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:b})]}),(0,m.N4)(n)||T?null:(0,a.jsx)(c.Q6,{children:n})]}),(0,a.jsx)(p.Z,{title:t,isOpen:_,onClose:()=>{C(!1)},overflowY:"auto",children:(k||[]).map(((e,t)=>(0,a.jsx)(g,{...e,onClick:()=>{j(e),C(!1)}},t)))}),(0,a.jsx)(i(),{id:"95178590041dfe1a",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})}},25117:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return nt}});var a=n(85893),o=n(11802),i=n(5397),r=n(67294),s=n(34292),l=n(57747),c=n(7963),d=n(71293),u=n(48783),h=n(93717),p=n(70959),m=n(44461),f=n(24124),g=n(84028),x=n(90889),v=n(67918),y=n(36238),w=n(85461),b=n(11303),k=n(56691),j=n(86455),T=n.n(j),S=n(53754),_=n(80419),C=n(55154),E=n(96918),I=n(65367),A=n(98303),P=n(30351);var D=n(5555);const N=(e,t)=>{if(!e)return{};const n=e.reduce(((e,t)=>e+(t.quantity||0)*(t.price||0)),0),a=(t||0)/100*n;return{calculatedSubTotal:n,calculatedVatValue:a,calculatedTotal:n+a}},Z=e=>{let{children:t}=e;return(0,a.jsxs)(s.U,{justifyContent:"flex-start",alignItems:"center",m:"0px !important",mb:"1rem !important",children:[(0,a.jsx)(C.gJy,{color:"#e53e3e"}),"\xa0",(0,a.jsx)(d.x,{as:"div",color:"#e53e3e",children:t})]})},U=e=>(null===e||void 0===e?void 0:e.message)?e.message:e;const F=e=>e?e.split("_")[2]:"$",O=e=>{let{width:t,height:n,companyName:a,companyAddress:o,customerName:i,customerAddress:r,invoiceNumber:s,currency:l,vat:c,items:d,date:u,paymentDetails:h,logoColor:p,logoUrl:m,waterMarkUrl:f,watermarkWithLogo:g,grayScaleWaterMark:x}=e;const{calculatedSubTotal:v,calculatedVatValue:y,calculatedTotal:w}=N(d,c);return'<svg width="'.concat(820,'" height="').concat(1250,'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n  <defs>\n    <style>\n        .logo-watermark {\n            opacity: 0.15;\n            ').concat(x?"filter: grayscale(100%);":"",'\n        }\n        .watermark {\n            opacity: 0.5;\n        }\n        .text-end {\n            text-anchor: end;\n        }\n        .bold { font-weight: 600; }\n        .upper { text-transform: uppercase; }\n    </style>\n  </defs>\n\n  \x3c!-- Background --\x3e\n  <rect width="100%" height="100%" fill="#ffffff" />\n    ').concat(f?'<image id="watermark" width="'.concat(t,'" height="').concat(n,'" class="watermark" xlink:href="').concat(f,'"/>'):"",'\n\n  \x3c!-- Padding for Invoice Content --\x3e\n  <g transform="translate(20, 20)"> \x3c!-- Adds 20px padding around the main content --\x3e\n    \x3c!-- Header with Logo --\x3e\n    ').concat(m?'<image id="logo" x="0" y="0" width="100" height="100" xlink:href="'.concat(m,'"/> \x3c!-- Placeholder for the logo --\x3e'):"",'\n    <text x="120" y="60" font-size="24" class="bold upper" font-family="Arial" fill="#333">').concat(a||"Enter Company Name",'</text>\n    <text x="120" y="90" font-size="14" font-family="Arial" fill="#666">').concat(o||"Enter Company Address",'</text>\n\n    \x3c!-- Yellow Horizontal Line --\x3e\n    <line x1="0" y1="130" x2="780" y2="130" stroke="').concat(p||"#ccc",'" stroke-width="5"/>\n\n    \x3c!-- Invoice Info --\x3e\n    <text x="580" y="30" font-size="24" font-family="Arial" fill="#333" class="bold upper">Invoice</text>\n    <text x="580" y="60" font-size="18" font-family="Arial" fill="#666">').concat(s||"#00000",'</text>\n    <text x="580" y="90" font-size="18" font-family="Arial" fill="#666">Date: ').concat(u?(0,D.xV)((0,D.Ft)(u),[{year:"numeric"},{month:"2-digit"},{day:"2-digit"}],"-"):"Set Invoice Date",'</text>\n\n    \x3c!-- Client Info --\x3e\n    <text x="0" y="180" font-size="20" font-family="Arial" fill="#333" class="bold upper">Bill To:</text>\n    <text x="0" y="205" font-size="20" font-family="Arial" fill="#666">').concat(i||"Enter Customer Name",'</text>\n    <text x="0" y="225" font-size="14" font-family="Arial" fill="#666">').concat(r||"Enter Customer Address",'</text>\n\n    \x3c!-- Table Header with Updated Colors --\x3e\n    <rect x="0" y="330" width="780" height="50" fill="').concat(p||"#ccc",'" /> \x3c!-- table header --\x3e\n    <text x="20" y="360" font-size="18" font-family="Arial" fill="#fff">S/N</text>\n    <text x="100" y="360" font-size="18" font-family="Arial" fill="#fff">Description</text>\n    <text x="370" y="360" font-size="18" font-family="Arial" fill="#fff">Quantity</text>\n    <text x="470" y="360" font-size="18" font-family="Arial" fill="#fff">Unit Price</text>\n    <text x="630" y="360" font-size="18" font-family="Arial" fill="#fff">Total</text>\n    <line x1="0" y1="380" x2="780" y2="380" stroke="#fff" />\n\n    \x3c!-- Table Rows --\x3e\n    ').concat(d&&d.length>0?"\n        ".concat(d.map(((e,t)=>'\n            <text x="20" y="'.concat(430+70*t,'" font-size="18" font-family="Arial" fill="#333">').concat(t+1,'</text>\n            <text x="100" y="').concat(430+70*t,'" font-size="18" font-family="Arial" fill="#333">').concat(e.description,'</text>\n            <text x="390" y="').concat(430+70*t,'" font-size="18" font-family="Arial" fill="#333">').concat(e.quantity,'</text>\n            <text x="470" y="').concat(430+70*t,'" font-size="18" font-family="Arial" fill="#333">').concat(F(l)).concat((0,S.uP)(e.price||0,2,2),'</text>\n            <text x="630" y="').concat(430+70*t,'" font-size="18" font-family="Arial" fill="#333">').concat(F(l)).concat((0,S.uP)((e.price||0)*(e.quantity||0),2,2),'</text>\n            <line x1="0" y1="').concat(460+70*t,'" x2="780" y2="').concat(460+70*t,'" stroke="#ccc" />'))).join("")):"",'\n\n    \x3c!-- Sub-Total, VAT, and Total --\x3e\n    <text x="520" y="').concat(430+70*(d||[]).length+10,'" font-size="18" font-family="Arial" fill="#333">Sub-Total:</text>\n    <text class="text-end" x="740" y="').concat(430+70*(d||[]).length+10,'" font-size="18" font-family="Arial" fill="#333">').concat(F(l)).concat((0,S.uP)(v,2,2),'</text> \x3c!-- Update as needed --\x3e\n    <line x1="520" y1="').concat(460+70*(d||[]).length+10,'" x2="780" y2="').concat(460+70*(d||[]).length+10,'" stroke="#ccc" />\n\n    <text x="520" y="').concat(460+70*(d||[]).length+10+30,'" font-size="18" font-family="Arial" fill="#333">VAT (').concat(c||0,'%):</text>\n    <text class="text-end" x="740" y="').concat(460+70*(d||[]).length+10+30,'" font-size="18" font-family="Arial" fill="#333">').concat(F(l)).concat((0,S.uP)(y,2,2),'</text> \x3c!-- Update as needed --\x3e\n    <line x1="520" y1="').concat(460+70*(d||[]).length+10+50,'" x2="780" y2="').concat(460+70*(d||[]).length+10+50,'" stroke="#ccc" />\n\n    <text x="520" y="').concat(460+70*(d||[]).length+10+80,'" font-size="18" font-family="Arial" fill="#333">Total:</text>\n    <text class="text-end" x="740" y="').concat(460+70*(d||[]).length+10+80,'" font-size="18" font-family="Arial" fill="#333">').concat(F(l)).concat((0,S.uP)(w,2,2),'</text> \x3c!-- Update as needed --\x3e\n    <line x1="520" y1="').concat(460+70*(d||[]).length+10+100,'" x2="780" y2="').concat(460+70*(d||[]).length+10+100,'" stroke="#333" />\n\n    \x3c!-- Payment Details with Table-Matching Border and Balanced Padding --\x3e\n    ').concat(h&&h.length>0?'\n        <text x="20" y="'.concat(460+70*(d||[]).length+10+100+62,'" font-size="20" font-family="Arial" fill="#333" class="bold upper">Payment details below:</text>\n        <rect x="0" y="').concat(460+70*(d||[]).length+10+100+70,'" width="780" height="').concat(30*h.split("\n").length+20,'" fill="none" stroke="').concat(p||"#ccc",'" stroke-width="2" /> \x3c!-- Border matching table color and extending to full width --\x3e\n        ').concat(h.split("\n").map(((e,t)=>'<text x="20" y="'.concat(460+70*(d||[]).length+10+100+100+30*t,'" font-size="18" font-family="Arial" fill="#666">\n            ').concat(e,"\n            </text>"))).join("")):"","\n  </g>\n\n  \x3c!-- Watermark Logo in Center with Greyscale and Opacity --\x3e\n  ").concat(m&&g?'<g transform="translate(210, 450)"> \x3c!-- Adjusted position for centering --\x3e\n        <image id="logo-watermark" width="400" height="400" class="logo-watermark" xlink:href="'.concat(m,'"/>\n    </g>'):"","\n</svg>\n  ")},z=e=>{let{isLoading:t,id:n,width:o,height:i,companyName:r,companyAddress:c,customerName:d,customerAddress:h,invoiceNumber:p,paymentDetails:m,date:f,logoUrl:g,waterMarkUrl:x,watermarkWithLogo:v,grayScaleWaterMark:y,currency:w,vat:b,items:j}=e;const T=(0,A.S)(o),S=(0,A.S)(i),_=(0,I.xi)(false,g),C=(0,I.T3)((0,I.Vt)(x).value);return(0,a.jsxs)(l.xu,{id:"AirlineDocWrapper",pos:"relative",w:"100%",children:[(0,a.jsx)(l.xu,{w:"100%",h:"100%",dangerouslySetInnerHTML:{__html:O({width:T,height:S,companyName:r,companyAddress:c,customerName:d,customerAddress:h,invoiceNumber:p,paymentDetails:m,date:f,logoColor:_.color&&_.color.length>2?"rgb(".concat(_.color[0],", ").concat(_.color[1],", ").concat(_.color[2],")"):null,logoUrl:g,currency:w,vat:b,items:j,waterMarkUrl:null===C||void 0===C?void 0:C.base64Url,watermarkWithLogo:v,grayScaleWaterMark:y})}}),(0,a.jsx)(s.U,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"${getResponsiveX(1, width, BASE_TEMPLATE_WIDTH, FRACTION_DIGITS)}",bg:"#dfdfdf",opacity:"0.7",justifyContent:"flex-start",pl:{base:"0px",md:"0px"},alignItems:"center",display:t||_.loading||C.loading?"flex":"none",w:"100%",h:"100%",children:(0,a.jsx)(k.Z,{type:k.Z.TYPES.grid,color:(0,E.Z)("colorAccent.light","colorAccent.dark"),size:"70px"})}),(0,a.jsxs)(u.g,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"${getResponsiveX(1, width, BASE_TEMPLATE_WIDTH, FRACTION_DIGITS)}",bg:"#fff",opacity:"0.7",justifyContent:"center",pl:"1rem",alignItems:"flex-start",display:_.error||C.error?"flex":"none",w:"100%",h:"100%",children:[_.error?(0,a.jsx)(Z,{children:U(_.error)}):null,C.error?(0,a.jsx)(Z,{children:U(C.error)}):null]})]})};z.downloadSvg=e=>{let{width:t,height:n,companyName:a,companyAddress:o,customerName:i,customerAddress:r,invoiceNumber:s,currency:l,vat:c,items:d,date:u,paymentDetails:h,logoUrl:p,waterMarkUrl:m,watermarkWithLogo:f,grayScaleWaterMark:g}=e;return new Promise((async(e,x)=>{var v;try{v=await(0,P.jl)(p,false)}catch(y){return x(y)}try{p=await(0,I.Ic)((0,I.Q8)(p))}catch(y){return x(y)}if(m)try{m=await(0,I.Ic)((0,I.Q8)(m))}catch(y){return x(y)}e(O({width:t,height:n,companyName:a,companyAddress:o,customerName:i,customerAddress:r,invoiceNumber:s,currency:l,vat:c,items:d,date:u,paymentDetails:h,logoColor:v&&v.length>2?"rgb(".concat(v[0],", ").concat(v[1],", ").concat(v[2],")"):null,logoUrl:p,waterMarkUrl:m,watermarkWithLogo:f,grayScaleWaterMark:g}))}))};var M=n(88627),W=(n(33471),n(86201)),L=n(41160),B=(n(34365),n(15948)),R=n(75863),Y=n(14132),q=n(45161),H=n(73267);function V(){var e,t,n,o;const i=(0,q.ff)(null===H.Z||void 0===H.Z||null===(e=H.Z.colors)||void 0===e||null===(t=e.colorAccent)||void 0===t?void 0:t.light,null===H.Z||void 0===H.Z||null===(n=H.Z.colors)||void 0===n||null===(o=n.colorAccent)||void 0===o?void 0:o.dark);return(0,a.jsx)(k.Z,{type:k.Z.TYPES.ballTrinagle,color:i,height:50,width:50,visible:!0})}var $=e=>{let{title:t,message:n,...o}=e;return(0,a.jsxs)(l.xu,{className:"loading-view",minH:"100vh",w:"100%",pos:"relative",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",...o,children:[t?(0,a.jsx)("h1",{children:t}):null,n?(0,a.jsx)(l.xu,{fontStyle:"italic",children:n}):null,(0,a.jsx)(V,{})]})},G=n(94345);var J=e=>{let{field:t,images:n,submitButtonText:o,onSettingsUpdated:i}=e;const[s,c]=(0,r.useState)({}),[d,u]=(0,r.useState)({}),[h,p]=(0,r.useState)(null),[m,f]=(0,r.useState)(!1);(0,r.useEffect)((()=>{t&&c(t)}),[t]),(0,r.useEffect)((()=>{console.info("pasrsedSvg:settings",s)}),[s]);const[g,x]=(0,r.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.xu,{onClick:()=>{x(!0)},cursor:"pointer",children:(0,a.jsx)(C.rU2,{size:"1.5rem",color:"#38a169"})}),g?(0,a.jsxs)(G.Z,{title:"".concat(t.name||""," settings"),isOpen:!0,onClose:()=>{x(!1)},dontCloseOnOverlayClick:m,children:[(0,a.jsxs)(l.xu,{height:"50vh",pos:"relative",overflowY:"auto",px:"0.5rem",children:[(0,a.jsx)(y.Z,{w:"100%",id:"helper_text",title:"Helper Text",mb:4,helperText:"Enter the text that will show below this field just like this.",info:"This is where you enter the text that will show below this field.",type:y.Z.TYPES.text,value:null===s||void 0===s?void 0:s.helperText,onChange:e=>{e&&c({...s,helperText:e})},errorMessage:d.helperText},"helper_text"),["qrcode","checkbox"].includes(t.type)?null:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{w:"100%",id:"info",title:"Info Text",mb:4,helperText:"Enter the text that will show when the user clicks the info icon on this field.",info:"This is where you enter the text that will show when the user clicks the info icon on this field just like this.",type:y.Z.TYPES.text,value:null===s||void 0===s?void 0:s.info,onChange:e=>{e&&c({...s,info:e})},errorMessage:d.info},"info"),(0,a.jsx)(y.Z,{w:"100%",id:"optional",title:"Make Optional",mb:4,helperText:"Enable this if you want this field to be optional.",type:y.Z.TYPES.checkbox,value:null===s||void 0===s?void 0:s.optional,onChange:e=>{e&&c({...s,optional:e})},errorMessage:d.optional},"optional")]})]}),(0,a.jsx)(l.xu,{mb:"1rem",children:(0,a.jsx)(w.Z,{status:"warning",mb:"1rem",onClick:()=>{m||(x(!1),i(s,null))},disabled:m,children:m?"Please wait...":o||"Submit Settings"})})]}):null]})},X=n(5121);function Q(e){const t=e.split("."),n=t.length>1&&t.pop()||"";return{name:t.join("."),ext:n}}const K=e=>new Promise((t=>setTimeout(t,e))),ee=async function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=[];for(const s of t){const{id:t,file:l,fileName:c,dir:d,onFileName:u}=s,{name:h,ext:p}=Q(l.name),m=u?u(h,p):c||l.name;try{const a=await e.getIdToken(),r=await X.Z.post("".concat(o.Lu,"/get-presigned-url"),{id:t,fileName:m,fileType:l.type,dir:d},{headers:{Authorization:a}}),{presignedUrl:s}=r.data;if(200===(await X.Z.put(s,l,{headers:{"Content-Type":l.type}})).status){const e=n?"".concat(n).concat(n.endsWith("/")?"":"/").concat(d||"").concat((d||"").endsWith("/")?"":"/").concat(m):s.split("?")[0];i.push({id:t,url:e})}else i.push({id:t,url:"",error:"Upload failed"})}catch(r){console.log("parsedSvg: error",t,r),i.push({id:t,url:"",error:r.message})}await K(a)}return i},te=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((async(n,a)=>{if(!pe(e))return e;try{const t=await fetch(e),o=await t.blob(),i=new FileReader;i.onloadend=()=>{n(i.result)},i.onerror=a,i.readAsDataURL(o)}catch(o){if(console.info("parsedSvg:masks.fe",o.message),t)return n(null);a(o)}}))};function ne(e,t){return console.info("parsedSvg:base64A: ",e.substring(0,32)),console.info("parsedSvg:base64B: ",t.substring(0,32)),e===t.split(",")[1]}function ae(e){return function(e,t){try{const n=new URL(e);return n.searchParams.delete(t),n.toString()}catch(n){return console.error("Invalid URL:",n),e}}(e,"updates")}function oe(e){const t=new URL(e),n=t.searchParams.get("updates"),a="".concat(n?parseInt(n,10)+1:1);return t.searchParams.set("updates",a),t.toString()}var ie=n(21876).Buffer;function re(e){const t="data:image/svg+xml;base64,";e.startsWith(t)&&(e=e.slice(t.length));const n=function(e){if("undefined"!==typeof ie)return ie.from(e,"base64").toString("binary");if("function"===typeof window.atob)return window.atob(e);throw new Error("Base64 decoding not supported in this environment")}(e),a=new Array(n.length);for(let i=0;i<n.length;i++)a[i]=n.charCodeAt(i);const o=new Uint8Array(a);return new TextDecoder("utf-8").decode(o)}function se(e){const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let a=0;a<e;a++){const e=Math.floor(Math.random()*t.length);n+=t.charAt(e)}return n}function le(e,t){const[n,a]=t.split(","),o=n.match(/data:(.*?);base64/);if(!o)throw new Error("Invalid base64 image format");const i=o[1],r=atob(a),s=r.length,l=new Uint8Array(s);for(let u=0;u<s;u++)l[u]=r.charCodeAt(u);const c=new Blob([l],{type:i}),d="".concat(e,".").concat(i.split("/")[1]);return{id:e,image:new File([c],d,{type:i})}}function ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data.json";const n=JSON.stringify(e,null,2),a=new Blob([n],{type:"application/json"}),o=new File([a],t,{type:"application/json"});return o}function de(e){const t=Object.entries(e);t.sort(((e,t)=>{let[,n]=e,[,a]=t;const o=(n.index||"").toString(),i=(a.index||"").toString();return o.localeCompare(i)}));const n={};for(const[a,o]of t)n[a]=o;return n}function ue(e,t){return pe(e)&&ae(e).toLowerCase()===ae(t).toLowerCase()}const he=(e,t)=>new Promise((async(n,a)=>{if(!t)return n(e);const o={};o.svg=e.svg;const i=[];for(const[l,c]of Object.entries(t.fields)){const t=e.fields[l];if(t){if(t.type!=c.type)i.push("The ".concat(c.type.split("_").join(" "),' field, "').concat(c.name,'" is misrepresented as "').concat(t.type.split("_").join(" "),'" in the new template.'));else if(c.options&&!(null===t||void 0===t?void 0:t.options))i.push("The ".concat(c.type.split("_").join(" "),' field, "').concat(c.name,'" is missing options in the new template.'));else if(c.options&&t.options)for(const e of Object.values(c.options))t.options[e.id]?t.options[e.id].type!=e.type&&i.push("The ".concat(c.type.split("_").join(" ")," ").concat(c.name,' option, "').concat(e.name,'" is misrepresented as "').concat(t.options[e.id].type.split("_").join(" "),'" in the new template.')):i.push("The ".concat(c.type.split("_").join(" ")," ").concat(c.name,' option, "').concat(e.name,'" is missing in the new template.'))}else i.push("The ".concat(c.type.split("_").join(" "),' field, "').concat(c.name,'" is missing in the new template.'))}if(Object.keys(t.images||{}).length>0&&0==Object.keys(e.images||{}).length)i.push("Images are missing in missing in the new template.");else if(Object.keys(t.images||{}).length>0)for(const l of Object.keys(t.images))e.images[l]||l.includes(".select")||i.push("The image with the id, ".concat(l," is missing in the new template."));o.fields={...t.fields,...e.fields};for(const[e,t]of Object.entries(o.fields))t.options&&(o.fields[e].options=de(t.options));var r,s;if(o.images=await(r=t.images,s={...t.images,...e.images},new Promise((async(e,t)=>{try{for(const e in r)if(r.hasOwnProperty(e)&&s.hasOwnProperty(e)){const t=r[e],n=s[e];if(t.startsWith("http")&&n.startsWith("data:image")){const a=await te(t,!0);a&&ne(a,n)&&(s[e]=t)}}e(s)}catch(n){t(n)}}))),i.length>0)return a(new Error(i.join("\n")));n(o)})),pe=e=>e.startsWith("http"),me=e=>e.startsWith("data:image")||e.startsWith("data:img"),fe=(e,t,n)=>{var a=t[e];return!a||pe(a)||me(a)?a&&(a=t["".concat(e).concat(n||"")]):a=t["".concat(t[e]).concat(n||"")],a};var ge=e=>{let{created:t,showFieldsErrors:n,fields:o,images:i,masks:c,data:d,isFieldsEditMode:p,isDragable:m,onDragged:f,onFieldDataChange:g,onAllFieldsDataChange:x,fieldDataErrorMessage:v,onSetFieldDataErrorMessage:w}=e;const[b,k]=(0,r.useState)(Object.values(o)),[j,T]=(0,r.useState)(!1);(0,r.useEffect)((()=>{k(Object.values(o));const e={...d};for(const t of Object.values(o))"image_select"==t.type&&t.options&&(e[t.id]=Object.keys(t.options)[0]);Object.keys(e).length>0&&x(e)}),[o]);const S=(e,t)=>(w({...v,[e]:null}),null);return b&&0!=b.length?(0,a.jsx)(B.Z5,{onDragEnd:e=>{if(!e.destination)return;const t=Array.from(b),[n]=t.splice(e.source.index,1);t.splice(e.destination.index,0,n);const a=t.reduce(((e,t,n)=>(e[t.id]={...t,index:n},e)),{});console.info("parsedSvg:updatedFields",a),f(a)},children:(0,a.jsx)(B.bK,{droppableId:"fields",children:e=>(0,a.jsxs)(u.g,{w:"100%",ref:e.innerRef,...e.droppableProps,children:[b.map(((e,t)=>(0,a.jsx)(B._l,{draggableId:e.id,index:t,isDragDisabled:!m,children:t=>{const r=(e=>{const t={key:e.id,id:e.id,title:"".concat(e.name||"").concat(e.optional?"(Optional)":""),helperText:e.helperText||"",info:e.info||"",placeholder:e.placeholder,onChange:t=>{S(e.id),g(e.id,t)},errorMessage:n?v[e.id]:null,labelEndIcon:p?(0,a.jsx)(J,{field:e,images:i,onSettingsUpdated:(t,n)=>{const a={...o,[e.id]:{...e,...t}},i=n?{...c||{},...n}:null;f(a,i),console.info("pasrsedSvg:settings.updated",a,i)}}):null,message:"Drag and Drop image here",hoverMessage:"Drop the image here",ruleMessage:"Make sure you're uploading an image file.",useImageText:"Use Image"};switch(e.type){case"image_upload":return(0,a.jsx)(W.Z,{width:"100%",...t,thumbnail:d[e.id]||"",onChange:(t,n)=>{n&&(S(e.id),g(e.id,n))}});case"image_select":var r;const n=Object.values(e.options||{}).map((e=>({id:e.id,title:e.name,thumbnail:fe(e.id,i,"_thumbnail"),image:{base:fe(e.id,i,"_512"),md:fe(e.id,i,"_728"),lg:fe(e.id,i)}})))||[];return(0,a.jsx)(R.Z,{width:"100%",...t,thumbnail:fe(d[e.id],i,"_thumbnail"),imageTitle:e.options?null===(r=e.options[d[e.id]])||void 0===r?void 0:r.name:"",onChange:t=>{const n=t;S(e.id,n.id),g(e.id,n.id)},options:n});case"text":return(0,a.jsx)(y.Z,{width:"100%",...t,value:d[e.id]||"",placeholder:e.name,type:"text"});case"checkbox":case"qrcode":return(0,a.jsx)(y.Z,{...t,value:d[e.id]||"",placeholder:e.name,type:"checkbox"});case"sign":return(0,a.jsx)(Y.Z,{width:"100%",...t});default:return null}})(e);return r?(0,a.jsx)("div",{ref:t.innerRef,...t.draggableProps,...t.dragHandleProps,style:{...t.draggableProps.style,width:"100%"},children:(0,a.jsxs)(s.U,{w:"100%",justifyContent:"center",alignItems:e.helperText?"center":"flex-end",mb:4,children:[(0,a.jsx)(l.xu,{width:{base:"100%",md:m?"90%":"100%"},children:r}),(0,a.jsxs)(h.k,{display:{base:"none",md:m?"flex":"none"},w:"40px",h:"40px",border:"1px dashed",pos:"relative",justifyContent:"center",alignItems:"center",children:[(0,a.jsx)(l.xu,{as:C.ZTc,position:"absolute",mb:"25px",size:"10px"}),(0,a.jsx)(l.xu,{as:C.NWQ,position:"absolute",mt:"25px",size:"10px"})]})]})}):(0,a.jsx)("div",{ref:t.innerRef,...t.draggableProps,...t.dragHandleProps,style:{display:"none"}})}},e.id))),e.placeholder]})})}):(0,a.jsx)($,{message:"Loading template assets...",minH:"100px"})},xe=n(51857),ve=n.n(xe),ye=n(85970),we=n(49626);var be={list:{id:"list",element:(0,a.jsx)(C.AeW,{}),name:"List"},penAlt:{id:"penAlt",element:(0,a.jsx)(C.mvm,{}),name:"Pen Alt"},upload:{id:"upload",element:(0,a.jsx)(C.DUB,{}),name:"Upload"},list1:{id:"list1",element:(0,a.jsx)(C.AeW,{}),name:"List1"},penAlt2:{id:"penAlt2",element:(0,a.jsx)(C.mvm,{}),name:"Pen Alt2"},upload3:{id:"upload3",element:(0,a.jsx)(C.DUB,{}),name:"Upload3"},list4:{id:"lis4",element:(0,a.jsx)(C.AeW,{}),name:"List4"},penAlt5:{id:"penAlt5",element:(0,a.jsx)(C.mvm,{}),name:"Pen Alt5"},upload6:{id:"upload6",element:(0,a.jsx)(C.DUB,{}),name:"Upload6"}};const ke=e=>{let{id:t,name:n,element:o,...i}=e;return(0,a.jsxs)(s.U,{cursor:"pointer",justifyContent:"flex-start",alignItems:"flex-end",mb:1,...i,children:[(0,a.jsx)(s.U,{w:"35px",h:"35px",justifyContent:"center",alignItems:"center",borderRadius:"5px",border:"1px solid #dfdfdf",children:o}),(0,a.jsx)(d.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:n})]})},je=e=>{let{id:t}=e;const[n,a]=(0,r.useState)();return(0,r.useEffect)((()=>{t&&be[t]&&a(be[t])}),[t]),null===n||void 0===n?void 0:n.element};var Te=e=>{let{title:t,value:n,onChange:o,disabled:i,errorMessage:c,info:u,helperText:p,...m}=e;const[f,g]=(0,r.useState)(!1),[x,v]=(0,r.useState)();return(0,r.useEffect)((()=>{n&&be[n]&&v(be[n])}),[n]),(0,a.jsxs)(l.xu,{...m,children:[(0,a.jsxs)(ye.NI,{opacity:i?.4:1,cursor:i?"not-allowed":"pointer",children:[(0,a.jsx)(we.Z,{textTransform:"capitalize",info:u,children:t}),(0,a.jsxs)(s.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),i||g(!0)},children:[(0,a.jsx)(h.k,{width:"25px",height:"25px",justifyContent:"center",alignItems:"center",p:"0px !importanr",children:x?(0,a.jsx)(a.Fragment,{children:x.element}):null}),(0,a.jsx)(d.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:x?x.name:"Select Icon"})]})]}),(0,a.jsx)(y.Z,{type:y.Z.TYPES.none,helperText:p,errorMessage:c}),f?(0,a.jsxs)(G.Z,{title:t,isOpen:!0,onClose:()=>{g(!1)},children:[(0,a.jsx)(d.x,{mb:"1rem",children:"Select an Icon."}),(0,a.jsx)(l.xu,{height:"50vh",pos:"relative",overflowY:"auto",px:"0.5rem",children:Object.values(be).map(((e,t)=>(0,a.jsx)(ke,{...e,onClick:()=>{o(e.id),g(!1)},border:n===e.id?"1px dashed":"none",borderRadius:n===e.id?"5px":"0px",_hover:{opacity:"0.4"}},t)))})]}):null,(0,a.jsx)(ve(),{id:"42ccd62b5c30613c",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})},Se=n(16344),_e=n(79230);async function Ce(e,t){return new Promise(((n,a)=>{const o=new Image;o.onload=()=>{const e=o.width/o.height,i=t/e,r=document.createElement("canvas");r.width=t,r.height=i;const s=r.getContext("2d");if(s){s.drawImage(o,0,0,t,i);const e=r.toDataURL("image/png");n(e)}else a(new Error("Failed to get canvas context"))},o.onerror=e=>{a(new Error("Failed to load image: ".concat(e)))},o.src=e}))}const Ee=e=>e.replace(/_/g," "),Ie=e=>{const[t,n]=e.split(".");if(!n)return{name:t};const[a,o]=n.split("_");return{name:t,type:a,selectIndex:o,typeAndSelectIndex:n}},Ae=(e,t,n)=>{const{name:a,type:o,selectIndex:i,typeAndSelectIndex:r}=Ie(t);if(!r)return{field:null,updatedFields:e};const s={};switch(o){case"select":var l;s.id="".concat(a,".").concat(o),s.name=Ee(a),s.type="".concat(n,"_").concat(o);const r={name:"".concat(Ee(a)," ").concat(i),id:t,index:i||0,type:n};s.options=de({...(null===(l=e[s.id])||void 0===l?void 0:l.options)||{},[r.id]:r});break;case"upload":s.id="".concat(a,".").concat(o),s.name=Ee(a),s.type="".concat(n,"_").concat(o);break;default:s.id="".concat(a,".").concat(o),s.name=Ee(a),s.type=o}return Object.keys(s).length>0&&(e[s.id]=s),{field:s,updatedFields:e}},Pe=e=>new Promise((async(t,n)=>{try{e?(0,_e.parse)(re(e)).then((async e=>{const n={};var a=[],o=[];const i=[];var r={};const s=[],l=[];for(const t of e.children){const e=(t.attributes.id||se(8)).replace(/^_+|_+$/g,"");t.attributes.id=e;const{field:c,updatedFields:d}=Ae(r,e,t.name);if(r=d,"image"==t.name){if(a.includes(t.attributes["xlink:href"])){const i=a.indexOf(t.attributes["xlink:href"]);n[e]=o[i]}else n[e]=t.attributes["xlink:href"],a.push(t.attributes["xlink:href"]),o.push(e);t.attributes["xlink:href"]="",c&&"image_select"==c.type&&i.push(e)}c?"image_select"==c.type?(t.attributes.id=c.id,l.includes(c.type)||(s.push(t),l.push(c.type))):(s.push(t),l.push(c.type)):s.push(t)}a=[],o=[],e.children=s;const c=e.attributes.width||"2",d=await(u=n,h=async(e,t)=>{const{width:n}=await(a=t,new Promise(((e,t)=>{const n=new Image;n.onload=()=>{e({width:n.width,height:n.height})},n.onerror=e=>{t(new Error("Failed to load image: ".concat(e)))},n.src=a})));var a,o={};return n==parseInt(c)&&(o={["".concat(e)]:await Ce(t,1024),["".concat(e,"_728")]:await Ce(t,728),["".concat(e,"_512")]:await Ce(t,512)}),i.includes(e)&&(o["".concat(e,"_thumbnail")]=await Ce(t,70)),Object.keys(o).length>0?o:null},new Promise((async(e,t)=>{try{const t={...u};for(const[e,n]of Object.entries(u))if(n&&me(n)){const a=await h(e,n);a&&Object.assign(t,a)}e(t)}catch(n){t(n)}})));var u,h;t({svg:(0,_e.stringify)(e),fields:r,images:d})})).catch((e=>{console.log("parsedSvg:result.error!!!: ",e.message),n(e)})):t(null)}catch(a){n(a)}}));var De=e=>{const{user:t}=(0,Se.P)(),[n,a]=(0,r.useState)(),[o,i]=(0,r.useState)(),[s,l]=(0,r.useState)({}),[c,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),[p,m]=(0,r.useState)(!1),[f,g]=(0,r.useState)(),[x,v]=(0,r.useState)(),[y,w]=(0,r.useState)(),[b,k]=(0,r.useState)(),[j,T]=(0,r.useState)(),[_,C]=(0,r.useState)(),E=e=>{if(!e)return null;var t=e.split("-")[1];return t?t.split(".")[0].trim():null};(0,r.useEffect)((()=>{const t=E(e);e&&e!=n&&t?(a(e),d(!0),g(null),X.Z.get(e).then((e=>{i(t),l((e=>{const t=Object.entries(e);t.sort(((e,t)=>{const n=e[1].name.toUpperCase(),a=t[1].name.toUpperCase();return n<a?-1:n>a?1:0}));const n={};return t.forEach((e=>{let[t,a]=e;n[t]=a})),n})(e.data)),d(!1)})).catch((e=>{g(e.message),d(!1)}))):e||(a(null),d(!1),g(null),i(null),l({}),w(null),k(null),T(null),C(null))}),[e]),(0,r.useEffect)((()=>{!(s&&Object.keys(s).length>0)||y&&b||I((e=>{if(1==Object.keys(e).length)return Object.keys(e)[0];for(const t of Object.values(e))if(t.is_default)return t.id;return Object.keys(e)[0]})(s))}),[s]);const I=e=>{const t=s[e];t&&!(0,S.N4)(t.data_url)&&(h(!0),v(null),X.Z.get(t.data_url).then((e=>{T({...t}),C({...e.data}),w({...t}),k({...e.data}),h(!1)})).catch((e=>{v(e.message),h(!1)})))};return{templatesLoading:c,templatesError:f,selectedTemplateLoading:u,selectedTemplateError:x,parsingTemplate:p,templates:s,selectedTemplate:y,selectedTemplateData:b,workingTemplate:j,workingTemplateData:_,setAsDefaulTemplate:e=>{if(j&&(T({...j,is_default:e}),e&&Object.keys(s).length>1)){for(const e of Object.keys(s))e!=j.id&&(s[e].is_default=!1);l(s)}},setWorkingTemplate:T,setWorkingTemplateData:C,selectTemplate:I,parseTemplateSvg:(e,t)=>(m(!0),new Promise(((n,a)=>{Pe(e).then((e=>{if(e){var o=y,i=b;t&&(o=null,i=null),he(e,i).then((e=>{const t={id:(null===o||void 0===o?void 0:o.id)||se(8),name:(null===o||void 0===o?void 0:o.name)||"",logo:(null===o||void 0===o?void 0:o.logo)||"",data_url:(null===o||void 0===o?void 0:o.data_url)||"",is_default:(null===o||void 0===o?void 0:o.is_default)||!1};T(t),C(e),m(!1),n({template:t,templateData:e})})).catch((e=>{m(!1),a(e)}))}else m(!1),n(null)})).catch((e=>{m(!1),a(e)}))}))),saveTemplate:()=>new Promise(((e,r)=>t?j&&_?void((e,t,n,a,o,i,r,s)=>new Promise((async(l,c)=>{try{const f=[];if(a.id||f.push("ID is missing in the template"),a.name||f.push("Please provide the template's name"),a.logo||f.push("Please provide the template's logo"),f.length>0)return c(new Error(f.join("\n")));const g=a.id;if(console.info("parsedSvg:base64BB:oldTemplate?.logo ",null===i||void 0===i?void 0:i.logo),console.info("parsedSvg:base64BB:template.logo ",a.logo),console.info("parsedSvg:base64BB:isImageDataUrl ",me(a.logo)),(null===i||void 0===i?void 0:i.logo)&&pe(i.logo)&&me(a.logo)){const e=i.logo,t=await te(e,!0);console.info("parsedSvg:base64BB:2 ",t?t.substring(0,32):"NULL"),t&&ne(t,a.logo)&&(a.logo=i.logo,console.info("parsedSvg:oldTemplate.logo ",i.logo))}const x=[];for(const[e,n]of Object.entries(o.images))if(me(n)){const{image:a}=le(e,n);x.push({id:e,file:a,fileName:"templates-".concat(t,"-").concat(g,"-").concat(e,"-image.").concat(Q(a.name).ext),dir:"templates"})}const v="templates-".concat(t,"-").concat(g,"-logo");if(me(a.logo)){const e=le(v,a.logo);x.push({id:v,file:e.image,fileName:"".concat(v,".").concat(Q(e.image.name).ext),dir:"templates"})}const y=await ee(e,x,"https://r2.softbaker.com/");console.info("parsedSvg:imagesUploadResults",y,x);const w={};var d=null,u=null;if(y.forEach((e=>{(0,S.N4)(e.error)||(u=new Error(e.error)),e.id!=v?w[e.id]=e.url:d=e.url})),u)return c(u);for(const[e,t]of Object.entries(w))r&&fe(e,r.images)&&ue(fe(e,r.images),t)?o.images[e]=oe(fe(e,r.images)):o.images[e]=t;d&&((null===i||void 0===i?void 0:i.logo)&&ue(i.logo,d)?a.logo=oe(i.logo):a.logo=d),console.info("parsedSvg:templateWithLogo",a);var h=null;if(o.svg!=(null===r||void 0===r?void 0:r.svg)||JSON.stringify(o.fields)!=JSON.stringify((null===r||void 0===r?void 0:r.fields)||{})||JSON.stringify(o.images)!=JSON.stringify((null===r||void 0===r?void 0:r.images)||{})||JSON.stringify(o.masks)!=JSON.stringify((null===r||void 0===r?void 0:r.masks)||{})){const n=ce(o),a="templates-".concat(t,"-").concat(g,"-data");if(h=await ee(e,[{id:a,file:n,fileName:"".concat(a,".").concat(Q(n.name).ext),dir:"templates"}],"https://r2.softbaker.com/"),console.info("parsedSvg:uploadedData",h),!(0,S.N4)(h[0].error))return c(new Error(h[0].error))}var p=null;if(a.name!==(null===i||void 0===i?void 0:i.name)||a.logo!==(null===i||void 0===i?void 0:i.logo)||a.is_default!==(null===i||void 0===i?void 0:i.is_default)||h){h&&((null===i||void 0===i?void 0:i.data_url)&&ue(i.data_url,h[0].url)?a.data_url=oe(i.data_url):a.data_url=h[0].url);const o=ce({...n,[g]:a}),r="templates-".concat(t);if(p=await ee(e,[{id:r,file:o,fileName:"".concat(r,".").concat(Q(o.name).ext),dir:"templates"}],"https://r2.softbaker.com/"),console.info("parsedSvg:uploadedTemplates",p[0].url,p),!(0,S.N4)(p[0].error))return c(new Error(p[0].error))}var m=p?p[0].url:null;s&&m&&ue(s,m)&&(m=oe(s)),l(m)}catch(f){c(f)}})))(t,o||se(8),s,j,_,y,b,n).then((t=>{if(t){a(t);const e=E(t);i(e),l({...s,[j.id]:j}),w(j),k(_),T(j),C(_)}e(t)})).catch(r):r(new Error("No template provided yet.")):r(new Error("Please sign in"))))}},Ne=n(6089);const Ze=e=>{let{id:t,name:n,logo:o,...i}=e;return(0,a.jsxs)(s.U,{cursor:"pointer",justifyContent:"flex-start",alignItems:"flex-end",mb:1,mx:"0.5rem",...i,children:[(0,a.jsx)(Ne.E,{src:o,w:"35px",h:"35px",borderRadius:"5px",border:"1px solid #dfdfdf"}),(0,a.jsx)(d.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:n})]})};var Ue=e=>{let{id:t,title:n,templates:o,value:i,onChange:c,onNewTemplateSvgUploaded:u,disabled:h,errorMessage:p,info:m,helperText:f,...g}=e;const[x,v]=(0,r.useState)(!1),[w,b]=(0,r.useState)();return(0,r.useEffect)((()=>{i&&b(i)}),[i]),(0,a.jsxs)(l.xu,{...g,children:[(0,a.jsxs)(ye.NI,{opacity:h?.4:1,cursor:h?"not-allowed":"pointer",children:[(0,a.jsx)(we.Z,{textTransform:"capitalize",info:m,children:n}),(0,a.jsxs)(s.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),h||v(!0)},children:[w?(0,a.jsx)(Ne.E,{src:w.logo,w:"35px",h:"35px",borderRadius:"5px",border:"1px solid #dfdfdf"}):null,(0,a.jsx)(d.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:w?w.name:"Select Template"})]})]}),(0,a.jsx)(y.Z,{type:y.Z.TYPES.none,helperText:f,errorMessage:p}),x?(0,a.jsxs)(G.Z,{title:n,isOpen:!0,onClose:()=>{v(!1)},children:[(0,a.jsx)(s.U,{children:(0,a.jsx)(W.Z,{showAsButton:!0,isOtherFiles:!0,w:"100%",id:"Form_".concat(t,"logo"),title:"Add Template",mb:4,info:"This is where you upload your SVG file to generate a template from.",helperText:"Click to select upload an SVG file to use as a template.",message:"Drag and Drop file here",hoverMessage:"Drop the file here",ruleMessage:"Make sure you're uploading a .svg file.",useImageText:"Use File",onChange:(e,t)=>{v(!1),u(e,t)}},"Form_".concat(t,"logo"))}),(0,a.jsx)(l.xu,{height:"50vh",pos:"relative",overflowY:"auto",children:Object.values(o).map(((e,t)=>(0,a.jsx)(Ze,{...e,onClick:()=>{v(!1),c(e)},border:i&&i.id===(null===e||void 0===e?void 0:e.id)?"1px dashed":"none",borderRadius:i&&i.id===(null===e||void 0===e?void 0:e.id)?"5px":"0px",_hover:{opacity:"0.4"}},t)))})]}):null,(0,a.jsx)(ve(),{id:"42ccd62b5c30613c",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})};const Fe=(e,t,n)=>new Promise(((a,o)=>{const i=document.createElement("canvas"),r=i.getContext("2d");if(!r)return o(new Error("Canvas not supported"));const s=new Image;s.src=e,s.onload=()=>{i.width=s.width,i.height=s.height,r.drawImage(s,0,0);const e=r.getImageData(0,0,i.width,i.height);t(e,n),r.putImageData(e,0,0),a(i.toDataURL())},s.onerror=o}));var Oe={Whitescale:{filter:e=>Fe(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=255,t[n+1]=255,t[n+2]=255}))},Blackscale:{filter:e=>Fe(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+1]=0,t[n+2]=0}))},Greyscale:{filter:e=>Fe(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4){const e=(t[n]+t[n+1]+t[n+2])/3;t[n]=e,t[n+1]=e,t[n+2]=e}}))},Redscale:{filter:e=>Fe(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n+1]=0,t[n+2]=0}))},Greenscale:{filter:e=>Fe(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+2]=0}))},Bluescale:{filter:e=>Fe(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+1]=0}))},Guassianblur:{filter:(e,t)=>Fe(e,((e,t)=>{const n=(null===t||void 0===t?void 0:t.radius)||5,a=e.data,o=e.width,i=e.height,r=(e,t)=>4*(t*o+e),s=new Uint8ClampedArray(a);for(let l=0;l<i;l++)for(let e=0;e<o;e++){let t=0,c=0,d=0,u=0,h=0;for(let a=-n;a<=n;a++)for(let p=-n;p<=n;p++){const n=e+p,m=l+a;if(n>=0&&n<o&&m>=0&&m<i){const e=r(n,m);t+=s[e],c+=s[e+1],d+=s[e+2],u+=s[e+3],h++}}const p=r(e,l);a[p]=t/h,a[p+1]=c/h,a[p+2]=d/h,a[p+3]=u/h}})),render:e=>{let{filterArgs:t,setFilterArgs:n}=e;return(0,a.jsx)(l.xu,{children:(0,a.jsx)(y.Z,{w:"100%",id:"filter_arg",title:"Blur radius",mb:4,helperText:"Enter the blur radius.",info:"This is where you enter the blur radius.",type:y.Z.TYPES.number,numberDecimals:0,value:(null===t||void 0===t?void 0:t.radius)||5,onChange:e=>{n({...t,radius:e})}},"filter_arg")})}}};const ze=e=>{let{children:t}=e;return(0,a.jsxs)(s.U,{justifyContent:"flex-start",alignItems:"center",m:"0px !important",mb:"1rem !important",children:[(0,a.jsx)(C.gJy,{color:"#e53e3e"}),"\xa0",(0,a.jsx)(d.x,{as:"div",color:"#e53e3e",children:t})]})},Me=(e,t,n,a,o,i)=>{if("image_select"==a.type){if(i[a.id]){const r=i[a.id];e.children[n].attributes["xlink:href"]=fe(r,o),e.children[n].attributes["data-click-field-id"]=a.id,e.children[n].attributes["data-click-element-id"]=t}}else if(["image_upload","sign"].includes(a.type))i[a.id]&&(e.children[n].attributes["xlink:href"]=o[t],e.children[n].attributes["data-click-field-id"]=a.id,e.children[n].attributes["data-click-element-id"]=t);else if("checkbox"==a.type)i[a.id]&&"image"==e.children[n].name&&(e.children[n].attributes["xlink:href"]=fe(a.id,o));else if("qrcode"==a.type)i[a.id]&&"image"==e.children[n].name&&(e.children[n].attributes["xlink:href"]=fe(a.id,o));else if("text"==a.type){for(var r=e.children[n].children[0];r.children&&r.children.length>0;)r=r.children[0];r.value=i[a.id]||"Enter ".concat(a.name)}},We=(e,t,n,a)=>new Promise((async(n,a)=>{((e,t,n)=>new Promise((async(a,o)=>{try{const o=Object.entries(e).map((async e=>{let[a,o]=e;var i,r;const s=a.split("_")[0];let l;l=["image_upload","sign"].includes(null===(i=n.fields[s])||void 0===i?void 0:i.type)?t[s]:await te(o);const c="image_select"==(null===(r=n.fields[s])||void 0===r?void 0:r.type)?s:a;return l&&!(0,S.N4)(l)&&me(l)&&n.masks&&n.masks[c],[a,l]})),i=await Promise.all(o);a(Object.fromEntries(i))}catch(i){o(i)}})))(t.images,e,t).then((o=>{(0,_e.parse)(t.svg).then((async a=>{const i=Object.keys(t.fields);a.attributes.width,a.attributes.height;for(var r=0;r<a.children.length;r++){const n=a.children[r],{name:s,type:l,selectIndex:c,typeAndSelectIndex:d}=Ie(n.attributes.id),u="".concat(s,".").concat(l);i.includes(u)&&Me(a,n.attributes.id,r,t.fields[u],o,e)}n((0,_e.stringify)(a))})).catch((e=>{a(e)}))})).catch((e=>{a(e)}))})),Le=e=>{let{isLoading:t,data:n,templateData:o,showWatermark:i,width:c,onFiltersUpdated:d}=e;const h=(0,r.useRef)(null),p=(0,A.S)(c||{base:0}),[m,f]=(0,r.useState)(),[g,x]=(0,r.useState)(),[v,b]=(0,r.useState)();(0,r.useEffect)((()=>{n&&o&&(x(!0),b(void 0),We(n,o).then((e=>{x(!1),f(e)})).catch((e=>{x(!1),b(e.message)})))}),[n,o,p]);const[j,T]=(0,r.useState)(),[S,_]=(0,r.useState)(),[C,I]=(0,r.useState)(),[P,D]=(0,r.useState)(),N=e=>{_(null),T(null),I(null),D(null)};return(0,r.useEffect)((()=>{const e=e=>{const t=e.target;if(t&&t.hasAttribute("data-click-element-id")){((e,t)=>{T(t),_(e),e&&(null===o||void 0===o?void 0:o.masks)&&(null===o||void 0===o?void 0:o.masks[e])&&(D(o.masks[e].args),I(o.masks[e].filter_id))})(t.getAttribute("data-click-element-id"),t.getAttribute("data-click-field-id"))}},t=h.current;return t&&t.addEventListener("click",e),()=>{t&&t.removeEventListener("click",e)}}),[m,o]),(0,a.jsxs)(l.xu,{id:"AirlineDocWrapper",pos:"relative",w:"100%",children:[m?(0,a.jsx)(l.xu,{ref:h,w:"100%",h:"100%",dangerouslySetInnerHTML:{__html:m}}):null,(0,a.jsx)(s.U,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"1",bg:"#dfdfdf",opacity:"0.7",justifyContent:"flex-start",pl:{base:"0px",md:"0px"},alignItems:"center",display:g||t?"flex":"none",w:"100%",h:"100%",children:(0,a.jsx)(k.Z,{type:k.Z.TYPES.grid,color:(0,E.Z)("colorAccent.light","colorAccent.dark"),size:"70px"})}),(0,a.jsx)(u.g,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"1",bg:"#fff",opacity:"0.7",justifyContent:"center",pl:"1rem",alignItems:"flex-start",display:v?"flex":"none",w:"100%",h:"100%",children:v?(0,a.jsx)(ze,{children:(Z=v,(null===Z||void 0===Z?void 0:Z.message)?Z.message:Z)}):null}),S?(0,a.jsxs)(G.Z,{title:"".concat(S||""," filter"),isOpen:!0,onClose:()=>{N()},dontCloseOnOverlayClick:!0,children:[(0,a.jsx)(y.Z,{w:"100%",mb:4,id:"filter",title:"Select Filter",helperText:"Select a filter you want applied on the user's image choice.",info:"This is the status you select a filter to apply to the user's image choice.",type:y.Z.TYPES.select,value:C||"",options:["none",...Object.keys(Oe)],onOptionValue:e=>e,onOptionName:e=>"none"==e?"--No Filter--":e,onChange:e=>{"none"==e?(I(null),D(null)):(I(e),D(null))}},"filter"),C&&Oe[C].render?Oe[C].render({filterArgs:P,setFilterArgs:D}):null,(0,a.jsx)(l.xu,{mb:"1rem",children:(0,a.jsx)(w.Z,{status:"warning",mb:"1rem",onClick:()=>{if(d){const e={...(null===o||void 0===o?void 0:o.masks)||{},[S]:C?{filter_id:C,args:P}:null};console.info("parsedSvg:draggedFr2 ",e),d(e)}N()},children:"Apply Filter"})})]}):null]});var Z};Le.getSvg=We;var Be=Le;n(32731)();const Re={min:2,max:64,required:!0},Ye={min:2,max:128,required:!0},qe={min:2,max:64,required:!0},He={min:2,max:64,required:!0},Ve={min:1,max:1e15,required:!0},$e={min:.1,max:1e15,required:!0},Ge=e=>{let{icon:t,...n}=e;return(0,a.jsxs)(s.U,{justifyContent:"space-between",alignItems:"center",...n,children:[(0,a.jsx)(l.xu,{border:"1px dashed",width:"45%",height:"1px"}),t,(0,a.jsx)(l.xu,{border:"1px dashed",width:"45%",height:"1px"})]})};var Je=e=>{let{data:t,isNew:n,onUpdateData:i,onPublishData:j,saving:I,setSaving:A,hasPendingSave:P,collectionName:D}=e;if(!t)return null;const N=(0,c.p)(),{user:Z}=(0,Se.P)(),[U,F]=(0,r.useState)(!1),[O,z]=(0,r.useState)(!1),[B,R]=(0,r.useState)(),{nameError:Y,nameChecker:q}=(0,b.Z)((e=>(0,S.N4)(e)&&Re.required?"Enter the tool name.":!(0,S.N4)(e)&&e.length<Re.min?"The tool name is too short. It must be up to ".concat(Re.min," characters."):e.length>Re.max?"The tool name is too long. It must not be greater than ".concat(Re.max," characters."):null),"nameError","nameChecker"),{descriptionError:H,descriptionChecker:V}=(0,b.Z)((e=>(0,S.N4)(e)&&Ye.required?"Enter the tool description.":!(0,S.N4)(e)&&e.length<Ye.min?"The tool description is too short. It must be up to ".concat(Ye.min," characters."):e.length>Ye.max?"The tool description is too long. It must not be greater than ".concat(Ye.max," characters."):null),"descriptionError","descriptionChecker"),{iconError:G,iconChecker:J}=(0,b.Z)((e=>(0,S.N4)(e)&&qe.required?"Select the tool icon.":null),"iconError","iconChecker"),{youtubeError:X,youtubeChecker:Q}=(0,b.Z)((e=>(0,S.N4)(e)&&He.required?"Enter the tool youtube guide link.":!(0,S.N4)(e)&&e.length<He.min?"The tool youtube guide link is too short. It must be up to ".concat(He.min," characters."):e.length>He.max?"The tool youtube guide link is too long. It must not be greater than ".concat(He.max," characters."):null),"youtubeError","youtubeChecker"),{createPriceError:K,createPriceChecker:ee}=(0,b.Z)((e=>(0,S.N4)(e)&&Ve.required?"Enter the tool create cost.":!(0,S.N4)(e)&&parseFloat(e)<Ve.min?"The tool create cost is too small. It must be up to ".concat(Ve.min,"."):parseFloat(e)>Ve.max?"The tool create cost is too much. It must not be greater than ".concat(Ve.max,"."):null),"createPriceError","createPriceChecker"),{updatePriceError:te,updatePriceChecker:ne}=(0,b.Z)((e=>(0,S.N4)(e)&&$e.required?"Enter the tool create cost.":!(0,S.N4)(e)&&parseFloat(e)<$e.min?"The tool create cost is too small. It must be up to ".concat($e.min,"."):parseFloat(e)>$e.max?"The tool create cost is too much. It must not be greater than ".concat($e.max,"."):null),"updatePriceError","updatePriceChecker"),[ae,oe]=(0,r.useState)(),[ie,re]=(0,r.useState)(!1),{templatesLoading:se,templatesError:le,selectedTemplateLoading:ce,selectedTemplateError:de,parsingTemplate:ue,templates:he,selectedTemplate:pe,selectedTemplateData:me,workingTemplate:fe,workingTemplateData:xe,setAsDefaulTemplate:ve,setWorkingTemplate:ye,setWorkingTemplateData:we,selectTemplate:be,parseTemplateSvg:ke,saveTemplate:je}=De(t.templates_url),[_e,Ce]=(0,r.useState)({}),[Ee,Ie]=(0,r.useState)({}),[Ae,Pe]=(0,r.useState)(!1),[Ne,Ze]=(0,r.useState)(!1),[Fe,Oe]=(0,r.useState)(!1);return(0,a.jsx)(M.Z,{tool:o.Tk.invoice,maxHeaderWidth:"100%",children:(0,a.jsxs)(v.Z,{w:"100%",maxW:"100%",h:"auto",children:[t.id!=o.XA?(0,a.jsx)(s.U,{flexWrap:"wrap",justifyContent:"space-between",children:(0,a.jsxs)(s.U,{flexWrap:"wrap",children:[(0,a.jsxs)(d.x,{m:"0px !important",mr:1,display:"none",children:["Tracking No:"," "]}),(0,a.jsx)(_.Z,{display:"none",fontWeight:"bold",m:"0px !important",mr:2,children:t.id})]})}):(0,a.jsxs)(u.g,{alignItems:"flex-start",children:[(0,a.jsxs)(s.U,{flexWrap:"wrap",justifyContent:"flex-start",alignItems:"center",children:[(0,a.jsx)(C.a_$,{})," ",(0,a.jsx)(d.x,{m:"0px !important",mr:1,children:"New Tool"})]}),(0,a.jsxs)(d.x,{as:"div",fontSize:"13px",children:["Click the info icon(",(0,a.jsx)(C.DAO,{style:{display:"inline"}}),") beside each form fields for help on what to enter."]})]}),(0,a.jsx)(h.k,{w:"100%",flexWrap:"wrap",m:"15px auto",children:(0,a.jsx)(l.xu,{w:{base:"100%"},bg:"#dd6b20",p:"1rem",children:(0,a.jsxs)(l.xu,{bg:(0,E.Z)("cardBg.light","cardBg.dark"),minH:"80vh",w:"100%",p:{base:"1rem"},borderRadius:"24px",children:[(0,a.jsxs)(p.m,{isFitted:!0,variant:"enclosed",children:[(0,a.jsxs)(m.t,{mb:"1em",children:[(0,a.jsx)(f.O,{children:"Edit Mode"}),(0,a.jsx)(f.O,{children:"View Mode"})]}),(0,a.jsxs)(g.n,{children:[(0,a.jsxs)(x.x,{children:[(0,a.jsx)(s.U,{w:"100%",borderBottom:Fe?"none":"2px solid",borderBottomLeftRadius:"5px",mb:4,children:(0,a.jsx)(w.Z,{status:"success",leftIcon:Fe?(0,a.jsx)(C.dSq,{}):(0,a.jsx)(C.tgn,{}),onClick:()=>{Oe(!Fe)},children:"Tool Settings"})}),Fe?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ge,{icon:(0,a.jsx)(C.p4t,{}),mt:4}),(0,a.jsx)(y.Z,{w:"100%",id:"Form_".concat(t.id,"_name"),title:"Tool name",mb:4,placeholder:"Enter the name of the tool",info:"This is what will be shown to the users as the name of the tool. It must be a name that let the user knows what the tool does.",helperText:"Enter the name of the tool. It must be a name that let the user knows what the tool does.",type:y.Z.TYPES.text,value:t.name,onChange:e=>{i&&i({id:t.id,name:e})},onCheckInfo:q,errorMessage:Y},"Form_".concat(t.id,"_name")),(0,a.jsx)(y.Z,{w:"100%",id:"Form_".concat(t.id,"_description"),title:"Tool Description",mb:4,placeholder:"Enter the description of the tool",info:"This is what will be shown to the users as the description of the tool. It must be a description that doesn't encourage crime.",helperText:"Enter the description of the tool. It must be a description that doesn't encourage crime.",type:y.Z.TYPES.textarea,value:t.description,onChange:e=>{i&&i({id:t.id,description:e})},onCheckInfo:V,errorMessage:H},"Form_".concat(t.id,"_description")),(0,a.jsx)(Te,{w:"100%",id:"Form_".concat(t.id,"_icon"),title:"Tool Icon",mb:4,placeholder:"Select an Icon for the tool",info:"This is where you select an icon that best represents the tool.",helperText:"Select an icon that best represents the tool.",type:y.Z.TYPES.text,value:t.icon,onChange:e=>{i&&i({id:t.id,icon:e})},onCheckInfo:J,errorMessage:G},"Form_".concat(t.id,"_icon")),(0,a.jsx)(y.Z,{w:"100%",id:"Form_".concat(t.id,"_youtube"),title:"Tool Youtube(Optional)",mb:4,placeholder:"Enter the youtube link of the tool",info:"This is where you enter the youtube video guide link for the tool.",helperText:"Enter the youtube video guide link for the tool.",type:y.Z.TYPES.text,value:t.youtube,onChange:e=>{i&&i({id:t.id,youtube:e})},onCheckInfo:Q,errorMessage:X},"Form_".concat(t.id,"_youtube")),(0,a.jsx)(y.Z,{w:"100%",id:"Form_".concat(t.id,"_create_price"),title:"Create Price($)",mb:4,placeholder:"Enter the cost of creating a job",info:"This is where you enter the cost of the tool usage per job.",helperText:"Enter the cost of the tool usage per job.",type:y.Z.TYPES.number,numberDecimals:0,value:t.create_price,onChange:e=>{i&&i({id:t.id,create_price:e})},onCheckInfo:ee,errorMessage:K},"Form_".concat(t.id,"_create_price")),(0,a.jsx)(y.Z,{w:"100%",id:"Form_".concat(t.id,"_update_price"),title:"Update Price($)",mb:1,placeholder:"Enter the cost of updating a job",info:"This is where you enter the cost of updating a job done with the tool.",helperText:"Enter the cost of updating a job done with the tool.",type:y.Z.TYPES.number,numberDecimals:1,value:t.update_price,onChange:e=>{i&&i({id:t.id,update_price:e})},onCheckInfo:ne,errorMessage:te},"Form_".concat(t.id,"_update_price")),(0,a.jsx)(Ge,{icon:(0,a.jsx)(C.p4t,{}),mb:4})]}):null,(0,a.jsx)(Ue,{w:"100%",id:"Form_".concat(t.id,"_select_template"),title:"Select Template",mb:4,helperText:"Select a template to edit or add.",info:"This is where you select a template to edit or a new template to add",templates:he,value:pe,onChange:e=>{e&&be(e.id)},onNewTemplateSvgUploaded:(e,t)=>{t&&ke(t,!0).then((e=>{console.log("parsedSvg:parseTemplateSvg",e)})).catch((e=>{console.log("parsedSvg:parseTemplateSvg.error",e),T().fire({icon:"error",title:"SVG template build error",text:e.message})}))},onCheckInfo:()=>null,errorMessage:null},"Form_".concat(t.id,"_select_template")),fe?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.xu,{border:"1px dashed",p:"1rem",borderRadius:"5px",mb:4,children:[(0,a.jsx)(y.Z,{w:"100%",id:"Form_".concat(t.id,"_tmp_name"),title:"Template Name",mb:4,placeholder:"Enter the template name",info:"This is where you enter a name for the template.",helperText:"Enter a name for the template.",type:y.Z.TYPES.text,numberDecimals:1,value:fe.name||"",onChange:e=>{ye({...fe,name:e})},onCheckInfo:ne,errorMessage:te},"Form_".concat(t.id,"_tmp_name")),(0,a.jsx)(W.Z,{isOtherFiles:!0,w:"100%",mb:4,id:"Form_".concat(t.id,"_tmp_logo"),title:"Template Logo",info:"This is where you upload a logo for the template.",helperText:"Select a logo for the template.",thumbnail:fe.logo,message:"Drag and Drop image here",hoverMessage:"Drop the file here",ruleMessage:"Make sure you're uploading a 70x70 image.",useImageText:"Use Image",maxFileSize:3072,onChange:(e,t)=>{ye({...fe,logo:t})},onCheckInfo:()=>null,errorMessage:null},"Form_".concat(t.id,"_tmp_logo")),(0,a.jsx)(y.Z,{w:"100%",id:"Form_".concat(t.id,"_tmp_default"),title:"Set as Default",helperText:"Enabling this set the template as the default template selected for the user.",info:"This is where you decide id you want this template to be set as the default template selected for the user.",type:y.Z.TYPES.checkbox,value:fe.is_default||!1,onChange:e=>{ve(e)},errorMessage:null},"Form_".concat(t.id,"_tmp_default"))]}),se||ce?(0,a.jsx)($,{message:"Loading template assets...",minH:"100px"}):xe?(0,a.jsx)(ge,{isFieldsEditMode:!0,created:Ne,showFieldsErrors:Ae,fields:xe.fields,images:xe.images,masks:xe.masks,data:_e,isDragable:!0,onDragged:(e,t)=>{console.info("parsedSvg:draggedz ",e,t),we({...xe,fields:e,...t?{masks:t}:{}})},onAllFieldsDataChange:Ce,onFieldDataChange:(e,t)=>{Ce({..._e,[e]:t})},fieldDataErrorMessage:Ee,onSetFieldDataErrorMessage:Ie}):null]}):null]}),(0,a.jsx)(x.x,{bg:"#dcdcdc",p:"0px",children:(0,a.jsx)(L.Z,{width:"100%",message:"Drag around to view the whole tool",height:{base:500,md:728,lg:1024},pos:"relative",overflowX:"hidden",overflowY:"hidden",children:(0,a.jsx)(Be,{isLoading:U,width:{base:512,md:728,lg:1024},data:_e,templateData:xe,showWatermark:!!t.is_freemium,onFiltersUpdated:e=>{console.info("parsedSvg:draggedF ",e,xe),xe&&we({...xe,masks:{...e||{}}})}})})})]})]}),(0,a.jsx)(u.g,{w:"100%",justifyContent:"flex-start",alignItems:"center",my:8,children:(0,a.jsx)(w.Z,{status:I&&!ie?"loading":"warning",fontStyle:I&&!ie?"italic":"normal",disabled:I,w:"100%",maxW:"400px",h:"70px",fontSize:"lg",onClick:async()=>{if(!j)return;A(!0);const e=[q().checker(t.name),J().checker(t.icon),Q().checker(t.youtube),ee().checker(t.create_price),ne().checker(t.update_price)];(await Promise.all(e)).includes(!1)?(A(!1),T().fire({title:"Form Error",icon:"error",text:"You have some errors in your form. Please check the error message(s) at the input(s) and try again."})):je().then((e=>{var a=null;i&&e&&(i({id:t.id,templates_url:e}),a={templates_url:e}),A(!1),console.info("parsedSvg:templatesUrl",e),a&&j(!1,null,a).then((e=>{A(!1),N({description:n?"New Tool successfully saved.":"Tool successfully updated.",status:"success",duration:4e3,isClosable:!0}),oe(!0)})).catch((e=>{A(!1),((null===e||void 0===e?void 0:e.message)||"").length>0&&T().fire({icon:"error",title:n?"Tool Creation Error":"Tool Update Error",text:e.message})}))})).catch((e=>{A(!1),((null===e||void 0===e?void 0:e.message)||"").length>0&&T().fire({icon:"error",title:n?"Tool Creation Error":"Tool Update Error",text:e.message})}))},rightIcon:I&&!ie?(0,a.jsx)(k.Z,{size:"1rem",color:"#fff",type:k.Z.TYPES.threeDots}):null,children:I&&!ie?"Please wait...":n?"Create Tool":"Update Tool"})})]})})})]})})};const Xe=()=>({id:o.XA,authorId:"uid",allow_freemium:!0,create_price:5,update_price:.1,is_freemium:!0}),Qe={newData:"New Tool",noDataError:"No Tool selected",newTitle:"Tool Type",updateTitle:"Update Cost",updateMessage:"The update will cost you {PRICE}.",freeTitle:"Test Tool(Free).",freeMessage:"The downloaded Tool will have watermark.",paidTitle:"Clean Tool({PRICE})",paidMessage:"The downloaded Tool will be clean with no watermark.",signInMessage:"Please sign in to save your Tool.",signUpMessage:"Please sign up to save your Tool.",createButtonText:"Create Tool",noChatToListMessage:"Your Tool will show here",deleteWarning:"Are you sure you want to permanently delete this already saved tool?"};var Ke=n(99555),et=n(53348),tt=n(63183);var nt=()=>{const e=o.Tk.tool_editor.collectionRuleName,t=o.Tk.tool_editor.toolVersionCode,n=(0,Ke.Z)(20),{getCurrentTimelineData:c}=n,u=[],h=["is_freemium","name","description","icon","youtube","create_price","update_price","templates_url"],p=(0,et.Z)(e,50,Xe,h,u),{selectedIsNew:m,selectedData:f}=p,g=(0,tt.Z)({collectionName:e,fileFields:u,toolVersionCode:t,historyProps:n,dataSourceProps:p,publishTexts:Qe,updatableFields:h}),{savingData:x,setSavingData:v,handleUpdateData:y,handlePublishData:w}=g,b=(0,r.useMemo)((()=>(0,a.jsx)(Je,{collectionName:e,isNew:m(),data:f,saving:x,setSaving:v,hasPendingSave:c((null===f||void 0===f?void 0:f.id)||"none").totalUpdates>1||m(),onUpdateData:y,onPublishData:w})),[m,f,x,v,c,y,w,e]);return(0,a.jsx)(i.Z,{tool:o.Tk.tool_editor,form:b,historyProps:n,dataSourceProps:p,dataHandlerProps:g,publishTexts:Qe,getItemName:e=>{const t=e;return(0,a.jsxs)(s.U,{children:[(0,a.jsx)(l.xu,{children:(0,a.jsx)(je,{id:t.icon})}),(0,a.jsx)(d.x,{children:t.name||"No Tool Name"})]})},getItemDescription:e=>e.description,getItemBadge:e=>{const t=e;return"$".concat((0,S.uP)(t.create_price,2,2)," - $").concat((0,S.uP)(t.update_price,2,2))},onOverWriteCopiedData:e=>({...e,templates_url:null,is_freemium:!0})})}}},function(e){e.O(0,[847,630,201,394,493,731,162,986,814,238,590,46,372,106,774,888,179],(function(){return t=43023,e(e.s=t);var t}));var t=e.O();_N_E=t}]);