"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[393],{32033:function(e,t,n){n.d(t,{Z:function(){return F}});var a=n(85893),i=n(67294),r=n(57747),o=n(48783),s=n(34292),l=n(93717),c=n(15948),d=n(98687),u=n(75863),h=n(14132),f=n(36238),p=n(55154),g=n(53754),m=n(38118),x=n(94345),v=n(71293),b=n(85461),w=n(33471),y=n(73804),k=n(96918);var j=e=>{let{textAreaData:t,delimiter:n,value:s,onChange:l,suggestions:c,onSuggestionSelected:d,...u}=e;const[h,p]=(0,i.useState)(s||""),[g,m]=(0,i.useState)([]),[x,b]=(0,i.useState)(!1),[w,j]=(0,i.useState)(0);(0,i.useEffect)((()=>{p(s||"")}),[s]);const S=e=>{((e,t)=>{if(null==e||void 0==e)return;p(e),j(t);const a=e.slice(0,t).lastIndexOf(n),i=e.slice(a+n.length,t);if(-1===a||!/^[a-zA-Z]*$/.test(i)&&0!==i.length)b(!1);else{let e;e=0===i.length?c:c.filter((e=>e.toLowerCase().startsWith(i.toLowerCase()))),m(e),b(e.length>0)}l&&l(e)})(e.target.value,e.target.selectionStart||0)};return(0,a.jsxs)(r.xu,{w:"100%",overflowX:"hidden",...u,children:[(0,a.jsx)(f.Z,{w:"100%",value:h,onChange:(e,t)=>S(t),onClick:e=>S(e),onKeyUp:e=>S(e),...t}),x&&(0,a.jsx)(o.g,{position:"absolute",zIndex:"5",w:"100%",boxShadow:"md",borderRadius:"md",height:"120px",width:"100%",overflowY:"auto",overflowX:"hidden",bg:(0,k.Z)("dropDownBg.light","dropDownBg.dark"),children:(0,a.jsx)(y.aV,{w:"100%",overflowX:"hidden",children:g.map(((e,t)=>(0,a.jsx)(y.HC,{overflowX:"hidden",p:"2",cursor:"pointer",_hover:{border:"1px solid",borderRadius:"3px"},onClick:()=>(e=>{const t=h.slice(0,w).lastIndexOf(n),a=h.slice(0,t+n.length)+e+h.slice(w);p(a),b(!1),n.length,e.length,d(e,t+n.length,a)})(e),children:(0,a.jsx)(v.x,{children:e})},t)))})})]})};const S="FIELDS_SETTINGS",C=()=>{const e=localStorage.getItem(S);let t={};try{e&&(t=JSON.parse(e))}catch(n){}return t};var I=e=>{let{fields:t,field:n,images:o,submitButtonText:s,onSettingsUpdated:l}=e;const[c,d]=(0,i.useState)({}),[u,h]=(0,i.useState)({}),[g,m]=(0,i.useState)(null),[y,k]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(n){var e,t,a,i,r,o;const s={...n};let l=C();!s.helperText&&(null===(e=l[n.id])||void 0===e?void 0:e.helperText)&&(s.helperText=l[n.id].helperText),!s.info&&(null===(t=l[n.id])||void 0===t?void 0:t.info)&&(s.info=l[n.id].info),!s.ruleMessage&&(null===(a=l[n.id])||void 0===a?void 0:a.ruleMessage)&&(s.ruleMessage=l[n.id].ruleMessage),!s.placeholder&&(null===(i=l[n.id])||void 0===i?void 0:i.placeholder)&&(s.placeholder=l[n.id].placeholder),!s.name&&(null===(r=l[n.id])||void 0===r?void 0:r.name)&&(s.name=l[n.id].name),!s.optional&&(null===(o=l[n.id])||void 0===o?void 0:o.optional)&&(s.optional=l[n.id].optional),d(s)}}),[n]),(0,i.useEffect)((()=>{}),[c]);const[I,E]=(0,i.useState)(!1),T=e=>{if(n.id){if(Object.values(e).length>0){const t=Object.values(e)[0];if(!("string"===typeof t&&0==t.length)){let t=C();t[n.id]={...t[n.id]||{},...e},localStorage.setItem(S,JSON.stringify(t))}}d({...c,...e})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.xu,{onClick:()=>{E(!0)},cursor:"pointer",children:(0,a.jsx)(p.rU2,{size:"1.5rem",color:["gen","defgen"].includes(n.type)?"#dd6b20":"#38a169"})}),I?(0,a.jsxs)(x.Z,{title:"".concat(n.name||""," settings"),isOpen:!0,onClose:()=>{E(!1)},dontCloseOnOverlayClick:y,children:[(0,a.jsxs)(r.xu,{height:"50vh",pos:"relative",overflowY:"auto",overflowX:"hidden",px:"0.5rem",children:[(0,a.jsx)(v.x,{display:"none",children:n.type}),["gen","defgen"].includes(n.type)?(0,a.jsx)(j,{w:"100%",textAreaData:{id:"gen",key:"gen",title:"Text Generation Code",helperText:"".concat((0,w.VH)(n.placeholder||""),"."),info:"This is where you enter the code for the text generation: ".concat((0,w.VH)(n.placeholder||""),"."),type:f.Z.TYPES.textarea,value:null===c||void 0===c?void 0:c.code,onChange:e=>{e&&d({...c,code:e})},errorMessage:u.code},mb:4,delimiter:"{",suggestions:Object.keys(t),onSuggestionSelected:(e,t,n)=>{n&&d({...c,code:n})}}):null,["image_upload","faceshot"].includes(n.type)?(0,a.jsx)(f.Z,{w:"100%",id:"upload",title:"File Rule",mb:4,helperText:'Enter the rule of the file. e.g "For best result, upload a 300x300 image."',info:'This is where you enter the rule of the file. e.g "For best result, upload a 300x300 image."',type:f.Z.TYPES.text,value:null===c||void 0===c?void 0:c.ruleMessage,onChange:e=>{e&&T({ruleMessage:e})},errorMessage:u.ruleMessage},"upload"):null,(0,a.jsx)(f.Z,{w:"100%",id:"name",title:"Name",mb:4,helperText:"Enter the text that will show as the name of the field.",info:"This is where you enter the text that will show as the name of the field.",type:f.Z.TYPES.text,value:null===c||void 0===c?void 0:c.name,onChange:e=>{e&&T({name:e})},errorMessage:u.name},"name"),["text","textarea","defgen"].includes(n.type)?(0,a.jsx)(f.Z,{w:"100%",id:"placeholder",title:"Placeholder",mb:4,helperText:"Enter the text that will show behind the text field as an example input.",info:"This is where you enter the text that will show behind the text field as an example input.",type:f.Z.TYPES.textarea,value:null===c||void 0===c?void 0:c.placeholder,onChange:e=>{e&&T({placeholder:e})},errorMessage:u.placeholder},"placeholder"):null,"gen"!==n.type?(0,a.jsx)(f.Z,{w:"100%",id:"helper_text",title:"Helper Text",mb:4,helperText:"Enter the text that will show below this field just like this.",info:"This is where you enter the text that will show below this field.",type:f.Z.TYPES.text,value:null===c||void 0===c?void 0:c.helperText,onChange:e=>{e&&T({helperText:e})},errorMessage:u.helperText},"helper_text"):null,["qrcode","checkbox","gen"].includes(n.type)?null:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{w:"100%",id:"info",title:"Info Text",mb:4,helperText:"Enter the text that will show when the user clicks the info icon on this field.",info:"This is where you enter the text that will show when the user clicks the info icon on this field just like this.",type:f.Z.TYPES.text,value:null===c||void 0===c?void 0:c.info,onChange:e=>{e&&T({info:e})},errorMessage:u.info},"info"),(0,a.jsx)(f.Z,{w:"100%",id:"optional",title:"Make Optional",mb:4,helperText:"Enable this if you want this field to be optional.",type:f.Z.TYPES.checkbox,value:null===c||void 0===c?void 0:c.optional,onChange:e=>{T({optional:e})},errorMessage:u.optional},"optional")]})]}),(0,a.jsx)(r.xu,{mb:"1rem",children:(0,a.jsx)(b.Z,{status:"warning",mb:"1rem",onClick:()=>{y||(E(!1),l(c,null))},disabled:y,children:y?"Please wait...":s||"Submit Settings"})})]}):null]})},E=n(23596),T=n(10151),_=n(57369);const O=(e,t)=>{if(!t)return t;var n=t.substring("".concat(e," ").length);if(isNaN(Number(n)))return"".concat(n,", ").concat(e);switch(n.substring(n.length-1)){case"1":return"".concat(n,"st ").concat(e);case"2":return"".concat(n,"nd ").concat(e);case"3":return"".concat(n,"rd ").concat(e);default:return"".concat(n,"th ").concat(e)}};var F=e=>{let{created:t,showFieldsErrors:n,fields:x,images:v,masks:b,data:y,isFieldsEditMode:k,isDragable:j,onDragged:S,onFieldDataChange:C,onAllFieldsDataChange:F,fieldDataErrorMessage:N,onSetFieldDataErrorMessage:P,minSignatureWidth:A,maxSignatureWidth:M}=e;const[Z,D]=(0,i.useState)(Object.values(x)),[z,U]=(0,i.useState)(!1);(0,i.useEffect)((()=>{D(Object.values(x));const e={...y};for(const t of Object.values(x))"image_select"==t.type&&t.options&&!e[t.id]&&(e[t.id]=Object.keys(t.options)[0]);Object.keys(e).length>0&&JSON.stringify(e)!=JSON.stringify(y)&&F(e)}),[x,y]);const L=(e,t)=>(P({...N,[e]:null}),null);return Z&&0!=Z.length?(0,a.jsx)(r.xu,{as:c.Z5,onDragEnd:e=>{if(!e.destination||!S)return;const t=Array.from(Z),[n]=t.splice(e.source.index,1);t.splice(e.destination.index,0,n);const a=t.reduce(((e,t,n)=>(e[t.id]={...t,index:n},e)),{});console.info("parsedSvg:updatedFields",a),S(a)},p:"0px !important",children:(0,a.jsx)(c.bK,{droppableId:"fields",children:e=>(0,a.jsxs)(o.g,{w:"100%",ref:e.innerRef,...e.droppableProps,children:[Z.map(((e,i)=>(0,a.jsx)(c._l,{draggableId:e.id,index:i,isDragDisabled:!j,children:i=>{const o=(e=>{const i={key:e.id,id:e.id,disabled:t,title:"".concat(e.name||"").concat(e.optional?"(Optional)":""),helperText:e.helperText||"",info:e.info||"",placeholder:(0,w.VH)(e.placeholder||e.name||""),onChange:t=>{L(e.id),C(e.id,t)},errorMessage:n?N[e.id]:null,labelEndIcon:k?(0,a.jsx)(I,{fields:x,field:e,images:v,onSettingsUpdated:(t,n)=>{const a={...x,[e.id]:{...e,...t}},i=n?{...b||{},...n}:null;S&&S(a,i)}}):null,message:"Drag and Drop image here",hoverMessage:"Drop the image here",ruleMessage:e.ruleMessage||"Make sure you're uploading an image file.",useImageText:"Use Image"};switch(e.type){case"image_upload":case"faceshot":return(0,a.jsx)(d.Z,{galleryKey:"faceshot"==e.type?_.ht.faceshot:void 0,width:"100%",...i,disabled:!1,thumbnail:y[e.id]&&!(0,E.zI)(y[e.id])?(0,g.VT)("other_tools_data",y.id,e.id):y[e.id]&&(0,E.zI)(y[e.id])?y[e.id]:void 0,maxFileSize:1048576,removeBackground:"faceshot"==e.type,imageCropArg:"faceshot"==e.type?{message:"Make sure the image is cropped from the top of the head to above the chests with the shoulders visible as shown in the sample image.",sampleImage:"/res/sample-image-crop.png"}:void 0,onChange:(t,n)=>{n&&("faceshot"==e.type&&(0,_.OL)(n),L(e.id),C(e.id,n))}});case"sign":return(0,a.jsx)(h.Z,{width:"100%",...i,disabled:!1,minSignatureWidth:A||1,maxSignatureWidth:M||1,thumbnail:y[e.id]&&!(0,E.zI)(y[e.id])?(0,g.VT)("other_tools_data",y.id,e.id):y[e.id]&&(0,E.zI)(y[e.id])?y[e.id]:void 0});case"image_select":var o;const t=Object.values(e.options||{}).map((t=>({id:t.id,title:O(e.name,t.name),thumbnail:(0,E.gJ)(t.id,v,"_thumbnail"),image:{base:(0,E.gJ)(t.id,v,"_512"),md:(0,E.gJ)(t.id,v,"_728"),lg:(0,E.gJ)(t.id,v)}})))||[];return(0,a.jsx)(u.Z,{width:"100%",...i,thumbnail:(0,E.gJ)(y[e.id],v,"_thumbnail"),imageTitle:O(e.name,e.options?null===(o=e.options[y[e.id]])||void 0===o?void 0:o.name:""),onChange:t=>{const n=t;L(e.id,n.id),C(e.id,n.id)},options:t});case"text":case"textarea":return(0,a.jsx)(f.Z,{width:"100%",...i,value:y[e.id]||"",type:e.type});case"defgen":return(0,a.jsx)(f.Z,{width:"100%",...i,type:f.Z.TYPES.text,value:y[e.id]||""});case"gen":return k?(0,a.jsx)(f.Z,{width:"100%",...i,type:f.Z.TYPES.viewonly,placeholder:"",helperText:(0,w.VH)(e.placeholder||""),value:(0,T.l)(e.code,y,E.oh)}):null;case"checkbox":return(0,a.jsx)(f.Z,{...i,type:e.type,value:y[e.id]||!1});case"qrcode":return k?(0,a.jsxs)(r.xu,{w:"100%",h:"40px",border:"1px solid #dfdfdf",children:["QR CODE | ",i.title]}):null;default:return null}})(e);return o?(0,a.jsx)("div",{ref:i.innerRef,...i.draggableProps,...i.dragHandleProps,style:{...i.draggableProps.style,width:"100%"},children:(0,a.jsxs)(s.U,{w:"100%",justifyContent:"center",alignItems:e.helperText?"center":"flex-end",mb:4,children:[(0,a.jsx)(r.xu,{width:{base:"100%",md:j?"90%":"100%"},children:o}),(0,a.jsxs)(l.k,{display:{base:"none",md:j?"flex":"none"},w:"40px",h:"40px",border:"1px dashed",pos:"relative",justifyContent:"center",alignItems:"center",children:[(0,a.jsx)(r.xu,{as:p.ZTc,position:"absolute",mb:"25px",size:"10px"}),(0,a.jsx)(r.xu,{as:p.NWQ,position:"absolute",mt:"25px",size:"10px"})]})]})}):(0,a.jsx)("div",{ref:i.innerRef,...i.draggableProps,...i.dragHandleProps,style:{display:"none"}})}},e.id))),e.placeholder]})})}):(0,a.jsx)(m.Z,{message:"Loading template assets...",minH:"100px"})}},4623:function(e,t,n){n.d(t,{Z:function(){return ee},O:function(){return H}});var a=n(85893),i=n(56691),r=n(96918),o=n(34292),s=n(71293),l=n(98303),c=n(57747),d=n(48783),u=n(55154),h=n(67294),f=n(79230),p=n(85431),g=n(33871),m=n(23596),x=n(36238),v=n(88772),b=n(81136),w=n(6089),y=n(80203),k=n(94345),j=n(59501),S=n(85461);const C=(e,t,n)=>new Promise(((a,i)=>{const r=document.createElement("canvas"),o=r.getContext("2d");if(!o)return i(new Error("Canvas not supported"));const s=new Image;s.src=e,s.onload=()=>{r.width=s.width,r.height=s.height,o.drawImage(s,0,0);const e=o.getImageData(0,0,r.width,r.height);t(e,n),o.putImageData(e,0,0),a(r.toDataURL())},s.onerror=i})),I=["0.1","0.2","0.3","0.4","0.5","0.6","0.7"],E={Whitescale:{id:"Whitescale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=255,t[n+1]=255,t[n+2]=255}))},Blackscale:{id:"Blackscale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+1]=0,t[n+2]=0}))},Greyscale:{id:"Greyscale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4){const e=(t[n]+t[n+1]+t[n+2])/3;t[n]=e,t[n+1]=e,t[n+2]=e}}))},Redscale:{id:"Redscale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n+1]=0,t[n+2]=0}))},Greenscale:{id:"Greenscale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+2]=0}))},Bluescale:{id:"Bluescale",filter:e=>C(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+1]=0}))},Sepia:{id:"Sepia",filter:(e,t)=>C(e,(e=>{var n;const a=null!==(n=null===t||void 0===t?void 0:t.rMult)&&void 0!==n?n:.393;var i;const r=null!==(i=null===t||void 0===t?void 0:t.gMult)&&void 0!==i?i:.769;var o;const s=null!==(o=null===t||void 0===t?void 0:t.bMult)&&void 0!==o?o:.189;var l;const c=null!==(l=null===t||void 0===t?void 0:t.rAdd)&&void 0!==l?l:.349;var d;const u=null!==(d=null===t||void 0===t?void 0:t.gAdd)&&void 0!==d?d:.686;var h;const f=null!==(h=null===t||void 0===t?void 0:t.bAdd)&&void 0!==h?h:.272,p=e.data;for(let t=0;t<p.length;t+=4){const e=p[t],n=p[t+1],i=p[t+2],o=a*e+r*n+s*i,l=c*e+u*n+f*i,d=f*e+f*n+f*i;p[t]=o>255?255:o,p[t+1]=l>255?255:l,p[t+2]=d>255?255:d}}))},Guassianblur:{id:"Guassianblur",filter:(e,t)=>C(e,((e,t)=>{const n=Number(I[0]),a=Number(I[I.length-1]);var i=(null===t||void 0===t?void 0:t.radius)&&!isNaN(t.radius)?Number(t.radius):n;i>a&&(i=n),i*=10;const r=e.data,o=e.width,s=e.height,l=new Uint8ClampedArray(r);!function(){for(let e=0;e<s;e++)for(let t=0;t<o;t++){let n=0,a=0,s=0,c=0,d=0;for(let r=-i;r<=i;r++){const i=t+r;if(i>=0&&i<o){const t=4*(e*o+i);n+=l[t],a+=l[t+1],s+=l[t+2],c+=l[t+3],d++}}const u=4*(e*o+t);r[u]=n/d,r[u+1]=a/d,r[u+2]=s/d,r[u+3]=c/d}}(),function(){for(let e=0;e<o;e++)for(let t=0;t<s;t++){let n=0,a=0,c=0,d=0,u=0;for(let r=-i;r<=i;r++){const i=t+r;if(i>=0&&i<s){const t=4*(i*o+e);n+=l[t],a+=l[t+1],c+=l[t+2],d+=l[t+3],u++}}const h=4*(t*o+e);r[h]=n/u,r[h+1]=a/u,r[h+2]=c/u,r[h+3]=d/u}}()}),t),render:e=>{let{filterArgs:t,setFilterArgs:n}=e;return(0,a.jsx)(c.xu,{w:"100%",children:(0,a.jsx)(x.Z,{w:"100%",id:"filter_arg",title:"Blur radius",mb:4,helperText:"Select the blur radius.",info:"This is where you select the blur radius.",type:x.Z.TYPES.select,value:null===t||void 0===t?void 0:t.radius,options:I,onOptionValue:e=>I.includes(e)?e:I[0],onOptionName:e=>I.includes(e)?e:I[0],onChange:e=>{n({...t,radius:(isNaN(e),e)})}},"filter_arg")})}},ImageTransform:{id:"ImageTransform",filter:(e,t)=>(0,y.cr)(t,e,2),render:e=>{let{filterArgs:t,setFilterArgs:n,onShowSvgArgsInput:i}=e;return(0,a.jsx)(c.xu,{w:"100%",children:(0,a.jsx)(S.Z,{status:"warning",onClick:()=>{i&&i()},children:"Edit Rotation"})})},isAutomatic:!0}},T=e=>{let{filterElementId:t,id:n,value:i,onRender:r,onChange:o,onShowSvgArgsInput:s,...l}=e;var u;return(0,a.jsxs)(d.g,{w:"100%",justifyContent:"flex-start",alignItems:"flex-start",border:"1px",p:"0.5rem",borderRadius:"3px",...l,children:[(0,a.jsx)(v.X,{id:n,isChecked:i.selected,onChange:e=>{var t;o({...i,selected:null===(t=e.target)||void 0===t?void 0:t.checked})},children:n}),r?(0,a.jsx)(c.xu,{mb:2,w:"100%",children:r({filterArgs:null===(u=i.mask)||void 0===u?void 0:u.args,setFilterArgs:e=>{o({...i,mask:{...i.mask,args:{...i.mask.args||{},...e}}})},onShowSvgArgsInput:()=>{s&&s(t,i.mask)}})}):null]})},_=e=>{let{filterElementId:t,title:n,filters:i,isOpen:r,onComplete:s,onClose:l,onShowSvgArgsInput:c}=e;const[u,f]=(0,h.useState)();(0,h.useEffect)((()=>{u||f((e=>{const t={},n=Object.values(E);for(const a of n)t[a.id]={id:a.id,selected:null!=e[a.id]&&void 0!=e[a.id],mask:e[a.id]||{filter_id:a.id},render:a.render};return t})(i||{}))}),[i]),(0,h.useEffect)((()=>{}),[u]);return(0,a.jsxs)(k.Z,{title:n,isOpen:r,onClose:l,dontCloseOnOverlayClick:!0,w:"100%",h:"90vh",children:[(0,a.jsx)(d.g,{justifyContent:"flex-start",alignItems:"flex-start",w:"100%",height:"60vh",pos:"relative",overflowY:"auto",px:"0.5rem",children:u?Object.values(u).sort(((e,t)=>(e.id||"").localeCompare(t.id||""))).map(((e,n)=>(0,a.jsx)(T,{id:e.id,value:u[e.id],onRender:e.render,filterElementId:t,onShowSvgArgsInput:c,onChange:t=>{f({...u,[e.id]:t})},mb:4},n))):(0,a.jsx)(o.U,{w:"100%",justifyContent:"center",children:(0,a.jsx)(b.$,{size:"xl"})})}),(0,a.jsx)(j.Z,{onClick:()=>{if(u){const e={},t=Object.values(E).filter((e=>e.isAutomatic));for(const a of t)i[a.id]&&(e[a.id]=i[a.id]);const n=Object.values(u).filter((e=>e.selected));for(const a of n)e[a.id]=a.mask;s(e),l()}else l()},children:"Submit Filters"})]})},O=e=>{let{id:t,image:n,onClick:i,...r}=e;return(0,a.jsxs)(o.U,{w:"100%",justifyContent:"flex-start",alignItems:"flex-end",border:"1px",p:"0.5rem",borderRadius:"3px",...r,onClick:i,cursor:"pointer",children:[(0,a.jsx)(w.E,{src:n||"",w:"60px",h:"60px"}),(0,a.jsx)(s.x,{as:"div",children:t})]})},F=e=>{let{images:t,onSelected:n,onClose:i}=e;return(0,a.jsx)(k.Z,{title:"Select Image",isOpen:!0,onClose:i,dontCloseOnOverlayClick:!0,w:"100%",h:"90vh",children:(0,a.jsx)(d.g,{justifyContent:"flex-start",alignItems:"flex-start",w:"100%",height:"60vh",pos:"relative",overflowY:"auto",px:"0.5rem",children:0==t.length?(0,a.jsx)(o.U,{w:"100%",justifyContent:"center",children:(0,a.jsx)(b.$,{size:"xl"})}):t.map((e=>(0,a.jsx)(O,{id:e.id,image:e.image,onClick:()=>{n(e)},mb:4},e.id)))})})};var N=E,P=n(53754),A=n(10151),M=n(41160),Z=n(93239),D=n(83612),z=n(34365),U=n(38451);const L=e=>{let{children:t}=e;return(0,a.jsxs)(o.U,{justifyContent:"flex-start",alignItems:"center",m:"0px !important",mb:"1rem !important",children:[(0,a.jsx)(u.gJy,{color:"#e53e3e"}),"\xa0",(0,a.jsx)(s.x,{as:"div",color:"#e53e3e",children:t})]})},R=e=>{const[t,n]=e.split(".");return"".concat(t,".").concat((n||"").split("_")[0].trim()).trim()},W=async(e,t,n)=>{const a=!t[0]||n&&n.includes(t[0].filter_id)?e:await N[t[0].filter_id].filter(e,t[0].args);return t.shift(),0==t.length?a:W(a,t,n)},Y=(e,t,n)=>new Promise((async(a,i)=>{try{a(await W(e,t,n))}catch(r){i(r)}}));function B(e,t,n,a,i){const r=t+a/2,o=n+i/2;return"rotate(".concat(e," ").concat(r," ").concat(o,")")}const J=(e,t,n,a,i)=>{if(e.attributes.width&&(e.attributes.width="".concat((0,z.Qj)(Number(e.attributes.width),t,a,3))),e.attributes.height&&(e.attributes.height="".concat((0,z.Yg)(Number(e.attributes.height),n,i,3))),e.attributes.x&&(e.attributes.x="".concat((0,z.Qj)(Number(e.attributes.x),t,a,3))),e.attributes.y&&(e.attributes.y="".concat((0,z.Yg)(Number(e.attributes.y),n,i,3))),e.attributes.transform&&(e.attributes.transform=(0,U.IP)(e.attributes.transform,(e=>(0,z.Qj)(e,t,a,3)),(e=>(0,z.Yg)(e,n,i,3)))),"path"==e.name&&e.attributes.d&&(e.attributes.d=(0,U.sS)(e.attributes.d,(e=>(0,z.Qj)(e,t,a,3)),(e=>(0,z.Yg)(e,n,i,3)))),e.attributes.dy&&(e.attributes.dy="".concat((0,z.Yg)(Number(e.attributes.dy),n,i,3))),e.children.length>0)for(var r=0;r<e.children.length;r++)J(e.children[r],t,n,a,i)},H=(e,t,n)=>{var a=0;const i=t?t.split("\n"):[],r=i.length,o=[];for(var s=0;s<e.children.length;s++)if(e.children[s].value.length>0&&(a++,o.push(e.children[s].value),i.length>0?(e.children[s].value=i[0],i.shift()):r>0&&(e.children[s].value="")),e.children[s].children.length>0)for(var l=0;l<e.children[s].children.length;l++)e.children[s].children[l].value.length>0&&(a++,o.push(e.children[s].children[l].value),i.length>0?(e.children[s].children[l].value=i[0],i.shift()):r>0&&(e.children[s].children[l].value=""));return{maxLines:a,defaultInputLines:o}},X=(e,t,n,a,i,r,o,s,l,c)=>{"image"!=e.children[n].name||(null===a||void 0===a?void 0:a.type)||(e.children[n].attributes["xlink:href"]=(0,m.gJ)(t,i,l?"_".concat(l):null));if("defs"!=e.children[n].name&&(e.children[n].attributes["data-svg-id"]=e.children[n].attributes.id),"image_select"==(null===a||void 0===a?void 0:a.type)){if(r[a.id]){const t=r[a.id];e.children[n].attributes["xlink:href"]=(0,m.gJ)(t,i,l?"_".concat(l):null)}}else if(["image_upload","sign","faceshot"].includes(null===a||void 0===a?void 0:a.type))i[t]&&(e.children[n].attributes["xlink:href"]=i[t],"sign"==(null===a||void 0===a?void 0:a.type)||null===a||void 0===a||a.type);else if("checkbox"==(null===a||void 0===a?void 0:a.type))i[t]&&r[a.id]&&"image"==e.children[n].name&&(e.children[n].attributes["xlink:href"]=(0,m.gJ)(t,i,l?"_".concat(l):null));else if("qrcode"==(null===a||void 0===a?void 0:a.type))i[t]&&"image"==e.children[n].name&&(e.children[n].attributes["xlink:href"]=(0,m.gJ)(t,i,l?"_".concat(l):null));else if(["text","defgen"].includes(null===a||void 0===a?void 0:a.type)){for(var d=e.children[n].children[0];d.children&&d.children.length>0;)d,d=d.children[0];r[a.id]&&(d.value=r[a.id])}else if(["textarea"].includes(null===a||void 0===a?void 0:a.type))H(e.children[n],r[a.id],a.id);else if(["gen"].includes(null===a||void 0===a?void 0:a.type)){for(d=e.children[n].children[0];d.children&&d.children.length>0;)d,d=d.children[0];d.value=(0,A.l)(a.code,r,m.oh)}},Q={"letter-spacing":e=>{const{value:t,unit:n}=(0,D.Zl)(e);let a;return a="psd"==n?"".concat(parseFloat(t)/1e3,"em"):e,a}},V=e=>{const t={...e};for(const[a,i]of Object.entries(e)){const e=[...i.declarations];for(var n=0;n<e.length;n++){const t=Q[i.declarations[n].property];t&&(e[n]={...e[n],value:t(i.declarations[n].value)})}t[a].declarations=e}return t};function q(e,t,n){const a=Number(e.x),i=a+Number(e.width),r=Number(e.y),o=r+Number(e.height);var s=Number(t.x),l=s+Number(t.width),c=Number(t.y),d=c+Number(t.height);return s+5*s/100>=a&&l-5*l/100<=i&&c+5*c/100>=r&&d-5*d/100<=o?t.id:null}const G=(e,t,n)=>{const a=[e.attributes.id];for(var i=n.length-1;i>=0;i--)if(t!=i&&"image"==n[i].name&&n[i].attributes){const t=q(e.attributes,n[i].attributes,"".concat(e.attributes.id,":").concat(n[i].attributes.id));t&&a.push(t)}return a},$=(e,t,n,a,i,r)=>new Promise((async(o,s)=>{(0,f.parse)(t.svg).then((async l=>{const c=Object.keys(t.fields),d=Number("".concat(l.attributes.width||0)),u=Number("".concat(l.attributes.height||0)),h=i&&"max"!=i?i:d,x=h/d*u;let v=await((e,t,n,a)=>new Promise((async(i,r)=>{try{const r=Object.entries(e).map((async i=>{let[r,o]=i;var s,l,c=R(r);let d;var u;if(["image_upload","faceshot","sign"].includes(null===(s=n.fields[c])||void 0===s?void 0:s.type))d=t[c]&&(0,m.zI)(t[c])?t[c]:(0,P.VT)("other_tools_data",t.id,c),null===(u=n.fields[c])||void 0===u||u.type;else if(r.endsWith("_thumbnail"))d=null;else{const t=(0,m.gJ)(r,e,a?"_".concat(a):null);t&&(d=await(0,p.tY)(t))}const h="image_select"==(null===(l=n.fields[c])||void 0===l?void 0:l.type)?c:r;var f,g;return c.startsWith("Logo.upload"),d&&!(0,P.N4)(d)&&(0,m.zI)(d)&&n.masks&&n.masks[h]&&(d="sign"==(null===(f=n.fields[c])||void 0===f?void 0:f.type)||"image_upload"==(null===(g=n.fields[c])||void 0===g?void 0:g.type)?await Y(d,Object.values(n.masks[h]),["ImageTransform"]):await Y(d,Object.values(n.masks[h]))),[r,d]})),o=await Promise.all(r);i(Object.fromEntries(o))}catch(o){r(o)}})))(t.images,e,t,h),b=0,w=0,y=0,k=0;var j=-1;l.attributes.width="".concat(h),l.attributes.height="".concat(x),l.attributes.viewBox&&(l.attributes.viewBox=(0,U.C)(l.attributes.viewBox,(e=>(0,z.Qj)(e,h,d,3)),(e=>(0,z.Yg)(e,x,u,3))));for(var S=l.children.length-1;S>=0;S--){const n=l.children[S];J(n,h,x,d,u);const{name:a,type:i,selectIndex:o,typeAndSelectIndex:s}=(0,g.py)(n.attributes.id),f="".concat(a,".").concat(i);if("defs"==n.name)j=S;else if(c.includes(f)||"image"==n.name){var C=R(n.attributes.id);const a="image_select"==i?C:n.attributes.id;X(l,n.attributes.id,S,t.fields[f],v,e,0,0,h,(r||{})[a]||((null===t||void 0===t?void 0:t.masks)||{})[a]),((r||{})[a]||{}).ImageTransform&&(b=parseFloat(n.attributes.width),w=parseFloat(n.attributes.height),y=parseFloat(n.attributes.x),k=parseFloat(n.attributes.y))}}var I=[];for(S=l.children.length-1;S>=0;S--){const e=l.children[S];if("image"==e.name){const t=G(e,S,l.children).filter((e=>!I.includes(e)));I=I.concat(t),l.children[S].attributes["data-click-element-id"]=0==t.length?l.children[S].attributes.id:t.join()}}if(j>-1){const e=l.children[j];e.children&&e.children.forEach((e=>{if("style"===e.name&&e.children&&e.children.length>0){const n=e.children[0].value,a=(0,D.sn)(n,((e,n)=>{const a=(e=>{if(!e)return null;const t={...e};return t.if_selector&&(t.if_selector=V(t.if_selector)),t.if_property&&(t.if_property=V(t.if_property)),t.if_property_and_value&&(t.if_property_and_value=V(t.if_property_and_value)),t})(t.cssActions),i=(null===a||void 0===a?void 0:a.if_selector)||{},r=(null===a||void 0===a?void 0:a.if_property)||{},o=(null===a||void 0===a?void 0:a.if_property_and_value)||{};var s=[...n];const l=i["*"],c=i[(0,D.xC)(e)];l&&(s=l.shouldReplace?l.declarations:[...s,...l.declarations]),c&&(s=c.shouldReplace?c.declarations:[...s,...c.declarations]);for(var f=0;f<n.length;f++){const e=n[f],t=r["*"],a=r[(0,D.xC)(e.property)],i=o["*"],l=o[(0,D.xC)(e.property,e.value)];t&&(s=t.shouldReplace?t.declarations:[...s,...t.declarations]),a&&(s=a.shouldReplace?a.declarations:[...s,...a.declarations]),i&&(s=i.shouldReplace?i.declarations:[...s,...i.declarations]),l&&(s=l.shouldReplace?l.declarations:[...s,...l.declarations]),"font-size"===e.property&&s.push({property:"font-size",value:(0,U.MB)(e.value,d,u,h,x)})}return s}));e.children[0].value=a}}));const a=[];if(a.push({name:"style",type:"element",value:"",attributes:{},children:[{name:"",type:"text",value:"#softbaker-slider-handle, #softbaker-button-background, #softbaker-button-text, #softbaker-cancel-background, #softbaker-cancel-text, #softbaker-slider-track { cursor: pointer !important;}",attributes:{},children:[]}]}),l.children[j].children=a.concat(l.children[j].children),n){const e=[];for(const t of Object.values(n))t.dataUrl&&t.ext&&e.push({name:"style",type:"element",value:"",attributes:{},children:[{name:"",type:"text",value:'\n      @font-face {\n        font-family: "'.concat(t.name,'";\n        src: url(').concat(t.dataUrl,") format(").concat((0,Z.bX)(t.ext),");\n      }"),attributes:{},children:[]}]});e.length>0&&(l.children[j].children=e.concat(l.children[j].children))}}if(r){var E;const e=Object.keys(r)[0],t=((r||{})[e]||{}).ImageTransform,n="#dd6b20",a={name:"rect",type:"element",value:"",attributes:{id:"softbaker-slider-track",x:y+"",y:k+w+10+"",width:b+"",height:"10",fill:"#2a2a2a"},children:[]},i={name:"circle",type:"element",value:"",attributes:{id:"softbaker-slider-handle",cx:y+((null===t||void 0===t||null===(E=t.args)||void 0===E?void 0:E.rotationAngle)||0)*parseFloat(a.attributes.width)/360+"",cy:parseFloat(a.attributes.y)+parseFloat(a.attributes.height)/2+"",r:parseFloat(a.attributes.height)+"",fill:n},children:[]},o={name:"rect",type:"element",value:"",attributes:{id:"softbaker-button-background",x:y+"",y:parseFloat(a.attributes.y)+parseFloat(a.attributes.height)+10+"",width:"40",height:"20",rx:"10",ry:"10",fill:n},children:[]},s={name:"text",type:"element",value:"",attributes:{id:"softbaker-button-text",x:y+parseFloat(o.attributes.width)/2+"",y:parseFloat(o.attributes.y)+parseFloat(o.attributes.height)/2+5+"","font-size":"14","text-anchor":"middle",fill:"#FFFFFF"},children:[{name:"",type:"text",value:"\u2714",parent:null,attributes:{},children:[]}]},c=50,d={name:"rect",type:"element",value:"",attributes:{id:"softbaker-cancel-background",x:y+c+"",y:parseFloat(a.attributes.y)+parseFloat(a.attributes.height)+10+"",width:"40",height:"20",rx:"10",ry:"10",stroke:n},children:[]},u={name:"text",type:"element",value:"",attributes:{id:"softbaker-cancel-text",x:y+c+parseFloat(o.attributes.width)/2+"",y:parseFloat(o.attributes.y)+parseFloat(o.attributes.height)/2+5+"","font-size":"14","text-anchor":"middle",fill:"#FFFFFF"},children:[{name:"",type:"text",value:"\u274c",parent:null,attributes:{},children:[]}]};l.children=l.children.concat([a,i,o,s,d,u])}a?(0,p.wL)("/res/watermark.png",d,u,.4).then((e=>{l.children.push({name:"image",type:"element",value:"",attributes:{id:"watermark-"+(0,m.Bu)(8),width:d+"",height:u+"","xlink:href":e},children:[]}),o((0,f.stringify)(l))})).catch((e=>{s(e)})):o((0,f.stringify)(l))})).catch((e=>{s(e)}))})),K=e=>{let{fonts:t,isLoading:n,data:s,templateData:u,showWatermark:f,width:p,onFiltersUpdated:g,filterEnabled:m}=e;const x=(0,h.useRef)(null),v=(0,l.S)(p||{base:0}),[b,w]=(0,h.useState)(),[y,k]=(0,h.useState)(),[j,S]=(0,h.useState)(),[C,I]=(0,h.useState)(null);(0,h.useEffect)((()=>{}),[b]),(0,h.useEffect)((()=>{s&&u?(k(!0),S(void 0),$(s,u,t,f,v,C).then((e=>{k(!1),w(e)})).catch((e=>{k(!1),S(e.message)}))):u||(k(!0),w(""))}),[s,u,f,v,C,t]);const[E,T]=(0,h.useState)(),[O,N]=(0,h.useState)(),[P,A]=(0,h.useState)(),[Z,D]=(0,h.useState)(),[z,U]=(0,h.useState)(),R=e=>{T(null),A(null),D(null),N(null)},W=e=>{const t=e.target;if(t)if(t.hasAttribute("data-click-element-id")&&!C){((e,t)=>{if(m)if(e.includes(",")){const a=e.split(","),i=[];for(var n=0;n<a.length;n++){const e=a[n];if(0==n)i.push({id:e,image:t});else{const t=document.getElementById(e);if(t){const n=t.getAttribute("xlink:href");i.push({id:e,image:n})}}}U(i)}else T(e),N(t),e&&(null===u||void 0===u?void 0:u.masks)&&(null===u||void 0===u?void 0:u.masks[e])&&D(u.masks[e].args)})(t.getAttribute("data-click-element-id"),t.getAttribute("xlink:href"))}else if(["softbaker-button-background","softbaker-button-text"].includes(t.getAttribute("id"))){if(g&&C){const e=document.querySelector("[data-svg-id='".concat(Object.keys(C)[0],"']"));if(!e)return;const t=e.getAttribute("data-degree");if(void 0!=t){var n,a;const e=Number(t),i=((null===u||void 0===u?void 0:u.masks)||{})[Object.keys(C)[0]]||{},r={...i,ImageTransform:{filter_id:(null===i||void 0===i||null===(n=i.ImageTransform)||void 0===n?void 0:n.filter_id)||"",args:{...(null===i||void 0===i||null===(a=i.ImageTransform)||void 0===a?void 0:a.args)||{},rotationAngle:e}}};g({...(null===u||void 0===u?void 0:u.masks)||{},[Object.keys(C)[0]]:r})}I(null)}}else["softbaker-cancel-background","softbaker-cancel-text"].includes(t.getAttribute("id"))&&I(null)},Y=e=>{const t=e.target;"softbaker-slider-handle"===t.getAttribute("id")&&t.setAttribute("data-rotating","1")},J=()=>{const e=document.getElementById("softbaker-slider-handle");e&&e.setAttribute("data-rotating","0")},H=e=>{const t=document.getElementById("softbaker-slider-track");if(t&&C&&"softbaker-slider-handle"===e.target.getAttribute("id")){if(!("1"===e.target.getAttribute("data-rotating")))return;const n=t.getBoundingClientRect(),a=t.getBBox(),i=Math.min(Math.max(e.clientX-n.left,0),n.width);e.target.setAttribute("cx","".concat(a.x+i));const r=i/n.width*360;if(Object.keys(C)[0]){const e=document.querySelector("[data-svg-id='".concat(Object.keys(C)[0],"']"));if(!e)return;const t=B(r,parseFloat(e.getAttribute("x")||0),parseFloat(e.getAttribute("y")||0),parseFloat(e.getAttribute("width")||0),parseFloat(e.getAttribute("height")||0));e.setAttribute("transform",t),e.setAttribute("data-degree","".concat(r))}}};return(0,h.useEffect)((()=>{const e=x.current;return e&&(e.addEventListener("click",W),e.addEventListener("mousedown",Y),e.addEventListener("mouseup",J),e.addEventListener("mousemove",H)),()=>{e&&(e.removeEventListener("click",W),e.removeEventListener("mousedown",Y),e.removeEventListener("mouseup",J),e.removeEventListener("mousemove",H))}}),[b,u,s,C,m]),(0,a.jsx)(M.Z,{disableDrag:null!=C,width:"100%",message:"Drag around to view the whole tool",height:{base:500,md:728,lg:1024},children:(0,a.jsxs)(c.xu,{id:"AirlineDocWrapper",pos:"relative",w:"100%",children:[b?(0,a.jsx)(c.xu,{ref:x,w:"100%",h:"100%",dangerouslySetInnerHTML:{__html:b}}):null,C?null:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.U,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"1",bg:"#dfdfdf",opacity:"0.7",justifyContent:"flex-start",pl:{base:"0px",md:"0px"},alignItems:"center",display:y||n?"flex":"none",w:"100%",h:"100%",children:(0,a.jsx)(i.Z,{type:i.Z.TYPES.grid,color:(0,r.Z)("colorAccent.light","colorAccent.dark"),size:"70px"})}),(0,a.jsx)(d.g,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"1",bg:"#fff",opacity:"0.7",justifyContent:"center",pl:"1rem",alignItems:"flex-start",display:j?"flex":"none",w:"100%",h:"100%",children:j?(0,a.jsx)(L,{children:(X=j,(null===X||void 0===X?void 0:X.message)?X.message:X)}):null})]}),z?(0,a.jsx)(F,{images:z,onClose:()=>{U(void 0)},onSelected:e=>{T(e.id),N(e.image),e.id&&(null===u||void 0===u?void 0:u.masks)&&(null===u||void 0===u||u.masks[e.id]),U(void 0)}}):E&&g?(0,a.jsx)(_,{filterElementId:E,title:"".concat(E||""," filter"),filters:((null===u||void 0===u?void 0:u.masks)||{})[E]||{},isOpen:!0,onClose:()=>{R()},onComplete:e=>{g({...(null===u||void 0===u?void 0:u.masks)||{},[E]:e})},onShowSvgArgsInput:(e,t)=>{I({[e]:{[t.filter_id]:t}}),R()}}):null]})});var X};K.getSvg=$;var ee=K},38451:function(e,t,n){function a(e,t,n){return e.replace(/(translate|rotate|scale|matrix|skewX|skewY)\(([^)]+)\)/g,((e,a,i)=>{let r=i.split(/[ ,]+/).map(Number);if("translate"===a)r[0]=t(r[0]),r[1]=n(r[1]);else if("scale"===a)r[0]=r[0],r.length>1?r[1]=r[1]:r[1]=r[0];else if("matrix"===a)r[4]=t(r[4]),r[5]=n(r[5]);else{if("rotate"===a)return"".concat(a,"(").concat(i,")");if("skewX"===a)return"".concat(a,"(").concat(t(Number(i.trim())),")");if("skewY"===a)return"".concat(a,"(").concat(n(Number(i.trim())),")")}return"".concat(a,"(").concat(r.join(" "),")")}))}function i(e,t,n){return e.replace(/([MLHVCSQTZ])([^MLHVCSQTZ]*)/gi,((e,a,i)=>{let r=i.trim().split(/([, ])/).map((e=>e.trim()));for(let o=0;o<r.length;o++)isNaN(parseFloat(r[o]))||("H"===a.toUpperCase()?r[o]=t(parseFloat(r[o])):"V"===a.toUpperCase()?r[o]=n(parseFloat(r[o])):r[o]=o%2===0?t(parseFloat(r[o])):n(parseFloat(r[o])));return"".concat(a).concat(r.join(""))}))}function r(e,t,n){let a=e.trim().split(" ").map((e=>parseFloat(e)));if(4!==a.length)throw new Error("Invalid viewBox format. Expected format: 'min-x min-y width height'");return a[0]=t(a[0]),a[1]=n(a[1]),a[2]=t(a[2]),a[3]=n(a[3]),a.join(" ")}function o(e,t,n,a,i){const r=a/t,o=i/n,s=Math.min(r,o),l=e.match(/^(\d+(\.\d+)?)([a-z%]*)$/i);if(!l)throw new Error("Invalid font size format");const c=parseFloat(l[1]),d=l[3]||"";return"".concat(c*s).concat(d)}n.d(t,{C:function(){return r},IP:function(){return a},MB:function(){return o},sS:function(){return i}})},83612:function(e,t,n){n.d(t,{Zl:function(){return i},sn:function(){return r},xC:function(){return a}});const a=(e,t)=>"".concat(e.replace(/\s/g,"")).concat(t?":".concat(t.replace(/\s/g,"")):"");function i(e){const t=e.match(/^([-+]?\d*\.?\d+)([a-zA-Z]+)$/);if(t)return{value:t[1],unit:t[2]};throw new Error("Invalid input format: ".concat(e))}function r(e,t){const n={},a=/([^{]+)\{([^}]+)\}/g;let i;for(;null!==(i=a.exec(e));){const e=i[1].trim(),t=i[2].trim().split(";").filter(Boolean).map((e=>{const[t,n]=e.split(":").map((e=>e.trim()));return{property:t,value:n}}));n[e]=t}Object.keys(n).forEach((e=>{const a=n[e],i=t(e,a);n[e]=i}));let r="";return Object.keys(n).forEach((e=>{const t=n[e].map((e=>{let{property:t,value:n}=e;return"".concat(t,": ").concat(n,";")})).join(" ");r+="".concat(e," { ").concat(t," }\n")})),r}},74054:function(e,t,n){var a=n(67294),i=n(10151),r=n(23596);t.Z=(e,t,n,o)=>{const[s,l]=(0,a.useState)(),[c,d]=(0,a.useState)();(0,a.useEffect)((()=>{const a=n?JSON.stringify(n):void 0;if(e&&t&&n&&s!=a){a&&l(a),o&&d(o);const s={};for(const t of Object.values(n))"checkbox"==t.type?s[t.id]=!0:"defgen"==t.type&&t.code?e&&(s[t.id]=(0,i.l)(t.code,e,r.oh)):!["image_upload","faceshot","sign"].includes(t.type)&&t.placeholder&&"string"===typeof t.placeholder&&t.placeholder.length>0&&(s[t.id]=t.placeholder);Object.keys(s).length>0&&t&&t({...s,is_freemium:!0,template_id:o||""})}else c!=o&&t&&(o&&d(o),t({...e||{},is_freemium:!0,template_id:o||""}))}),[n,e,t,o])}},83613:function(e,t,n){var a=n(67294),i=n(93239),r=n(25723),o=n(39461),s=n(53754),l=n(23596);t.Z=e=>{const[t,n]=(0,a.useState)(),[c,d]=(0,a.useState)(),[u,h]=(0,a.useState)(),{user:f}=(0,o.P)(),[p,g]=(0,a.useState)(!0);(0,a.useEffect)((()=>{}),[c]);return(0,a.useEffect)((()=>{e&&(0,i.fY)(e).then((async e=>{h(e)})).catch((e=>{n(e.message)}))}),[e]),(0,a.useEffect)((()=>{u&&(0,i.Xx)(u,["ttf","otf","woff","woff2","eot","svg"]).then((e=>{d({...c,...e}),g(!1)})).catch((e=>{n(e.message),g(!1)}))}),[u]),{loadingFonts:p,error:t,fonts:c,setFonts:d,uploadFonts:e=>new Promise((async(t,n)=>{if(c){e&&e("Preparing fonts for upload...");const a=[];for(const e of Object.values(c))!e.url&&e.file&&a.push({id:e.id,file:e.file,fileName:"".concat((0,l.vq)(e.id),".").concat(e.ext),dir:"fonts"});if(a.length>0){if(!f)return e&&e("Sign In Requred..."),n(new Error("Please sign in"));e&&e("Uploading fonts..."),(0,r.dq)(f,a,"https://r2.softbaker.com/").then((i=>{const r={...c},o={};i.forEach((e=>{if((0,s.N4)(e.error))r[e.id].url=e.url;else{const t=new Error(e.error);r[e.id].readError=t.message,o[e.id]=t.message}})),Object.keys(o).length==a.length?(e&&e('Fonts upload failed with the error, "'.concat(JSON.stringify(o),'"...')),n(new Error("The font(s) failed to upload: ".concat(JSON.stringify(o))))):Object.keys(o).length>0?(d(r),e&&e('Fonts upload failed with the error, "'.concat(JSON.stringify(o),'"...')),n(new Error("Some or all fonts failed to upload: ".concat(JSON.stringify(o))))):(d(r),e&&e("Fonts uploaded..."),t(c))})).catch((t=>{e&&e('Fonts upload failed with the error, "'.concat(t.message,'"...')),n(t)}))}else e&&e("No font to Prepare for upload..."),t({})}else e&&e("No fonts to upload..."),t(null)}))}}},93239:function(e,t,n){n.d(t,{Xx:function(){return d},YW:function(){return h},bX:function(){return u},fY:function(){return s}});var a=n(79230),i=n(23596);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;return e.attributes&&e.attributes["font-family"]&&t.add(e.attributes["font-family"]),"defs"===e.name&&e.children&&e.children.forEach((e=>{if("style"===e.name&&e.children&&e.children.length>0){o(e.children[0].value,t)}})),e.children&&e.children.length>0&&e.children.forEach((e=>r(e,t))),t}function o(e,t){const n=/font-family:\s*([^;]+);/g;let a;for(;null!==(a=n.exec(e));)t.add(a[1].trim())}function s(e){return(0,a.parse)(e).then((e=>{const t=r(e);return Array.from(t)}))}async function l(e){try{const t=await fetch(e);if(!t.ok)throw new Error("HTTP status ".concat(t.status));const n=await t.blob();return new Promise(((e,t)=>{const a=new FileReader;a.onloadend=()=>e(a.result),a.onerror=t,a.readAsDataURL(n)}))}catch(t){throw new Error("Failed to fetch font data from ".concat(e,": ").concat(t.message))}}function c(e){let t=e.toLowerCase();return t=t.replace(/["']/g,""),t=t.replace(/[\s]+/g,"-"),t=t.replace(/[^a-z0-9-]+/g,""),t=t.replace(/-+/g,"-"),t=t.replace(/^-|-$/g,""),t}function d(e,t){return new Promise((async(n,a)=>{const r={};for(const s of e){const e={name:s.replace(/["']/g,""),id:c(s)};let n=!1;for(const a of t){const t="https://r2.softbaker.com/fonts/".concat((0,i.vq)(e.id),".").concat(a,"?v=1");try{const i=await l(t);e.url=t,e.dataUrl=i,e.ext=a,n=!0;break}catch(o){e.readError=o.message}}n||(e.readError="No valid font found for ".concat(s," with extensions: ").concat(t.join(", "))),r[e.id]=e}n(r)}))}function u(e){return{ttf:"truetype",otf:"opentype",woff:"woff",woff2:"woff2",eot:"embedded-opentype",svg:"svg"}[e.toLowerCase()]||"unknown"}function h(e,t){return{ttf:"font/ttf",otf:"font/otf",woff:"font/woff",woff2:"font/woff2",eot:"font/eot",svg:"svg"}[t.toLowerCase()]?new Promise(((t,n)=>{new FontFace("CustomFont","url(".concat(e,")")).load().then((e=>{document.fonts.add(e);const n=document.createElement("canvas");n.width=100,n.height=100;const a=n.getContext("2d");if(!a)return;a.clearRect(0,0,n.width,n.height),a.fillStyle="#FFFFFF",a.fillRect(0,0,n.width,n.height),a.fillStyle="#000000",a.font="50px CustomFont",a.textAlign="center",a.textBaseline="middle",a.fillText("Aa",n.width/2,n.height/2);const i=n.toDataURL("image/png");t(i)})).catch((e=>{n(e)}))})):Promise.reject(new Error("Unsupported font format"))}},3683:function(e,t,n){var a=n(67294),i=n(87066),r=n(23596),o=n(33871),s=n(53754),l=n(39461);t.Z=(e,t)=>{const{user:n}=(0,l.P)(),[c,d]=(0,a.useState)(),[u,h]=(0,a.useState)(),[f,p]=(0,a.useState)({}),[g,m]=(0,a.useState)(!1),[x,v]=(0,a.useState)(!1),[b,w]=(0,a.useState)(!1),[y,k]=(0,a.useState)(),[j,S]=(0,a.useState)(),[C,I]=(0,a.useState)(),[E,T]=(0,a.useState)(),[_,O]=(0,a.useState)(),[F,N]=(0,a.useState)(),[P,A]=(0,a.useState)();(0,a.useEffect)((()=>{}),[F]);const M=e=>{if(!e)return null;var t=e.split("-")[1];return t?t.split(".")[0].trim():null},Z=e=>{if(1==Object.keys(e).length)return Object.keys(e)[0];for(const t of Object.values(e))if(t.is_default)return t.id;return Object.keys(e)[0]};(0,a.useEffect)((()=>{const t=M(e);e&&e!=c&&t?(d(e),m(!0),k(null),h(null),p({}),I(null),T(null),O(null),N(null),i.Z.get(e).then((e=>{h(t),p((0,r.Dn)(e.data)),m(!1)})).catch((e=>{k(e.message),m(!1)}))):e||(d(null),m(!1),k(null),h(null),p({}),I(null),T(null),O(null),N(null))}),[e]),(0,a.useEffect)((()=>{!t&&f&&Object.keys(f).length>0&&!C&&z(Z(f))}),[f]);const D=(e,t)=>{i.Z.get(e.data_url).then((t=>{O({...e}),N({...t.data}),I({...e}),T({...t.data}),v(!1)})).catch((n=>{!t||(t||0)<3?D(e,(t||0)+1):(S(n.message),v(!1))}))},z=(e,t)=>{t&&t&&A(e);const n=f[e];n&&!(0,s.N4)(n.data_url)&&(v(!0),S(null),D(n))},U=(e,t)=>{O(e),N(t)};return{templatesLoading:g,templatesError:y,selectedTemplateLoading:x,selectedTemplateError:j,parsingTemplate:b,templates:f,selectedTemplate:C,selectedTemplateData:E,workingTemplate:_,workingTemplateData:F,setAsDefaulTemplate:e=>{if(_&&(O({..._,is_default:e}),e&&Object.keys(f).length>1)){for(const e of Object.keys(f))e!=_.id&&(f[e].is_default=!1);p(f)}},setWorkingTemplate:O,setWorkingTemplateData:N,selectTemplate:z,parseTemplateSvg:(e,t)=>(w(!0),new Promise(((n,a)=>{(0,o.xz)(e).then((e=>{if(console.log("parsedSvg2:result.ok!!!: ",e),e){var i=C,o=E;t&&(i=null,o=null),(0,r.s7)(e,o).then((e=>{const t={id:(null===i||void 0===i?void 0:i.id)||(0,r.Bu)(8),name:(null===i||void 0===i?void 0:i.name)||"",logo:(null===i||void 0===i?void 0:i.logo)||"",data_url:(null===i||void 0===i?void 0:i.data_url)||"",is_default:(null===i||void 0===i?void 0:i.is_default)||!1,split_on_download:(null===i||void 0===i?void 0:i.split_on_download)||!1};O(t),N(e),w(!1),n({template:t,templateData:e})})).catch((e=>{w(!1),a(e)}))}else w(!1),n(null)})).catch((e=>{w(!1),a(e)}))}))),saveTemplate:e=>new Promise(((t,a)=>n?_&&F?void(0,r.t9)(n,u||(0,r.Bu)(8),f,_,F,C,E,c,U,e).then((e=>{if(e){d(e);const t=M(e);h(t),p({...f,[_.id]:_}),I(_),T(F),O(_),N(F)}t(e)})).catch(a):a(new Error("No template provided yet.")):a(new Error("Please sign in")))),deleteTemplate:e=>{Object.keys(f).includes(e)||(null===_||void 0===_?void 0:_.id)!=e||z(Z(f))},getDefaultTemplateId:Z,currentTemplateId:P}}},85431:function(e,t,n){n.d(t,{_P:function(){return s},pu:function(){return r},sH:function(){return l},tY:function(){return i},wL:function(){return c},zD:function(){return o}});var a=n(23596);const i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((async(n,i)=>{if(!(0,a.Ri)(e))return n(e);try{const t=await fetch(e),a=await t.blob(),r=new FileReader;r.onloadend=()=>{n(r.result)},r.onerror=i,r.readAsDataURL(a)}catch(r){if(console.info("parsedSvg:masks.fe",r.message),t)return n(null);i(r)}}))};function r(e,t){return console.info("parsedSvg:base64A: ",e.substring(0,32)),console.info("parsedSvg:base64B: ",t.substring(0,32)),e===t.split(",")[1]}function o(e){return function(e,t){try{const n=new URL(e);return n.searchParams.delete(t),n.toString()}catch(n){return console.error("Invalid URL:",n),e}}(e,"updates")}function s(e){const t=new URL(e),n=t.searchParams.get("updates"),a="".concat(n?parseInt(n,10)+1:1);return t.searchParams.set("updates",a),t.toString()}function l(e,t){return new Promise((async(n,a)=>{try{for(const n in e)if(e.hasOwnProperty(n)&&t.hasOwnProperty(n)){const a=e[n],o=t[n];if(a.startsWith("http")&&o.startsWith("data:image")){const e=await i(a,!0);e&&r(e,o)&&(t[n]=a)}}n(t)}catch(o){a(o)}}))}function c(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new Promise(((i,r)=>{const o=new Image;o.onload=()=>{const e=document.createElement("canvas"),s=e.getContext("2d");if(!s)return r("No canvas context");e.width=t,e.height=n,s.globalAlpha=a;for(let a=0;a<n;a+=o.height)for(let e=0;e<t;e+=o.width)s.drawImage(o,e,a,o.width,o.height);i(e.toDataURL())},o.onerror=r,o.src=e}))}},33871:function(e,t,n){n.d(t,{mA:function(){return u},py:function(){return d},xz:function(){return f}});var a=n(79230),i=n(23596),r=n(13653),o=n(53754),s=n(80203),l=n(4623);const c=e=>e.replace(/_/g," ").split("@")[0],d=e=>{const[t,n]=e.split(".",2);if(!n)return{name:t};const[a,i]=[n.split("_")[0],n.split("_").slice(1).join(" ")];return{name:t,type:a,selectIndex:i,typeAndSelectIndex:n}},u=e=>{const[t,n]=e.split("@");return{name:t,directive:n}},h=(e,t,n)=>{const a=n.name,{name:r,type:s,selectIndex:u,typeAndSelectIndex:h}=d(t);if(!h||!s)return{field:null,updatedFields:e};const f={};switch(s){case"select":var p;f.id="".concat(r,".").concat(s),f.name=c(r),f.type="".concat(a,"_").concat(s);const d={name:"".concat(c(r)," ").concat(u),id:t,index:u||0,type:a};f.options=(0,i.VS)({...(null===(p=e[f.id])||void 0===p?void 0:p.options)||{},[d.id]:d});break;case"upload":f.id="".concat(r,".").concat(s),f.name=c(r),f.type="".concat(a,"_").concat(s);break;case"faceshot":default:f.id="".concat(r,".").concat(s),f.name=c(r),f.type=s;break;case"text":case"gen":case"defgen":f.id="".concat(r,".").concat(s),f.name=c(r),f.type=s,f.placeholder=(e=>{for(var t=e.children[0];t.children&&t.children.length>0;)t=t.children[0];const n=t.value;return(0,o.N4)(n)?null:n})(n)||f.name;break;case"textarea":f.id="".concat(r,".").concat(s),f.name=c(r),f.type=s,f.placeholder=(0,l.O)(n).defaultInputLines.join("\n")}return Object.keys(f).length>0&&(e[f.id]=f),{field:f,updatedFields:e}},f=e=>new Promise((async(t,n)=>{try{e?(0,a.parse)((0,i.rY)(e)).then((async e=>{const o=[],l={};var c=[],f=[];const p=[];var g={};const m=[],x=[],v={};var b,w;const y=[];for(const t of e.children){const e=(t.attributes["data-name"]||t.attributes.id||(0,i.Bu)(8)).replace(/^_+|_+$/g,"");t.attributes.id=e;const{field:n,updatedFields:a}=h(g,e,t);if(g=a,"image"==t.name){if((null===n||void 0===n?void 0:n.type)&&["image_upload","sign","faceshot"].includes((null===n||void 0===n?void 0:n.type)||""))y.push(new Promise((async(n,a)=>{const i=await(0,s.qM)(t.attributes["xlink:href"]);try{const t=await(0,s.RA)(i,!0);n({imageId:e,filterId:"ImageTransform",mask:{filter_id:"ImageTransform",args:t}})}catch(r){o.push("".concat(t.attributes.id," has image annotation error: ").concat(r.message)),a(r)}}))),l[e]="";else if(c.includes(t.attributes["xlink:href"])){const n=c.indexOf(t.attributes["xlink:href"]);l[e]=f[n]}else l[e]=t.attributes["xlink:href"],c.push(t.attributes["xlink:href"]),f.push(e);t.attributes["xlink:href"]="",n&&"image_select"==n.type&&p.push(e)}if(n)if("image_select"==(null===n||void 0===n?void 0:n.type))t.attributes.id=n.id,x.includes(t.attributes.id)||(m.push(t),x.push(t.attributes.id));else{const{name:n}=d(e),{directive:a}=u(n);a&&"name"==a?b=e:a&&"desc"==a&&(w=e),m.push(t)}else m.push(t)}let k;if(y.length>0)try{const e=await Promise.all(y);for(const t of e)v[t.imageId]={[t.filterId]:t.mask}}catch(S){k=S}if(o.length>0)return n(new Error(o.join(" ")));if(k)return k;if(!b||!w){let e;return e=b||w?b?"Make sure that at least @desc is declared on a text field. @small is optional.":"Make sure that at least @name is declared on a text field. @small is optional.":"Make sure that at least @name and @desc is declared on some text fields. @small is optional.",n(new Error(e))}c=[],f=[],e.children=m;const j=await(0,i.WN)(l,(async(e,t)=>{const{width:n}=await(0,r.pz)(t);var a={};return a={["".concat(e)]:t},n>=728&&(a={...a,["".concat(e)]:t,["".concat(e,"_512")]:await(0,r.gu)(t,512)}),n>=1024&&(a={...a,["".concat(e)]:t,["".concat(e,"_728")]:await(0,r.gu)(t,728)}),n>=2047&&(a={...a,["".concat(e)]:t,["".concat(e,"_1024")]:await(0,r.gu)(t,1024)}),p.includes(e)&&(a["".concat(e,"_thumbnail")]=await(0,r.gu)(t,70)),Object.keys(a).length>0?a:null}));t({svg:(0,a.stringify)(e),fields:g,images:j,masks:v,cssActions:{if_selector:{"*":{declarations:[{property:"white-space",value:"pre"}]}}}})})).catch((e=>{n(e)})):t(null)}catch(o){n(o)}}))},23596:function(e,t,n){n.d(t,{Bu:function(){return c},Dn:function(){return p},Ri:function(){return x},VS:function(){return f},WN:function(){return d},gJ:function(){return b},oh:function(){return j},rY:function(){return l},s7:function(){return m},t9:function(){return k},vq:function(){return y},zI:function(){return v}});var a=n(25723),i=n(53754),r=n(85431),o=n(33871),s=n(21876).Buffer;function l(e){const t="data:image/svg+xml;base64,";e.startsWith(t)&&(e=e.slice(t.length));const n=function(e){if("undefined"!==typeof s)return s.from(e,"base64").toString("binary");if("function"===typeof window.atob)return window.atob(e);throw new Error("Base64 decoding not supported in this environment")}(e),a=new Array(n.length);for(let r=0;r<n.length;r++)a[r]=n.charCodeAt(r);const i=new Uint8Array(a);return new TextDecoder("utf-8").decode(i)}function c(e){const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let a=0;a<e;a++){const e=Math.floor(Math.random()*t.length);n+=t.charAt(e)}return n}function d(e,t){return new Promise((async(n,a)=>{try{const a={...e};for(const[n,i]of Object.entries(e))if(i&&v(i)){const e=await t(n,i);e&&Object.assign(a,e)}n(a)}catch(i){a(i)}}))}function u(e,t){const[n,a]=t.split(","),i=n.match(/data:(.*?);base64/);if(!i)throw new Error("Invalid base64 data format");const r=i[1],o=atob(a),s=o.length,l=new Uint8Array(s);for(let u=0;u<s;u++)l[u]=o.charCodeAt(u);const c=new Blob([l],{type:r}),d="".concat(y(e),".").concat(r.split("/")[1]);return{id:e,image:new File([c],d,{type:r})}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data.json";const n=JSON.stringify(e,null,2),a=new Blob([n],{type:"application/json"}),i=new File([a],t,{type:"application/json"});return i}function f(e){const t=Object.entries(e);t.sort(((e,t)=>{let[,n]=e,[,a]=t;const i=(n.index||"").toString(),r=(a.index||"").toString();return i.localeCompare(r)}));const n={};for(const[a,i]of t)n[a]=i;return n}const p=e=>{const t=Object.entries(e);t.sort(((e,t)=>{const n=e[1].name.toUpperCase(),a=t[1].name.toUpperCase();return n<a?-1:n>a?1:0}));const n={};return t.forEach((e=>{let[t,a]=e;n[t]=a})),n};function g(e,t){return!(!e||!t)&&(x(e)&&(0,r.zD)(e).toLowerCase()===(0,r.zD)(t).toLowerCase())}const m=(e,t)=>new Promise((async(n,a)=>{if(!t)return n(e);const i={};i.svg=e.svg;const o=[];for(const[r,s]of Object.entries(t.fields)){const t=e.fields[r];if(t){if(t.type!=s.type)o.push("The ".concat(s.type.split("_").join(" "),' field, "').concat(s.name,'" is misrepresented as "').concat(t.type.split("_").join(" "),'" in the new template.'));else if(s.options&&!(null===t||void 0===t?void 0:t.options))o.push("The ".concat(s.type.split("_").join(" "),' field, "').concat(s.name,'" is missing options in the new template.'));else if(s.options&&t.options)for(const e of Object.values(s.options))t.options[e.id]?t.options[e.id].type!=e.type&&o.push("The ".concat(s.type.split("_").join(" ")," ").concat(s.name,' option, "').concat(e.name,'" is misrepresented as "').concat(t.options[e.id].type.split("_").join(" "),'" in the new template.')):o.push("The ".concat(s.type.split("_").join(" ")," ").concat(s.name,' option, "').concat(e.name,'" is missing in the new template.'))}else o.push("The ".concat(s.type.split("_").join(" "),' field, "').concat(s.name,'" is missing in the new template.'))}if(Object.keys(t.images||{}).length>0&&0==Object.keys(e.images||{}).length)o.push("Images are missing in missing in the new template.");else if(Object.keys(t.images||{}).length>0)for(const r of Object.keys(t.images))e.images[r]||r.includes(".select")||o.push("The image with the id, ".concat(r," is missing in the new template."));i.fields={...t.fields,...e.fields};for(const[e,t]of Object.entries(i.fields))t.options&&(i.fields[e].options=f(t.options));if(i.images=await(0,r.sH)(t.images,{...t.images,...e.images}),o.length>0)return a(new Error(o.join("\n")));n(i)})),x=e=>e.startsWith("http"),v=e=>e.startsWith("data:image")||e.startsWith("data:img"),b=(e,t,n)=>{if(!e)return"";var a=t[e];if(e.includes("."),!a||x(a)||v(a)?a&&(a=t["".concat(e).concat(n||"")],e.includes(".")):(a=t["".concat(t[e]).concat(n||"")],e.includes(".")),!a&&n){const n=e.split("_"),i=n[n.length-1];(isNaN(Number(i.trim()))||Number(i.trim())<512)&&(a=t[e])}return e.includes("."),a},w=async(e,t,n,r,o)=>{const s=await(0,a.dq)(e,t,"https://r2.softbaker.com/"),l=[...n],c=[],d=[],u=[];return s.forEach((e=>{(0,i.N4)(e.error)?(l.push(e),c.push(e.id)):(o&&o("Failed to upload file with error, ".concat(e.error||"",". Would be retried later."),e.id,!0),d.push(e))})),t.forEach((e=>{c.includes(e.id)||u.push(e)})),u.length>0?r?(o&&o("Failed files upload retry stopped for ".concat(u.length," files.")),[...l,...d]):(o&&o("Sleeping for 5 seconds to retry ".concat(u.length," failed file uploads. Make sure you're connected to the internet....")),await(0,a._v)(5e3),o&&o("Resuming program to retry the ".concat(u.length," failed file uploads. Make sure you're connected to the internet...")),w(e,u,l,u.length==t.length,o)):l};function y(e){return e.trim().replace(/[/\\?%*:|"<>]/g,"").replace(/\s+/g,"-")}const k=(e,t,n,o,s,l,c,d,f,p)=>{console.log("uploadTemplates: ","toolId",t,"templates",n,"template",o,"templateData",s,"oldTemplate",l,"oldTemplateData",c,"oldTemplatesUrl",d);const m=(e,t)=>{p&&p(e,t)},k=e=>{m(e,0)};return new Promise((async(p,j)=>{try{m("Template assets upload started...");const _=[];if(o.id||_.push("ID is missing in the template"),o.name||_.push("Please provide the template's name"),o.logo||_.push("Please provide the template's logo"),_.length>0)return j(new Error(_.join("\n")));const O=o.id;if((null===l||void 0===l?void 0:l.logo)&&x(l.logo)&&v(o.logo)){const e=l.logo,t=await(0,r.tY)(e,!0);t&&(0,r.pu)(t,o.logo)&&(o.logo=l.logo)}m("Stacking template images and logo to upload...");const F=[];for(const[e,n]of Object.entries(s.images))if(v(n)){const{image:i}=u(e,n);F.push({id:e,file:i,fileName:"templates-".concat(t,"-").concat(O,"-").concat(y(e),"-image.").concat((0,a.tD)(i.name).ext),dir:"templates"})}const N="templates-".concat(t,"-").concat(O,"-logo");if(v(o.logo)){const e=u(N,o.logo);F.push({id:N,file:e.image,fileName:"".concat(N,".").concat((0,a.tD)(e.image.name).ext),dir:"templates"})}m("Uploading template images and logo...");const P=await w(e,F,[],!1,k),A={};var S=null,C=null;m("Linking template images IDs and logo to the uploaded images..."),P.forEach((e=>{(0,i.N4)(e.error)?e.id!=N?A[e.id]=e.url:S=e.url:(C=new Error(e.error),m('The image, "'.concat(e.id,"\" failed to upload. Please make sure you're connected to the internet.")))}));for(const[e,t]of Object.entries(A))c&&b(e,c.images)&&g(b(e,c.images),t)?s.images[e]=(0,r._P)(b(e,c.images)):s.images[e]=t;if(S&&((null===l||void 0===l?void 0:l.logo)&&g(l.logo,S)?o.logo=(0,r._P)(l.logo):o.logo=S),f&&f(o,s),C)return j(C);var I=null;if(m("Checking if any changes need to be written to the template data file..."),s.svg!=(null===c||void 0===c?void 0:c.svg)||JSON.stringify(s.fields||{})!=JSON.stringify((null===c||void 0===c?void 0:c.fields)||{})||JSON.stringify(s.images||{})!=JSON.stringify((null===c||void 0===c?void 0:c.images)||{})||JSON.stringify(s.masks||{})!=JSON.stringify((null===c||void 0===c?void 0:c.masks)||{})||JSON.stringify(s.cssActions||{})!=JSON.stringify((null===c||void 0===c?void 0:c.cssActions)||{})){m("Uploading the template data file with the changes made...");const n=h(s),r="templates-".concat(t,"-").concat(O,"-data");if(I=await w(e,[{id:r,file:n,fileName:"".concat(r,".").concat((0,a.tD)(n.name).ext),dir:"templates"}],[],!1,k),!(0,i.N4)(I[0].error))return j(new Error(I[0].error))}var E=null;if(o.name!==(null===l||void 0===l?void 0:l.name)||o.logo!==(null===l||void 0===l?void 0:l.logo)||o.is_default!==(null===l||void 0===l?void 0:l.is_default)||o.split_on_download!==(null===l||void 0===l?void 0:l.split_on_download)||I){I&&((null===l||void 0===l?void 0:l.data_url)&&g(l.data_url,I[0].url)?o.data_url=(0,r._P)(l.data_url):o.data_url=I[0].url,f&&f(o,s)),m("Updating the the tool's template list data file with the new template's data...");const c=h({...n,[O]:o}),d="templates-".concat(t);if(E=await w(e,[{id:d,file:c,fileName:"".concat(d,".").concat((0,a.tD)(c.name).ext),dir:"templates"}],[],!1,k),!(0,i.N4)(E[0].error))return j(new Error(E[0].error))}var T=E?E[0].url:null;d&&T&&g(d,T)?(T=(0,r._P)(d),m("Template updated with no error \u2714\u2714"),p(T)):d?(m("No changes found in the template."),p(null)):(m("Template created with no error \u2714\u2714"),p(T))}catch(_){j(_)}}))},j=e=>{const{type:t}=(0,o.py)(e);return!(!t||!["text","textarea"].includes(t))}},75863:function(e,t,n){var a=n(85893),i=n(51857),r=n.n(i),o=n(34292),s=n(57747),l=n(71293),c=n(85970),d=n(5418),u=n(6089),h=n(67294),f=n(94345),p=n(53754),g=n(49626);const m=e=>{let{id:t,link:n,downloadImage:i,title:r,image:c,thumbnail:d,...u}=e;return(0,a.jsxs)(o.U,{cursor:"pointer",justifyContent:"flex-start",alignItems:"flex-end",mb:4,...u,children:[(0,a.jsx)(s.xu,{as:"image",w:"40px",h:"40px",backgroundColor:"#dfdfdf",style:{backgroundImage:"url(".concat(d,")")},backgroundRepeat:"no-repeat",backgroundSize:"cover"}),(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:r})]})};t.Z=e=>{let{title:t,helperText:n,info:i,textTransform:x,labelEndIcon:v,image:b,thumbnail:w,imageTitle:y,options:k,onChange:j,disabled:S,...C}=e;const[I,E]=(0,h.useState)(!1);return(0,a.jsxs)(s.xu,{...C,children:[(0,a.jsxs)(c.NI,{opacity:S?.4:1,cursor:S?"not-allowed":"pointer",children:[(0,a.jsxs)(o.U,{w:"100%",justifyContent:"space-between",alignItems:"center",children:[!t||(0,p.N4)(i)||S?(0,a.jsx)(d.l,{textTransform:x||"capitalize",mb:"0px",children:t}):(0,a.jsx)(g.Z,{as:d.l,info:i,textTransform:x||"capitalize",children:t}),v||null]}),(0,a.jsxs)(o.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),S||E(!0)},children:[(0,a.jsx)(s.xu,{width:"auto",height:"40px",maxWidth:"50px",bg:"#dfdfdf",children:w?(0,a.jsx)(u.E,{src:w,width:"auto",h:"40px",objectFit:"cover"}):null}),(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:y})]}),(0,p.N4)(n)||S?null:(0,a.jsx)(c.Q6,{children:n})]}),(0,a.jsx)(f.Z,{title:t,isOpen:I,onClose:()=>{E(!1)},overflowY:"auto",children:(k||[]).map(((e,t)=>(0,a.jsx)(m,{...e,onClick:()=>{j(e),E(!1)}},t)))}),(0,a.jsx)(r(),{id:"95178590041dfe1a",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})}},14132:function(e,t,n){n.d(t,{Z:function(){return N}});var a=n(85893),i=n(51857),r=n.n(i),o=n(34292),s=n(71293),l=n(57747),c=n(85970),d=n(5418),u=n(6089),h=n(67294),f=n(94345),p=n(55154),g=n(11802),m=n(85461),x=n(36238),v=n(65367);const b=e=>{let{image:t,selected:n,onClick:i,...r}=e;const[o,l]=(0,h.useState)(!0),[c,d]=(0,h.useState)();return(0,a.jsxs)(a.Fragment,{children:[o?(0,a.jsx)(s.x,{as:"div",textAlign:"center",cursor:"pointer",fontStyle:"italic",fontSize:"12px",display:"flex",justifyContent:"center",alignItems:"center",w:"100px",height:"50px",mr:"5px",mb:"5px",border:"4px dashed ".concat(c?"rgb(246, 70, 93)":"#dd6b20"),children:c||"Loading Signature..."}):null,(0,a.jsx)(u.E,{onClick:i,cursor:"pointer",bg:"#cfcfcf",src:t,display:o?"none":"block",w:"100px",h:"auto",mr:"5px",mb:"5px",border:n?"4px ridge #dd6b20":"2px dashed #dd6b20",_hover:{border:"4px ridge #dd6b20"},onLoad:()=>{l(!1),d(void 0)},onError:()=>{l(!1),d("Failed to load signature")}})]})};var w=e=>{let{onClose:t,onImage:n}=e;const[i,r]=(0,h.useState)(),[s,l]=(0,h.useState)(),[c,d]=(0,h.useState)();return(0,a.jsxs)(f.Z,{title:"Select Signature",isOpen:!0,onClose:t,children:[(0,a.jsx)(o.U,{maxHeight:"320px",justifyContent:"flex-start",alignItems:"flex-end",mb:2,flexWrap:"wrap",pos:"relative",overflowY:"auto",children:g.J8.map(((e,t)=>(0,a.jsx)(b,{image:e,selected:e==i,onClick:()=>{c||r(e)}},t)))}),(0,a.jsx)(x.Z,{type:x.Z.TYPES.none,errorMessage:s,mb:1}),(0,a.jsx)(m.Z,{status:c?"loading":"warning",mb:"1rem",onClick:()=>{l(""),i?(d(!0),(0,v.Ic)(i).then((e=>{n(null,e)})).catch((e=>{l(e.message),d(!1)}))):l("Please select a signature to use above.")},children:c?"Please wait...":"Use Signature"})]})},y=n(7963),k=n(17672),j=n(86455),S=n.n(j),C=n(96918);var I=e=>{let{onClose:t,onImage:n,minSignatureWidth:i,maxSignatureWidth:r}=e;const c=(0,h.useRef)(null),[d,u]=(0,h.useState)(!1),[g,x]=(0,h.useState)(),[v,b]=(0,h.useState)(),w=(0,y.p)(),j=()=>{const e=document.getElementById("signature_track");e?(c.current=new k.Z(e,{penColor:"#000",minWidth:i||.7,maxWidth:r||.7}),u(!0)):setTimeout((()=>{j()}),100)};(0,h.useEffect)((()=>{j()}),[]);return(0,a.jsxs)(f.Z,{title:"Draw Signature",isOpen:!0,onClose:()=>t(),children:[d?(0,a.jsx)(s.x,{fontSize:"12px",mb:2,children:"Drag your finger or mouse around, inside the box below to sign."}):(0,a.jsx)(s.x,{fontSize:"12px",mb:2,fontStyle:"italic",children:"Setting up signature pad. Please wait..."}),(0,a.jsx)(l.xu,{as:"canvas",id:"signature_track",mb:0,width:"100%",height:"150px",cursor:"pointer",bg:"#cfcfcf",border:"4px ridge #dd6b20"}),(0,a.jsxs)(o.U,{justifyContent:"space-between",alignItems:"center",mb:1,children:[(0,a.jsx)(m.Z,{status:"warning",mb:"1rem",onClick:()=>{const e=c.current;if(e){const t=e.toData();t.pop(),e.fromData(t)}else w({description:"Signature pad unavailabe. Please try again later.",status:"error",duration:4e3,isClosable:!0})},rightIcon:(0,a.jsx)(p.wXW,{}),children:"Undo"}),(0,a.jsx)(m.Z,{status:"warning",mb:"1rem",onClick:()=>{const e=c.current;e?e.clear():w({description:"Signature pad unavailabe. Please try again later.",status:"error",duration:4e3,isClosable:!0})},rightIcon:(0,a.jsx)(p.Xm5,{}),children:"Clear"})]}),g?(0,a.jsx)(s.x,{fontStyle:"italic",fontSize:"12px",children:"Processing signature..."}):null,v?(0,a.jsx)(s.x,{fontSize:"12px",color:(0,C.Z)("errorColor.light","errorColor.dark"),children:v}):null,(0,a.jsx)(m.Z,{status:"warning",mb:"1rem",onClick:()=>{var e;if(g)return void S().fire({icon:"info",title:"Processing",text:"Your signature is currently being processed. Please try again after processing."});x(!0);const t=(null===(e=c.current)||void 0===e?void 0:e.toDataURL())||"";n(null,t)},children:"Use Signature"})]})},E=n(35052),T=n(30351),_=n(49626),O=n(53754);const F=e=>{let{icon:t,title:n,...i}=e;return(0,a.jsxs)(o.U,{cursor:"pointer",justifyContent:"flex-start",alignItems:"flex-end",mb:4,...i,children:[(0,a.jsx)(o.U,{w:"35px",h:"35px",justifyContent:"center",alignItems:"center",borderRadius:"5px",border:"1px solid #dfdfdf",children:t}),(0,a.jsx)(s.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:n})]})};var N=e=>{let{title:t,thumbnail:n,onChange:i,disabled:g,errorMessage:m,info:v,helperText:b,textTransform:y,labelEndIcon:k,minSignatureWidth:j,maxSignatureWidth:S,...C}=e;const[N,P]=(0,h.useState)(!1),[A,M]=(0,h.useState)(!1),[Z,D]=(0,h.useState)(null),z=[{icon:(0,a.jsx)(p.AeW,{}),title:"Select Signature",name:"select"},{icon:(0,a.jsx)(p.mvm,{}),title:"Draw Signature",name:"draw"},{icon:(0,a.jsx)(p.DUB,{}),title:"Upload Signature",name:"upload"}],U=e=>{M(!0),P(!1),D(null),(0,T.Me)(e).then((t=>{t?(i(null),M(!1)):(0,T.xJ)(e).then((e=>{i(e),M(!1)})).catch((e=>{M(!1)}))})).catch((e=>{M(!1)}))};return(0,a.jsxs)(l.xu,{...C,children:[(0,a.jsxs)(c.NI,{opacity:A||g?.4:1,cursor:A||g?"not-allowed":"pointer",children:[(0,a.jsxs)(o.U,{w:"100%",justifyContent:"space-between",alignItems:"center",children:[!t||(0,O.N4)(v)||g?(0,a.jsx)(d.l,{textTransform:y||"capitalize",mb:"0px",children:t}):(0,a.jsx)(_.Z,{as:d.l,info:v,textTransform:y||"capitalize",children:t}),k||null]}),(0,a.jsxs)(o.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),g||A||(D(null),P(!0))},children:[(0,a.jsx)(l.xu,{width:"auto",height:"40px",bg:"#dfdfdf",children:!A&&n?(0,a.jsx)(u.E,{src:n,width:"auto",h:"40px",objectFit:"cover"}):null}),(0,a.jsx)(s.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontStyle:A?"italic":"normal",children:A?"Please wait...":n?"Click to change":"Click to sign"})]})]}),(0,a.jsx)(x.Z,{type:x.Z.TYPES.none,helperText:b,errorMessage:m}),Z?"select"==Z?(0,a.jsx)(w,{onImage:(e,t)=>{U(t)},onClose:()=>{D(null)}}):"draw"==Z?(0,a.jsx)(I,{minSignatureWidth:j,maxSignatureWidth:S,onImage:(e,t)=>{U(t)},onClose:()=>{D(null)}}):(0,a.jsx)(E.Z,{title:"Upload Signature",message:"Drag and Drop Signature here",hoverMessage:"Drop the Signature here",ruleMessage:"Upload only transparent PNG image",useImageText:"Use Signature",maxFileSize:1048576,onImage:(e,t)=>{U(t)},onClose:()=>{D(null)}}):(0,a.jsxs)(f.Z,{title:t,isOpen:N,onClose:()=>{P(!1)},children:[(0,a.jsx)(s.x,{mb:"1rem",children:"Click one of the below signature options to provide a signature."}),(z||[]).map(((e,t)=>(0,a.jsx)(F,{...e,onClick:()=>{e.name&&D(e.name)}},t)))]}),(0,a.jsx)(r(),{id:"95178590041dfe1a",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})}},62122:function(e,t,n){var a=n(85893),i=n(51857),r=n.n(i),o=n(34292),s=n(6089),l=n(71293),c=n(57747),d=n(85970),u=n(49626),h=n(36238),f=n(67294),p=n(94345),g=n(98687),m=n(55154);const x=e=>{let{id:t,name:n,logo:i,onDelete:r,...d}=e;return(0,a.jsxs)(o.U,{cursor:"pointer",justifyContent:"space-between",alignItems:"flex-end",mb:1,mx:"0.5rem",...d,children:[(0,a.jsxs)(o.U,{justifyContent:"flex-start",alignItems:"flex-end",children:[(0,a.jsx)(s.E,{src:i||"/res/svg-icon.png",w:"35px",h:"35px",borderRadius:"5px",border:"1px solid #dfdfdf"}),(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:n||"No name yet"})]}),r?(0,a.jsx)(c.xu,{p:"0.5rem",onClick:()=>{r(t)},children:(0,a.jsx)(m.Xm5,{color:"#e53e3e"})}):null]})};t.Z=e=>{let{id:t,title:n,templates:i,createdTemplatesKeys:m,value:v,onChange:b,onNewTemplateSvgUploaded:w,disabled:y,errorMessage:k,info:j,helperText:S,onDelete:C,contactLink:I,...E}=e;const[T,_]=(0,f.useState)(!1),[O,F]=(0,f.useState)(),[N,P]=(0,f.useState)([]);return(0,f.useEffect)((()=>{v&&F(v)}),[v]),(0,a.jsxs)(c.xu,{...E,children:[(0,a.jsxs)(d.NI,{opacity:y?.4:1,cursor:y?"not-allowed":"pointer",children:[(0,a.jsx)(u.Z,{textTransform:"capitalize",info:j,children:n}),(0,a.jsxs)(o.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),y||_(!0)},children:[O?(0,a.jsx)(s.E,{src:O.logo||"/res/svg-icon.png",w:"35px",h:"35px",borderRadius:"5px",border:"1px solid #dfdfdf"}):null,(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:O?O.name||"No name yet":"Select Template"})]})]}),(0,a.jsx)(h.Z,{type:h.Z.TYPES.none,helperText:S,errorMessage:k}),T?(0,a.jsxs)(p.Z,{title:n,isOpen:!0,onClose:()=>{_(!1)},children:[w?(0,a.jsx)(o.U,{children:(0,a.jsx)(g.Z,{showAsButton:!0,isOtherFiles:!0,w:"100%",id:"Form_".concat(t,"logo"),title:"Add Template",mb:4,info:"This is where you upload your SVG file to generate a template from.",helperText:"Click to select upload an SVG file to use as a template.",message:"Drag and Drop file here",hoverMessage:"Drop the file here",ruleMessage:"Make sure you're uploading a .svg file.",useImageText:"Use File",onChange:(e,t)=>{_(!1),w(e,t)}},"Form_".concat(t,"logo"))}):null,(0,a.jsxs)(c.xu,{height:"50vh",pos:"relative",overflowY:"auto",children:[Object.values(i).map(((e,t)=>(0,a.jsx)(x,{...e,onClick:()=>{_(!1),b(e)},border:v&&v.id===(null===e||void 0===e?void 0:e.id)?"1px dashed":"none",borderRadius:v&&v.id===(null===e||void 0===e?void 0:e.id)?"5px":"0px",_hover:{opacity:"0.4"},onDelete:m&&m.length>0&&!m.includes(e.id)?C:null},t))),!w&&I?(0,a.jsxs)(c.xu,{w:"100%",textAlign:"center",fontSize:"14px",pb:"0.5rem",children:[(0,a.jsx)(l.x,{as:"div",children:"Can't find the type you want?"}),(0,a.jsx)(l.x,{as:"a",href:I,target:"_blank",color:"#38a169",textDecoration:"underline",children:"Click here to tell us what you want."})]}):null]})]}):null,(0,a.jsx)(r(),{id:"42ccd62b5c30613c",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})}},25723:function(e,t,n){n.d(t,{_v:function(){return o},dq:function(){return s},tD:function(){return r}});var a=n(87066),i=n(11802);function r(e){const t=e.split("."),n=t.length>1&&t.pop()||"";return{name:t.join("."),ext:n}}const o=e=>new Promise((t=>setTimeout(t,e))),s=async function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const l=[];for(const d of t){const{id:t,file:u,fileName:h,dir:f,onFileName:p}=d,{name:g,ext:m}=r(u.name),x=p?p(g,m):h||u.name;try{const r=await e.getIdToken(),o=await a.Z.post("".concat(i.Lu,"/get-presigned-url"),{id:t,fileName:x,fileType:u.type,dir:f},{headers:{Authorization:r}}),{presignedUrl:s}=o.data;if(200===(await a.Z.put(s,u,{headers:{"Content-Type":u.type}})).status){const e=n?"".concat(n).concat(n.endsWith("/")?"":"/").concat(f||"").concat((f||"").endsWith("/")?"":"/").concat(x):s.split("?")[0];l.push({id:t,url:e})}else l.push({id:t,url:"",error:"Upload failed"})}catch(c){l.push({id:t,url:"",error:c.message})}await o(s)}return l}},80203:function(e,t,n){n.d(t,{RA:function(){return d},cr:function(){return h},qM:function(){return i}});const a=(e,t,n)=>{const a=Math.max(t,n);return e>a&&Math.abs(e-a)>=16&&Math.abs(t-n)<=1};function i(e){return new Promise((t=>{const n=new Image;n.onload=()=>t(n),n.src=e}))}function r(e){return e.toDataURL()}function o(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;const i=document.createElement("canvas"),r=i.getContext("2d");if(r){r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high";var o=t,s=t/(e.naturalWidth/e.naturalHeight);if(i.width=t,i.height=n,n>s){const t=100*(n-s)/n,i=Math.min(a,t),l=i/100*e.naturalWidth,c=l/2;s+=i/100*s,r.drawImage(e,c,0,e.naturalWidth-l,e.naturalHeight,0,n-s,o,s)}else r.drawImage(e,0,0,e.width,e.height,0,0,o,s)}return i}function s(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function l(e,t){return new Promise(((n,a)=>{const i=document.createElement("canvas");i.width=e.naturalWidth,i.height=e.naturalHeight;const r=i.getContext("2d");if(!r)return a(new Error("Could not get canvas context"));r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(e,0,0);const o=r.getImageData(0,0,e.width,e.height).data,s=t=>{for(let n=0;n<e.width;n++){const a=4*(t*e.width+n);if(0!==o[a+3])return!1}return!0};let l=0;for(let t=0;t<e.height&&s(t);t++)l++;if(l>=t)return n(e);const c=t-l,d=document.createElement("canvas");d.width=e.width,d.height=e.height;const u=d.getContext("2d");if(!u)return a(new Error("Could not get canvas context"));u.clearRect(0,0,d.width,d.height),u.drawImage(e,0,0,e.width,e.height-c,0,c,e.width,e.height-c),n(d)}))}function c(e,t,n,a,i,r,o,s,l,c,d){const u=document.createElement("canvas"),h=u.getContext("2d");if(!h)throw new Error("Could not get canvas context");if(h.imageSmoothingEnabled=!0,h.imageSmoothingQuality="high",u.width=s,u.height=l,h.translate(s/2,l/2),h.rotate(t*Math.PI/180),h.transform(n,i,r,a,0,0),o){const e=o.x-s/2,t=o.y-l/2;h.translate(e,t)}h.drawImage(e,-e.width/2,-e.height/2);const f=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=document.createElement("canvas");a.width=e instanceof HTMLImageElement?e.naturalWidth:e.width,a.height=e instanceof HTMLImageElement?e.naturalHeight:e.height;const i=a.getContext("2d");if(!i)throw new Error("Could not get canvas context");i.imageSmoothingEnabled=!0,i.imageSmoothingQuality="high",i.clearRect(0,0,a.width,a.height);const{topLeft:r,topRight:o,bottomRight:s,bottomLeft:l}=t;return i.beginPath(),i.moveTo(r.x,r.y),i.lineTo(o.x,o.y),i.lineTo(s.x,s.y),i.lineTo(l.x,l.y),i.closePath(),i.save(),i.clip(),i.drawImage(e,0,0),i.restore(),n&&(i.strokeStyle=n,i.lineWidth=2,i.beginPath(),i.moveTo(r.x,r.y),i.lineTo(o.x,o.y),i.lineTo(s.x,s.y),i.lineTo(l.x,l.y),i.closePath(),i.stroke()),a}(u,c,null===d||void 0===d?void 0:d.border);return f}async function d(e,t){const n=await function(e){return new Promise(((t,n)=>{const i=document.createElement("canvas");i.width=e.naturalWidth,i.height=e.naturalHeight;const r=i.getContext("2d");if(!r)return n(new Error("Could not get canvas context"));r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(e,0,0);const o=r.getImageData(0,0,i.width,i.height),s=o.data,l=[];for(let e=0;e<o.height;e++)for(let t=0;t<o.width;t++){const n=4*(e*o.width+t),i=s[n],r=s[n+1],c=s[n+2];a(c,i,r)&&l.push({x:t,y:e})}if(0===l.length)return t(null);const c={x:1/0,y:1/0},d={x:-1/0,y:1/0},u={x:1/0,y:-1/0},h={x:-1/0,y:-1/0};l.forEach((e=>{e.x+e.y<c.x+c.y&&(c.x=e.x,c.y=e.y),e.x-e.y>d.x-d.y&&(d.x=e.x,d.y=e.y),e.x-e.y<u.x-u.y&&(u.x=e.x,u.y=e.y),e.x+e.y>h.x+h.y&&(h.x=e.x,h.y=e.y)})),t({topLeft:c,topRight:d,bottomRight:h,bottomLeft:u})}))}(e);if(!n)throw new Error("Blue border box not found!");const{topLeft:i,topRight:r,bottomLeft:o,bottomRight:l}=n;let c=await function(e){return new Promise(((t,n)=>{const i=document.createElement("canvas");i.width=e.naturalWidth,i.height=e.naturalHeight;const r=i.getContext("2d");if(!r)return n(new Error("Could not get canvas context"));r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(e,0,0);const o=r.getImageData(0,0,i.width,i.height).data;let s={x:[],y:[]};for(let e=0;e<i.height;e++)for(let t=0;t<i.width;t++){const n=4*(e*i.width+t),r=o[n],l=o[n+1],c=o[n+2];a(r,l,c)&&(s.x.push(t),s.y.push(e))}if(0==s.x.length)return n(new Error("No red dot found"));t(s)}))}(e);if(!i||!l)throw new Error("Bounding box corners not found");const d=await function(e){return new Promise(((t,n)=>{const i=document.createElement("canvas");i.width=e.naturalWidth,i.height=e.naturalHeight;const r=i.getContext("2d");if(!r)return n(new Error("Could not get canvas context"));r.imageSmoothingEnabled=!0,r.imageSmoothingQuality="high",r.drawImage(e,0,0);const o=r.getImageData(0,0,i.width,i.height).data;let s={x:1/0,y:0},l={x:0,y:1/0},c={x:0,y:0},d={x:0,y:0};for(let e=0;e<i.height;e++)for(let t=0;t<i.width;t++){const n=4*(e*i.width+t),r=o[n],u=o[n+1],h=o[n+2];a(u,r,h)&&(t<s.x&&(s={x:t,y:e}),t>c.x&&(c={x:t,y:e}),e<l.y&&(l={x:t,y:e}),e>d.y&&(d={x:t,y:e}))}const u=e.height>e.width,h=u?s:l,f=u?c:d;if(!h||!f)return n(new Error("No green line found"));t({startPoint:h,endPoint:f})}))}(e),{startPoint:u,endPoint:h}=d,f=(p=u,g=h,{x:Math.round((p.x+g.x)/2),y:Math.round((p.y+g.y)/2)});var p,g;const m={x:c.x[c.x.length-1],y:c.y[c.y.length-1]},x=Math.round(s(m,f)),v={x:m.x,y:m.y+x},b=2*(e.height>e.width?-1:1),w=b+Math.round(function(e,t,n){const{x:a,y:i}=e,{x:r,y:o}=t,{x:s,y:l}=n;function c(e,t){return Math.atan2(t-i,e-a)}const d=c(r,o);let u=c(s,l)-d;u<0&&(u+=2*Math.PI);return u*(180/Math.PI)}(m,v,f));let y=parseFloat((s(i,r)/e.naturalWidth).toPrecision(12)),k=parseFloat((s(i,o)/e.naturalHeight).toPrecision(12));y+=.04,k+=.04;return t&&console.log("analyzeImageV6:imageA",await async function(e){const t=await fetch(e),n=await t.blob(),a=await n.arrayBuffer(),i=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(i)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(e.src),"imageA.width",e.width,"imageA.height",e.height,"corners",n,"greenLineInfo",d,"redDots",c,"center",m,"greenLineCircleRadius",x,"greenLinePreviousPosition",v,"angleFill",b,"rotationAngle",w,"shearX",0,"shearY",0),{rotationAngle:w,scaleX:y,scaleY:k,shearX:0,shearY:0,center:m,width:e.width,height:e.height,corners:n}}const u=(e,t,n,a)=>{const i=function(e){const t=e%360;return Math.abs(t-90)<=30||Math.abs(t-270)<=30?"landscape":Math.abs(t-0)<=30||Math.abs(t-180)<=30||Math.abs(t-360)<=30?"portrait":"diagonal"}(a);return"portrait"==i||"diagonal"==i?o(e,t,n):o(e,n,t)};async function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=arguments.length>3?arguments[3]:void 0,o=await i(t);const{rotationAngle:s,scaleX:d,scaleY:h,shearX:f,shearY:p,center:g,width:m,height:x,corners:v}=e,b=m,w=x;o.width===b&&o.height===w||(o=u(o,b,w,s));const y=Math.round(n*o.height/100);o=await l(o,y);const k=c(o,s-360,d,h,f,p,g,b,w,v,a);return r(k)}},10151:function(e,t,n){n.d(t,{l:function(){return i}});class a{random(){const e=1e4*Math.sin(this.seed++);return e-Math.floor(e)}randomInt(e,t){return Math.floor(this.random()*(t-e+1))+e}constructor(e){this.seed=e}}function i(e,t,n){if(!e||!t)return"";function i(i,r,o){const s=n?function(e,t,n,a){if(null===e||void 0===e||null===n||void 0===n||null===t||void 0===t||null===a||void 0===a)return 0;const i=(e+Object.keys(n).filter((e=>a(e))).map((e=>n[e].toString().replace(/\s+/g,""))).join("")+t.toString()).toLowerCase();let r=0;for(let o=0;o<i.length;o++)r=(r<<5)-r+i.charCodeAt(o),r|=0;return r}(e,o,t,n):1e6*Math.random(),l=new a(s),c=e=>"string"===typeof e&&e.endsWith("d"),d=e=>!isNaN(e)&&!c("".concat(e));if(d(i)&&d(r))return l.randomInt(parseInt(i),parseInt(r)).toString();if(c(i)&&c(r)){const e=parseInt(i),t=parseInt(r);let n="",a=0;const o=l.randomInt(e,t);for(;a<o;){n+=l.randomInt(1,9).toString(),a=n.length}return n}if(c(i)){const e=parseInt(i);let t=l.randomInt(1,9).toString();for(let n=1;n<e;n++){t+=l.randomInt(0,9).toString()}return t}return d(i)?Math.round(l.random()*parseInt(i)).toString():"Invalid arguments for randomNumber function: "+"Min: ".concat(i," - ").concat(typeof i," | Max: ").concat(r," - ").concat(typeof r)}function r(e){if(!t)return"";const n=(e=e.replace(/[{}]+/g,"")).match(/(.+)\[w(\d+)\]/);if(n){const[,e,a]=n;return(t[e]||"").split(" ")[parseInt(a)-1]||""}return e in t?t[e]:""}function o(e,t,n){var a=null;if("cut"===t)if(n&&2==n.length)try{var i=parseInt(n[0]),r=parseInt(n[1]);a=e.substring(i-1,r)}catch(o){}return a}const s=[];let l=0,c=e.replace(/\(([^()]*)\)/g,((e,t)=>{if(t.startsWith("rn[")){const[e,n]=t.slice(3,-1).split(",");return i(e,n,l++)}if(t.match(/^([^*]+)(\*{1,2})(\d+)$/)){const[,e,n,a]=t.match(/^([^*]+)(\*{1,2})(\d+)$/)||[],i=parseInt(a);if("*"==n)return e.repeat(i);{const t="<".concat(Math.floor(1e9*Math.random()),">");return s.push({id:t,char:e,count:i}),t}}if(t.includes("{")&&t.includes("}")){var n=function(e){const t=/{([^{}]+?)}(\.\w+\[(.*?)\])?/g,n=[];let a;for(;null!==(a=t.exec(e));){const e=a[1],t=a[2]?a[2].split("[")[0].slice(1):null,i=a[3]?a[3].split(",").map((e=>e.trim())):[],r=a.index,o=a.index+a[0].length-1;n.push({varKey:e,varFunc:t||void 0,varFuncArgs:i.length?i:void 0,replacementStart:r,replacementEnd:o})}return n}(t);n.sort(((e,t)=>t.replacementStart-e.replacementStart));for(const e of n){var a=r(e.varKey);if(e.varFunc&&(a=o(a,e.varFunc,e.varFuncArgs)),!(a&&t.length>0)){t="";break}c=t,d=a,u=e.replacementStart,h=e.replacementEnd,t=c.slice(0,u)+d+c.slice(h+1)}return t}return t;var c,d,u,h}));for(const a of s){const e=c.length-a.id.length;if(e>=a.count)break;const t=a.char.repeat(a.count-e);c=c.replace(a.id,t)}return c}}}]);