"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[265],{32033:function(e,t,n){n.d(t,{Z:function(){return E}});var a=n(85893),o=n(67294),r=n(57747),i=n(48783),s=n(34292),l=n(93717),c=n(15948),d=n(98687),u=n(75863),h=n(14132),f=n(36238),p=n(55154),g=n(53754),m=n(38118),x=n(94345),v=n(71293),w=n(85461),y=n(33471),b=n(73804);var k=e=>{let{delimiter:t,value:n,onChange:s,suggestions:l,onSuggestionSelected:c,...d}=e;const[u,h]=(0,o.useState)(n||""),[p,g]=(0,o.useState)([]),[m,x]=(0,o.useState)(!1),[w,y]=(0,o.useState)(0);(0,o.useEffect)((()=>{h(n||"")}),[n]);const k=e=>{((e,n)=>{if(null==e||void 0==e)return;h(e),y(n);const a=e.slice(0,n).lastIndexOf(t),o=e.slice(a+t.length,n);if(-1===a||!/^[a-zA-Z]*$/.test(o)&&0!==o.length)x(!1);else{let e;e=0===o.length?l:l.filter((e=>e.toLowerCase().startsWith(o.toLowerCase()))),g(e),x(e.length>0)}s&&s(e)})(e.target.value,e.target.selectionStart||0)};return(0,a.jsxs)(r.xu,{w:"100%",overflowX:"hidden",children:[(0,a.jsx)(f.Z,{w:"100%",value:u,onChange:(e,t)=>k(t),onClick:e=>k(e),onKeyUp:e=>k(e),...d}),m&&(0,a.jsx)(i.g,{position:"absolute",zIndex:"1",w:"100%",boxShadow:"md",borderRadius:"md",height:"120px",width:"100%",overflowY:"auto",overflowX:"hidden",children:(0,a.jsx)(b.aV,{w:"100%",overflowX:"hidden",children:p.map(((e,n)=>(0,a.jsx)(b.HC,{overflowX:"hidden",p:"2",cursor:"pointer",_hover:{border:"1px solid",borderRadius:"3px"},onClick:()=>(e=>{const n=u.slice(0,w).lastIndexOf(t),a=u.slice(0,n+t.length)+e+u.slice(w);h(a),x(!1),t.length,e.length,c(e,n+t.length,a)})(e),children:(0,a.jsx)(v.x,{children:e})},n)))})})]})};var j=e=>{let{fields:t,field:n,images:i,submitButtonText:s,onSettingsUpdated:l}=e;const[c,d]=(0,o.useState)({}),[u,h]=(0,o.useState)({}),[g,m]=(0,o.useState)(null),[b,j]=(0,o.useState)(!1);(0,o.useEffect)((()=>{n&&d(n)}),[n]),(0,o.useEffect)((()=>{}),[c]);const[S,_]=(0,o.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.xu,{onClick:()=>{_(!0)},cursor:"pointer",children:(0,a.jsx)(p.rU2,{size:"1.5rem",color:["gen","defgen"].includes(n.type)?"#dd6b20":"#38a169"})}),S?(0,a.jsxs)(x.Z,{title:"".concat(n.name||""," settings"),isOpen:!0,onClose:()=>{_(!1)},dontCloseOnOverlayClick:b,children:[(0,a.jsxs)(r.xu,{height:"50vh",pos:"relative",overflowY:"auto",px:"0.5rem",children:[(0,a.jsx)(v.x,{display:"none",children:n.type}),["gen","defgen"].includes(n.type)?(0,a.jsx)(k,{w:"100%",id:"gen",title:"Text Generation Code",mb:4,helperText:"".concat((0,y.VH)(n.placeholder||""),"."),info:"This is where you enter the code for the text generation: ".concat((0,y.VH)(n.placeholder||""),"."),type:f.Z.TYPES.textarea,value:null===c||void 0===c?void 0:c.code,onChange:e=>{e&&d({...c,code:e})},errorMessage:u.code,delimiter:"{",suggestions:Object.keys(t),onSuggestionSelected:(e,t,n)=>{n&&d({...c,code:n})}},"gen"):null,["image_upload"].includes(n.type)?(0,a.jsx)(f.Z,{w:"100%",id:"upload",title:"File Rule",mb:4,helperText:'Enter the rule of the file. e.g "For best result, upload a 300x300 image."',info:'This is where you enter the rule of the file. e.g "For best result, upload a 300x300 image."',type:f.Z.TYPES.text,value:null===c||void 0===c?void 0:c.ruleMessage,onChange:e=>{e&&d({...c,ruleMessage:e})},errorMessage:u.ruleMessage},"upload"):null,["text","textarea","defgen"].includes(n.type)?(0,a.jsx)(f.Z,{w:"100%",id:"placeholder",title:"Placeholder",mb:4,helperText:"Enter the text that will show behind the text field as an example input.",info:"This is where you enter the text that will show behind the text field as an example input.",type:f.Z.TYPES.text,value:null===c||void 0===c?void 0:c.placeholder,onChange:e=>{e&&d({...c,placeholder:e})},errorMessage:u.placeholder},"placeholder"):null,"gen"!==n.type?(0,a.jsx)(f.Z,{w:"100%",id:"helper_text",title:"Helper Text",mb:4,helperText:"Enter the text that will show below this field just like this.",info:"This is where you enter the text that will show below this field.",type:f.Z.TYPES.text,value:null===c||void 0===c?void 0:c.helperText,onChange:e=>{e&&d({...c,helperText:e})},errorMessage:u.helperText},"helper_text"):null,["qrcode","checkbox","gen"].includes(n.type)?null:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{w:"100%",id:"info",title:"Info Text",mb:4,helperText:"Enter the text that will show when the user clicks the info icon on this field.",info:"This is where you enter the text that will show when the user clicks the info icon on this field just like this.",type:f.Z.TYPES.text,value:null===c||void 0===c?void 0:c.info,onChange:e=>{e&&d({...c,info:e})},errorMessage:u.info},"info"),(0,a.jsx)(f.Z,{w:"100%",id:"optional",title:"Make Optional",mb:4,helperText:"Enable this if you want this field to be optional.",type:f.Z.TYPES.checkbox,value:null===c||void 0===c?void 0:c.optional,onChange:e=>{e&&d({...c,optional:e})},errorMessage:u.optional},"optional")]})]}),(0,a.jsx)(r.xu,{mb:"1rem",children:(0,a.jsx)(w.Z,{status:"warning",mb:"1rem",onClick:()=>{b||(_(!1),l(c,null))},disabled:b,children:b?"Please wait...":s||"Submit Settings"})})]}):null]})},S=n(23596),_=n(10151);var E=e=>{let{created:t,showFieldsErrors:n,fields:x,images:v,masks:w,data:b,isFieldsEditMode:k,isDragable:E,onDragged:T,onFieldDataChange:I,onAllFieldsDataChange:C,fieldDataErrorMessage:O,onSetFieldDataErrorMessage:P}=e;const[F,A]=(0,o.useState)(Object.values(x)),[D,M]=(0,o.useState)(!1);(0,o.useEffect)((()=>{A(Object.values(x));const e={...b};for(const t of Object.values(x))"image_select"==t.type&&t.options&&!e[t.id]&&(e[t.id]=Object.keys(t.options)[0]);Object.keys(e).length>0&&JSON.stringify(e)!=JSON.stringify(b)&&C(e)}),[x,b]);const Z=(e,t)=>(P({...O,[e]:null}),null);return F&&0!=F.length?(0,a.jsx)(r.xu,{as:c.Z5,onDragEnd:e=>{if(!e.destination||!T)return;const t=Array.from(F),[n]=t.splice(e.source.index,1);t.splice(e.destination.index,0,n);const a=t.reduce(((e,t,n)=>(e[t.id]={...t,index:n},e)),{});console.info("parsedSvg:updatedFields",a),T(a)},p:"0px !important",children:(0,a.jsx)(c.bK,{droppableId:"fields",children:e=>(0,a.jsxs)(i.g,{w:"100%",ref:e.innerRef,...e.droppableProps,children:[F.map(((e,o)=>(0,a.jsx)(c._l,{draggableId:e.id,index:o,isDragDisabled:!E,children:o=>{const i=(e=>{const o={key:e.id,id:e.id,disabled:t,title:"".concat(e.name||"").concat(e.optional?"(Optional)":""),helperText:e.helperText||"",info:e.info||"",placeholder:(0,y.VH)(e.placeholder||e.name||""),onChange:t=>{Z(e.id),I(e.id,t)},errorMessage:n?O[e.id]:null,labelEndIcon:k?(0,a.jsx)(j,{fields:x,field:e,images:v,onSettingsUpdated:(t,n)=>{const a={...x,[e.id]:{...e,...t}},o=n?{...w||{},...n}:null;T&&T(a,o)}}):null,message:"Drag and Drop image here",hoverMessage:"Drop the image here",ruleMessage:e.ruleMessage||"Make sure you're uploading an image file.",useImageText:"Use Image"};switch(e.type){case"image_upload":return(0,a.jsx)(d.Z,{width:"100%",...o,thumbnail:b[e.id]&&!(0,S.zI)(b[e.id])?(0,g.VT)("other_tools_data",b.id,e.id):b[e.id]&&(0,S.zI)(b[e.id])?b[e.id]:void 0,onChange:(t,n)=>{n&&(Z(e.id),I(e.id,n))}});case"image_select":var r;const t=Object.values(e.options||{}).map((e=>({id:e.id,title:e.name,thumbnail:(0,S.gJ)(e.id,v,"_thumbnail"),image:{base:(0,S.gJ)(e.id,v,"_512"),md:(0,S.gJ)(e.id,v,"_728"),lg:(0,S.gJ)(e.id,v)}})))||[];return(0,a.jsx)(u.Z,{width:"100%",...o,thumbnail:(0,S.gJ)(b[e.id],v,"_thumbnail"),imageTitle:e.options?null===(r=e.options[b[e.id]])||void 0===r?void 0:r.name:"",onChange:t=>{const n=t;Z(e.id,n.id),I(e.id,n.id)},options:t});case"text":case"textarea":return(0,a.jsx)(f.Z,{width:"100%",...o,value:b[e.id]||"",type:e.type});case"defgen":return k?(0,a.jsx)(f.Z,{width:"100%",...o,type:f.Z.TYPES.text,value:b[e.id]||""}):null;case"gen":return k?(0,a.jsx)(f.Z,{width:"100%",...o,type:f.Z.TYPES.viewonly,placeholder:"",helperText:(0,y.VH)(e.placeholder||""),value:(0,_.l)(e.code,b,S.oh)}):null;case"checkbox":case"qrcode":return(0,a.jsx)(f.Z,{...o,value:b[e.id]||""});case"sign":return(0,a.jsx)(h.Z,{width:"100%",thumbnail:b[e.id]&&!(0,S.zI)(b[e.id])?(0,g.VT)("other_tools_data",b.id,e.id):b[e.id]&&(0,S.zI)(b[e.id])?b[e.id]:void 0,...o});default:return null}})(e);return i?(0,a.jsx)("div",{ref:o.innerRef,...o.draggableProps,...o.dragHandleProps,style:{...o.draggableProps.style,width:"100%"},children:(0,a.jsxs)(s.U,{w:"100%",justifyContent:"center",alignItems:e.helperText?"center":"flex-end",mb:4,children:[(0,a.jsx)(r.xu,{width:{base:"100%",md:E?"90%":"100%"},children:i}),(0,a.jsxs)(l.k,{display:{base:"none",md:E?"flex":"none"},w:"40px",h:"40px",border:"1px dashed",pos:"relative",justifyContent:"center",alignItems:"center",children:[(0,a.jsx)(r.xu,{as:p.ZTc,position:"absolute",mb:"25px",size:"10px"}),(0,a.jsx)(r.xu,{as:p.NWQ,position:"absolute",mt:"25px",size:"10px"})]})]})}):(0,a.jsx)("div",{ref:o.innerRef,...o.draggableProps,...o.dragHandleProps,style:{display:"none"}})}},e.id))),e.placeholder]})})}):(0,a.jsx)(m.Z,{message:"Loading template assets...",minH:"100px"})}},4623:function(e,t,n){n.d(t,{Z:function(){return N}});var a=n(85893),o=n(56691),r=n(96918),i=n(34292),s=n(71293),l=n(98303),c=n(57747),d=n(48783),u=n(55154),h=n(67294),f=n(79230),p=n(85431),g=n(94713),m=n(23596),x=n(36238),v=n(94345),w=n(80203);const y=(e,t,n)=>new Promise(((a,o)=>{const r=document.createElement("canvas"),i=r.getContext("2d");if(!i)return o(new Error("Canvas not supported"));const s=new Image;s.src=e,s.onload=()=>{r.width=s.width,r.height=s.height,i.drawImage(s,0,0);const e=i.getImageData(0,0,r.width,r.height);t(e,n),i.putImageData(e,0,0),a(r.toDataURL())},s.onerror=o}));var b={Whitescale:{filter:e=>y(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=255,t[n+1]=255,t[n+2]=255}))},Blackscale:{filter:e=>y(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+1]=0,t[n+2]=0}))},Greyscale:{filter:e=>y(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4){const e=(t[n]+t[n+1]+t[n+2])/3;t[n]=e,t[n+1]=e,t[n+2]=e}}))},Redscale:{filter:e=>y(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n+1]=0,t[n+2]=0}))},Greenscale:{filter:e=>y(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+2]=0}))},Bluescale:{filter:e=>y(e,(e=>{const t=e.data;for(let n=0;n<t.length;n+=4)t[n]=0,t[n+1]=0}))},Guassianblur:{filter:(e,t)=>y(e,((e,t)=>{const n=(null===t||void 0===t?void 0:t.radius)&&!isNaN(t.radius)?parseFloat(t.radius):5,a=e.data,o=e.width,r=e.height,i=(e,t)=>4*(t*o+e),s=new Uint8ClampedArray(a);for(let l=0;l<r;l++)for(let e=0;e<o;e++){let t=0,c=0,d=0,u=0,h=0;for(let a=-n;a<=n;a++)for(let f=-n;f<=n;f++){const n=e+f,p=l+a;if(n>=0&&n<o&&p>=0&&p<r){const e=i(n,p);t+=s[e],c+=s[e+1],d+=s[e+2],u+=s[e+3],h++}}const f=i(e,l);a[f]=t/h,a[f+1]=c/h,a[f+2]=d/h,a[f+3]=u/h}})),render:e=>{let{filterArgs:t,setFilterArgs:n}=e;return(0,a.jsx)(c.xu,{children:(0,a.jsx)(x.Z,{w:"100%",id:"filter_arg",title:"Blur radius",mb:4,helperText:"Enter the blur radius.",info:"This is where you enter the blur radius.",type:x.Z.TYPES.text,value:null===t||void 0===t?void 0:t.radius,onChange:e=>{n({...t,radius:(isNaN(e),e)})}},"filter_arg")})}},Rotate:{filter:(e,t)=>new Promise(((t,n)=>{t(e)})),render:null},ImageTransform:{filter:(e,t)=>(0,w.cr)(t,e,5)}},k=n(85461),j=n(53754),S=n(10151),_=n(41160),E=n(93239),T=n(83612);const I=e=>{let{children:t}=e;return(0,a.jsxs)(i.U,{justifyContent:"flex-start",alignItems:"center",m:"0px !important",mb:"1rem !important",children:[(0,a.jsx)(u.gJy,{color:"#e53e3e"}),"\xa0",(0,a.jsx)(s.x,{as:"div",color:"#e53e3e",children:t})]})},C=e=>{const[t,n]=e.split(".");return"".concat(t,".").concat((n||"").split("_")[0].trim()).trim()},O=async(e,t)=>{const n=t[0]?await b[t[0].filter_id].filter(e,t[0].args):e;return t.shift(),0==t.length?n:O(n,t)},P=(e,t,n,a)=>new Promise((async(o,r)=>{try{const r=Object.entries(e).map((async o=>{let[r,i]=o;var s,l,c=C(r);let d;if(["image_upload","sign"].includes(null===(s=n.fields[c])||void 0===s?void 0:s.type)){d=t[c]&&(0,m.zI)(t[c])?t[c]:(0,j.VT)("other_tools_data",t.id,c)}else{const t=(0,m.gJ)(r,e,a?"_".concat(a):null,!0);t&&(d=await(0,p.tY)(t))}const u="image_select"==(null===(l=n.fields[c])||void 0===l?void 0:l.type)?c:r;var h,f;return c.startsWith("Logo.upload"),d&&!(0,j.N4)(d)&&(0,m.zI)(d)&&n.masks&&n.masks[u]&&(console.log("parsedSvg:draggedFm ",u,n.masks[u].filter_id,'FILTERS[templateData.masks[maskId]?.filter_id || ""].filter"',n.masks[u]),d=await(h=d,f=Object.values(n.masks[u]),new Promise((async(e,t)=>{try{e(await O(h,f))}catch(n){t(n)}})))),[r,d]})),i=await Promise.all(r);o(Object.fromEntries(i))}catch(i){r(i)}}));const F=(e,t,n,a,o,r,i,s,l,c)=>{if("image"!=e.children[n].name||(null===a||void 0===a?void 0:a.type)||(e.children[n].attributes["xlink:href"]=(0,m.gJ)(t,o,l?"_".concat(l):null)),"image_select"==(null===a||void 0===a?void 0:a.type)){if(r[a.id]){const i=r[a.id];e.children[n].attributes["xlink:href"]=(0,m.gJ)(i,o,l?"_".concat(l):null),e.children[n].attributes["data-click-field-id"]=a.id,e.children[n].attributes["data-click-element-id"]=t}}else if(["image_upload","sign"].includes(null===a||void 0===a?void 0:a.type))console.log("parsedSvg.image_upload/sign ",t,o),o[t]&&(e.children[n].attributes["xlink:href"]=o[t],e.children[n].attributes["data-click-field-id"]=a.id,e.children[n].attributes["data-click-element-id"]=t);else if("checkbox"==(null===a||void 0===a?void 0:a.type))o[t]&&"image"==e.children[n].name&&(e.children[n].attributes["xlink:href"]=(0,m.gJ)(t,o,l?"_".concat(l):null));else if("qrcode"==(null===a||void 0===a?void 0:a.type))o[t]&&"image"==e.children[n].name&&(e.children[n].attributes["xlink:href"]=(0,m.gJ)(t,o,l?"_".concat(l):null));else if(["text","textarea","defgen"].includes(null===a||void 0===a?void 0:a.type)){for(var d=e.children[n].children[0];d.children&&d.children.length>0;)d,d=d.children[0];r[a.id]&&(d.value=r[a.id])}else if(["gen"].includes(null===a||void 0===a?void 0:a.type)){for(d=e.children[n].children[0];d.children&&d.children.length>0;)d,d=d.children[0];d.value=(0,S.l)(a.code,r,m.oh)}},A={"letter-spacing":e=>{const{value:t,unit:n}=(0,T.Zl)(e);let a;return a="psd"==n?"".concat(parseFloat(t)/1e3,"em"):e,a}},D=e=>{const t={...e};for(const[a,o]of Object.entries(e)){const e=[...o.declarations];for(var n=0;n<e.length;n++){const t=A[o.declarations[n].property];t&&(e[n]={...e[n],value:t(o.declarations[n].value)})}t[a].declarations=e}return t},M=(e,t,n,a,o,r)=>new Promise((async(a,i)=>{P(t.images,e,t,o).then((s=>{(0,f.parse)(t.svg).then((async l=>{const c=Object.keys(t.fields),d=parseInt("".concat(l.attributes.width||0)),u=parseInt("".concat(l.attributes.height||0));for(var h=-1,x=0;x<l.children.length;x++){const n=l.children[x],{name:a,type:i,selectIndex:d,typeAndSelectIndex:u}=(0,g.py)(n.attributes.id),f="".concat(a,".").concat(i);if("defs"==n.name)h=x;else if(c.includes(f)||"image"==n.name){var v=C(n.attributes.id);const a="image_select"==i?v:n.attributes.id;F(l,n.attributes.id,x,t.fields[f],s,e,0,0,o,(r||{})[a]||((null===t||void 0===t?void 0:t.masks)||{})[a])}}if(h>-1){const e=l.children[h];console.info("parsedSvg:defs",e),e.children&&e.children.forEach((e=>{if("style"===e.name&&e.children&&e.children.length>0){const n=e.children[0].value,a=(0,T.sn)(n,((e,n)=>{const a=(e=>{if(!e)return null;const t={...e};return t.if_selector&&(t.if_selector=D(t.if_selector)),t.if_property&&(t.if_property=D(t.if_property)),t.if_property_and_value&&(t.if_property_and_value=D(t.if_property_and_value)),t})(t.cssActions),o=(null===a||void 0===a?void 0:a.if_selector)||{},r=(null===a||void 0===a?void 0:a.if_property)||{},i=(null===a||void 0===a?void 0:a.if_property_and_value)||{};var s=[...n];const l=o["*"],c=o[(0,T.xC)(e)];l&&(s=l.shouldReplace?l.declarations:[...s,...l.declarations]),c&&(s=c.shouldReplace?c.declarations:[...s,...c.declarations]);for(var d=0;d<n.length;d++){const e=n[d],t=r["*"],a=r[(0,T.xC)(e.property)],o=i["*"],l=i[(0,T.xC)(e.property,e.value)];t&&(s=t.shouldReplace?t.declarations:[...s,...t.declarations]),a&&(s=a.shouldReplace?a.declarations:[...s,...a.declarations]),o&&(s=o.shouldReplace?o.declarations:[...s,...o.declarations]),l&&(s=l.shouldReplace?l.declarations:[...s,...l.declarations])}return s}));e.children[0].value=a}}));const a=[];if(a.push({name:"style",type:"element",value:"",attributes:{},children:[{name:"",type:"text",value:"#softbaker-slider-handle, #softbaker-button-background, #softbaker-button-text, #softbaker-slider-track { cursor: pointer !important;}",attributes:{},children:[]}]}),l.children[h].children=a.concat(l.children[h].children),n){const e=[];for(const t of Object.values(n))t.dataUrl&&t.ext&&e.push({name:"style",type:"element",value:"",attributes:{},children:[{name:"",type:"text",value:'\n      @font-face {\n        font-family: "'.concat(t.name,'";\n        src: url(').concat(t.dataUrl,") format(").concat((0,E.bX)(t.ext),");\n      }"),attributes:{},children:[]}]});e.length>0&&(l.children[h].children=e.concat(l.children[h].children))}}e.is_freemium?(0,p.wL)("/res/watermark.png",d,u,.5).then((e=>{l.children.push({name:"image",type:"element",value:"",attributes:{id:"watermark-"+(0,m.Bu)(8),width:d+"",height:u+"","xlink:href":e},children:[]}),a((0,f.stringify)(l))})).catch((e=>{i(e)})):a((0,f.stringify)(l))})).catch((e=>{i(e)}))})).catch((e=>{i(e)}))})),Z=e=>{let{fonts:t,isLoading:n,data:s,templateData:u,showWatermark:f,width:p,onFiltersUpdated:g,filterEnabled:m}=e;const w=(0,h.useRef)(null),y=(0,l.S)(p||{base:0}),[j,S]=(0,h.useState)(),[E,T]=(0,h.useState)(),[C,O]=(0,h.useState)(),[P,F]=(0,h.useState)(null);(0,h.useEffect)((()=>{}),[j]),(0,h.useEffect)((()=>{s&&u&&(T(!0),O(void 0),M(s,u,t,0,y,P).then((e=>{T(!1),S(e)})).catch((e=>{T(!1),O(e.message)})))}),[s,u,f,y,P,t]);const[A,D]=(0,h.useState)(),[Z,N]=(0,h.useState)(),[R,z]=(0,h.useState)(),[L,U]=(0,h.useState)(),[Y,B]=(0,h.useState)(),J=e=>{N(null),D(null),U(null),B(null),z(null)},W=e=>{const t=e.target;if(t)if(t.hasAttribute("data-click-element-id")&&!P){((e,t,n)=>{m&&(D(t),N(e),z(n),e&&(null===u||void 0===u?void 0:u.masks)&&(null===u||void 0===u?void 0:u.masks[e])&&B(u.masks[e].args))})(t.getAttribute("data-click-element-id"),t.getAttribute("data-click-field-id"),t.getAttribute("xlink:href"))}else if(["softbaker-button-background","softbaker-button-text"].includes(t.getAttribute("id"))&&g&&P){const e=document.querySelector("[data-svg-id='".concat(Object.keys(P)[0],"']"));if(!e)return;const t=e.getAttribute("data-degree");var n,a,o;if(void 0!=t){const e=parseFloat(t);null===u||void 0===u||u.masks,Object.keys(P)[0],null===(n=Object.values(P)[0])||void 0===n||n.filter_id,(null===(a=Object.values(P)[0])||void 0===a?void 0:a.args)&&(null===(o=Object.values(P)[0])||void 0===o||o.args)}F(null)}},H=e=>{const t=e.target;"softbaker-slider-handle"===t.getAttribute("id")&&t.setAttribute("data-rotating","1")},V=()=>{const e=document.getElementById("softbaker-slider-handle");e&&e.setAttribute("data-rotating","0")},X=e=>{const t=document.getElementById("softbaker-slider-track");if(t&&P&&"softbaker-slider-handle"===e.target.getAttribute("id")){if(!("1"===e.target.getAttribute("data-rotating")))return;const n=t.getBoundingClientRect(),a=t.getBBox(),o=Math.min(Math.max(e.clientX-n.left,0),n.width);e.target.setAttribute("cx","".concat(a.x+o));const r=o/n.width*360;if(Object.keys(P)[0]){const e=document.querySelector("[data-svg-id='".concat(Object.keys(P)[0],"']"));if(!e)return;const t=function(e,t,n,a,o){const r=t+a/2,i=n+o/2;return"rotate(".concat(e," ").concat(r," ").concat(i,")")}(r,parseFloat(e.getAttribute("x")||0),parseFloat(e.getAttribute("y")||0),parseFloat(e.getAttribute("width")||0),parseFloat(e.getAttribute("height")||0));e.setAttribute("transform",t),e.setAttribute("data-degree","".concat(r))}}};return(0,h.useEffect)((()=>{const e=w.current;return e&&(e.addEventListener("click",W),e.addEventListener("mousedown",H),e.addEventListener("mouseup",V),e.addEventListener("mousemove",X)),()=>{e&&(e.removeEventListener("click",W),e.removeEventListener("mousedown",H),e.removeEventListener("mouseup",V),e.removeEventListener("mousemove",X))}}),[j,u,s,P,m]),(0,a.jsx)(_.Z,{disableDrag:null!=P,width:"100%",message:"Drag around to view the whole tool",height:{base:500,md:728,lg:1024},children:(0,a.jsxs)(c.xu,{id:"AirlineDocWrapper",pos:"relative",w:"100%",children:[j?(0,a.jsx)(c.xu,{ref:w,w:"100%",h:"100%",dangerouslySetInnerHTML:{__html:j}}):null,P?null:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.U,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"1",bg:"#dfdfdf",opacity:"0.7",justifyContent:"flex-start",pl:{base:"0px",md:"0px"},alignItems:"center",display:E||n?"flex":"none",w:"100%",h:"100%",children:(0,a.jsx)(o.Z,{type:o.Z.TYPES.grid,color:(0,r.Z)("colorAccent.light","colorAccent.dark"),size:"70px"})}),(0,a.jsx)(d.g,{pos:"absolute",top:"0",left:"0",right:"0",bottom:"0",zIndex:"1",bg:"#fff",opacity:"0.7",justifyContent:"center",pl:"1rem",alignItems:"flex-start",display:C?"flex":"none",w:"100%",h:"100%",children:C?(0,a.jsx)(I,{children:(q=C,(null===q||void 0===q?void 0:q.message)?q.message:q)}):null})]}),Z&&g?(0,a.jsxs)(v.Z,{title:"".concat(Z||""," filter"),isOpen:!0,onClose:()=>{J()},dontCloseOnOverlayClick:!0,children:[(0,a.jsx)(x.Z,{w:"100%",mb:4,id:"filter",title:"Select Filter",helperText:"Select a filter you want applied on the user's image choice.",info:"This is the status you select a filter to apply to the user's image choice.",type:x.Z.TYPES.select,value:L||"",options:["none",...Object.keys(b)],onOptionValue:e=>e,onOptionName:e=>"none"===e?"--No Filter--":e,onChange:e=>{"none"===e?(U(null),B(null)):"Rotate"===e?J():(U(e),B(null))}},"filter"),L&&b[L].render?b[L].render({filterArgs:Y,setFilterArgs:B,filterImage:R}):null,(0,a.jsx)(c.xu,{mb:"1rem",children:(0,a.jsx)(k.Z,{status:"warning",mb:"1rem",onClick:()=>{if("Rotate"===L)J();else{const e={...(null===u||void 0===u?void 0:u.masks)||{},[Z]:{...((null===u||void 0===u?void 0:u.masks)||{})[Z]||{},...L?{["".concat(L)]:{filter_id:L,args:Y}}:null}};g(e)}J()},children:"Rotate"===L?"Configure Filter":"Apply Filter"})})]}):null]})});var q};Z.getSvg=M;var N=Z},83612:function(e,t,n){n.d(t,{Zl:function(){return o},sn:function(){return r},xC:function(){return a}});const a=(e,t)=>"".concat(e.replace(/\s/g,"")).concat(t?":".concat(t.replace(/\s/g,"")):"");function o(e){const t=e.match(/^([-+]?\d*\.?\d+)([a-zA-Z]+)$/);if(t)return{value:t[1],unit:t[2]};throw new Error("Invalid input format: ".concat(e))}function r(e,t){const n={},a=/([^{]+)\{([^}]+)\}/g;let o;for(;null!==(o=a.exec(e));){const e=o[1].trim(),t=o[2].trim().split(";").filter(Boolean).map((e=>{const[t,n]=e.split(":").map((e=>e.trim()));return{property:t,value:n}}));n[e]=t}Object.keys(n).forEach((e=>{const a=n[e],o=t(e,a);n[e]=o}));let r="";return Object.keys(n).forEach((e=>{const t=n[e].map((e=>{let{property:t,value:n}=e;return"".concat(t,": ").concat(n,";")})).join(" ");r+="".concat(e," { ").concat(t," }\n")})),r}},93239:function(e,t,n){n.d(t,{Xx:function(){return c},YW:function(){return u},bX:function(){return d},fY:function(){return i}});var a=n(79230);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;return e.attributes&&e.attributes["font-family"]&&t.add(e.attributes["font-family"]),"defs"===e.name&&e.children&&e.children.forEach((e=>{if("style"===e.name&&e.children&&e.children.length>0){r(e.children[0].value,t)}})),e.children&&e.children.length>0&&e.children.forEach((e=>o(e,t))),t}function r(e,t){const n=/font-family:\s*([^;]+);/g;let a;for(;null!==(a=n.exec(e));)t.add(a[1].trim())}function i(e){return(0,a.parse)(e).then((e=>{const t=o(e);return Array.from(t)}))}async function s(e){try{const t=await fetch(e);if(!t.ok)throw new Error("HTTP status ".concat(t.status));const n=await t.blob();return new Promise(((e,t)=>{const a=new FileReader;a.onloadend=()=>e(a.result),a.onerror=t,a.readAsDataURL(n)}))}catch(t){throw new Error("Failed to fetch font data from ".concat(e,": ").concat(t.message))}}function l(e){let t=e.toLowerCase();return t=t.replace(/["']/,""),t=t.replace(/[\s]+/g,"-"),t=t.replace(/[^a-z0-9-]+/g,""),t=t.replace(/-+/g,"-"),t=t.replace(/^-|-$/g,""),t}async function c(e,t){const n={};for(const o of e){const e={name:o,id:l(o)};let r=!1;for(const n of t){const t="https://r2.softbaker.com/fonts/".concat(e.id,".").concat(n);try{const n=await s(t);e.url=t,e.dataUrl=n,r=!0;break}catch(a){e.readError=a.message}}r||(e.readError="No valid font found for ".concat(o," with extensions: ").concat(t.join(", "))),n[e.id]=e}return n}function d(e){return{ttf:"truetype",otf:"opentype",woff:"woff",woff2:"woff2",eot:"embedded-opentype",svg:"svg"}[e.toLowerCase()]||"unknown"}function u(e,t){return{ttf:"font/ttf",otf:"font/otf",woff:"font/woff",woff2:"font/woff2",eot:"font/eot",svg:"svg"}[t.toLowerCase()]?new Promise(((t,n)=>{new FontFace("CustomFont","url(".concat(e,")")).load().then((e=>{document.fonts.add(e);const n=document.createElement("canvas");n.width=100,n.height=100;const a=n.getContext("2d");if(!a)return;a.clearRect(0,0,n.width,n.height),a.fillStyle="#FFFFFF",a.fillRect(0,0,n.width,n.height),a.fillStyle="#000000",a.font="50px CustomFont",a.textAlign="center",a.textBaseline="middle",a.fillText("Aa",n.width/2,n.height/2);const o=n.toDataURL("image/png");t(o)})).catch((e=>{n(e)}))})):Promise.reject(new Error("Unsupported font format"))}},3683:function(e,t,n){var a=n(67294),o=n(5121),r=n(23596),i=n(94713),s=n(53754),l=n(96331);t.Z=(e,t)=>{const{user:n}=(0,l.P)(),[c,d]=(0,a.useState)(),[u,h]=(0,a.useState)(),[f,p]=(0,a.useState)({}),[g,m]=(0,a.useState)(!1),[x,v]=(0,a.useState)(!1),[w,y]=(0,a.useState)(!1),[b,k]=(0,a.useState)(),[j,S]=(0,a.useState)(),[_,E]=(0,a.useState)(),[T,I]=(0,a.useState)(),[C,O]=(0,a.useState)(),[P,F]=(0,a.useState)();(0,a.useEffect)((()=>{}),[P]);const A=e=>{if(!e)return null;var t=e.split("-")[1];return t?t.split(".")[0].trim():null},D=e=>{if(1==Object.keys(e).length)return Object.keys(e)[0];for(const t of Object.values(e))if(t.is_default)return t.id;return Object.keys(e)[0]};(0,a.useEffect)((()=>{const t=A(e);e&&e!=c&&t?(d(e),m(!0),k(null),o.Z.get(e).then((e=>{h(t),p((0,r.Dn)(e.data)),m(!1)})).catch((e=>{k(e.message),m(!1)}))):e||(d(null),m(!1),k(null),h(null),p({}),E(null),I(null),O(null),F(null))}),[e]),(0,a.useEffect)((()=>{!t&&f&&Object.keys(f).length>0&&!_&&M(D(f))}),[f]);const M=e=>{const t=f[e];t&&!(0,s.N4)(t.data_url)&&(v(!0),S(null),o.Z.get(t.data_url).then((e=>{O({...t}),F({...e.data}),E({...t}),I({...e.data}),v(!1)})).catch((e=>{S(e.message),v(!1)})))},Z=(e,t)=>{O(e),F(t)};return{templatesLoading:g,templatesError:b,selectedTemplateLoading:x,selectedTemplateError:j,parsingTemplate:w,templates:f,selectedTemplate:_,selectedTemplateData:T,workingTemplate:C,workingTemplateData:P,setAsDefaulTemplate:e=>{if(C&&(O({...C,is_default:e}),e&&Object.keys(f).length>1)){for(const e of Object.keys(f))e!=C.id&&(f[e].is_default=!1);p(f)}},setWorkingTemplate:O,setWorkingTemplateData:F,selectTemplate:M,parseTemplateSvg:(e,t)=>(y(!0),new Promise(((n,a)=>{(0,i.xz)(e).then((e=>{if(console.log("parsedSvg:result.ok!!!: ",e),e){var o=_,i=T;t&&(o=null,i=null),(0,r.s7)(e,i).then((e=>{const t={id:(null===o||void 0===o?void 0:o.id)||(0,r.Bu)(8),name:(null===o||void 0===o?void 0:o.name)||"",logo:(null===o||void 0===o?void 0:o.logo)||"",data_url:(null===o||void 0===o?void 0:o.data_url)||"",is_default:(null===o||void 0===o?void 0:o.is_default)||!1};O(t),F(e),y(!1),n({template:t,templateData:e})})).catch((e=>{y(!1),a(e)}))}else y(!1),n(null)})).catch((e=>{y(!1),a(e)}))}))),saveTemplate:e=>new Promise(((t,a)=>n?C&&P?void(0,r.t9)(n,u||(0,r.Bu)(8),f,C,P,_,T,c,Z,e).then((e=>{if(e){d(e);const t=A(e);h(t),p({...f,[C.id]:C}),E(C),I(P),O(C),F(P)}t(e)})).catch(a):a(new Error("No template provided yet.")):a(new Error("Please sign in")))),deleteTemplate:e=>{Object.keys(f).includes(e)||(null===C||void 0===C?void 0:C.id)!=e||M(D(f))},getDefaultTemplateId:D}}},85431:function(e,t,n){n.d(t,{_P:function(){return s},pu:function(){return r},sH:function(){return l},tY:function(){return o},wL:function(){return c},zD:function(){return i}});var a=n(23596);const o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((async(n,o)=>{if(!(0,a.Ri)(e))return n(e);try{const t=await fetch(e),a=await t.blob(),r=new FileReader;r.onloadend=()=>{n(r.result)},r.onerror=o,r.readAsDataURL(a)}catch(r){if(console.info("parsedSvg:masks.fe",r.message),t)return n(null);o(r)}}))};function r(e,t){return console.info("parsedSvg:base64A: ",e.substring(0,32)),console.info("parsedSvg:base64B: ",t.substring(0,32)),e===t.split(",")[1]}function i(e){return function(e,t){try{const n=new URL(e);return n.searchParams.delete(t),n.toString()}catch(n){return console.error("Invalid URL:",n),e}}(e,"updates")}function s(e){const t=new URL(e),n=t.searchParams.get("updates"),a="".concat(n?parseInt(n,10)+1:1);return t.searchParams.set("updates",a),t.toString()}function l(e,t){return new Promise((async(n,a)=>{try{for(const n in e)if(e.hasOwnProperty(n)&&t.hasOwnProperty(n)){const a=e[n],i=t[n];if(a.startsWith("http")&&i.startsWith("data:image")){const e=await o(a,!0);e&&r(e,i)&&(t[n]=a)}}n(t)}catch(i){a(i)}}))}function c(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new Promise(((o,r)=>{const i=new Image;i.onload=()=>{const e=document.createElement("canvas"),s=e.getContext("2d");if(!s)return r("No canvas context");e.width=t,e.height=n,s.globalAlpha=a;for(let a=0;a<n;a+=i.height)for(let e=0;e<t;e+=i.width)s.drawImage(i,e,a,i.width,i.height);o(e.toDataURL())},i.onerror=r,i.src=e}))}},94713:function(e,t,n){n.d(t,{xz:function(){return h},mA:function(){return d},py:function(){return c}});var a=n(79230),o=n(23596);async function r(e,t){return new Promise(((n,a)=>{const o=new Image;o.onload=()=>{const e=o.width/o.height,r=t/e,i=document.createElement("canvas");i.width=t,i.height=r;const s=i.getContext("2d");if(s){s.drawImage(o,0,0,t,r);const e=i.toDataURL("image/png");n(e)}else a(new Error("Failed to get canvas context"))},o.onerror=e=>{a(new Error("Failed to load image: ".concat(e)))},o.src=e}))}var i=n(53754),s=n(80203);const l=e=>e.replace(/_/g," ").split("@")[0],c=e=>{const[t,n]=e.split(".");if(!n)return{name:t};const[a,o]=n.split("_");return{name:t,type:a,selectIndex:o,typeAndSelectIndex:n}},d=e=>{const[t,n]=e.split("@");return{name:t,directive:n}},u=(e,t,n)=>{const a=n.name,{name:r,type:s,selectIndex:d,typeAndSelectIndex:u}=c(t);if(!u||!s)return{field:null,updatedFields:e};const h={};switch(s){case"select":var f;h.id="".concat(r,".").concat(s),h.name=l(r),h.type="".concat(a,"_").concat(s);const c={name:"".concat(l(r)," ").concat(d),id:t,index:d||0,type:a};h.options=(0,o.VS)({...(null===(f=e[h.id])||void 0===f?void 0:f.options)||{},[c.id]:c});break;case"upload":h.id="".concat(r,".").concat(s),h.name=l(r),h.type="".concat(a,"_").concat(s);break;case"text":case"textarea":case"gen":case"defgen":h.id="".concat(r,".").concat(s),h.name=l(r),h.type=s,h.placeholder=(e=>{for(var t=e.children[0];t.children&&t.children.length>0;)t=t.children[0];const n=t.value;return(0,i.N4)(n)?null:n})(n)||h.name;break;default:h.id="".concat(r,".").concat(s),h.name=l(r),h.type=s}return Object.keys(h).length>0&&(e[h.id]=h),{field:h,updatedFields:e}},h=e=>new Promise((async(t,n)=>{try{e?(0,a.parse)((0,o.rY)(e)).then((async e=>{const i={};var l=[],h=[];const f=[];var p={};const g=[],m=[],x={};var v,w;const y=[];for(const t of e.children){const e=(t.attributes["data-name"]||t.attributes.id||(0,o.Bu)(8)).replace(/^_+|_+$/g,"");t.attributes.id=e;const{field:n,updatedFields:a}=u(p,e,t);if(p=a,"image"==t.name){if((null===n||void 0===n?void 0:n.type)&&["image_upload","sign"].includes((null===n||void 0===n?void 0:n.type)||""))y.push(new Promise((async(n,a)=>{const o=await(0,s.qM)(t.attributes["xlink:href"]),r=await(0,s.RA)(o);n({imageId:e,filterId:"ImageTransform",mask:{filter_id:"ImageTransform",args:r}})}))),i[e]="";else if(l.includes(t.attributes["xlink:href"])){const n=l.indexOf(t.attributes["xlink:href"]);i[e]=h[n]}else i[e]=t.attributes["xlink:href"],l.push(t.attributes["xlink:href"]),h.push(e);t.attributes["xlink:href"]="",n&&"image_select"==n.type&&f.push(e)}if(n)if("image_select"==(null===n||void 0===n?void 0:n.type))t.attributes.id=n.id,m.includes(n.type)||(g.push(t),m.push(n.type));else{const{name:a}=c(e),{directive:o}=d(a);o&&"name"==o?v=e:o&&"desc"==o&&(w=e),g.push(t),m.push(n.type)}else g.push(t)}if(y.length>0&&Promise.all(y).then((e=>{for(const t of e)x[t.imageId]={[t.filterId]:t.mask}})).catch((e=>n(e))),!v||!w){let e;return e=v||w?v?"Make sure that at least @desc is declared on a text field. @small is optional.":"Make sure that at least @name is declared on a text field. @small is optional.":"Make sure that at least @name and @desc is declared on some text fields. @small is optional.",n(new Error(e))}l=[],h=[],e.children=g;const b=await(0,o.WN)(i,(async(e,t)=>{const{width:n}=await(a=t,new Promise(((e,t)=>{const n=new Image;n.onload=()=>{e({width:n.width,height:n.height})},n.onerror=e=>{t(new Error("Failed to load image: ".concat(e)))},n.src=a})));var a,o={};return o={["".concat(e)]:t},n>=728&&(o={...o,["".concat(e)]:t,["".concat(e,"_512")]:await r(t,512)}),n>=1024&&(o={...o,["".concat(e)]:t,["".concat(e,"_728")]:await r(t,728)}),n>=2047&&(o={...o,["".concat(e)]:t,["".concat(e,"_1024")]:await r(t,1024)}),f.includes(e)&&(o["".concat(e,"_thumbnail")]=await r(t,70)),Object.keys(o).length>0?o:null}));console.log("buildTemplateDataFromSvg2:expandedImages ",b),t({svg:(0,a.stringify)(e),fields:p,images:b,masks:x,cssActions:{if_selector:{"*":{declarations:[{property:"white-space",value:"pre"}]}}}})})).catch((e=>{n(e)})):t(null)}catch(i){n(i)}}))},23596:function(e,t,n){n.d(t,{Bu:function(){return c},Dn:function(){return p},Ri:function(){return x},VS:function(){return f},WN:function(){return d},gJ:function(){return w},oh:function(){return k},rY:function(){return l},s7:function(){return m},t9:function(){return b},zI:function(){return v}});var a=n(25723),o=n(53754),r=n(85431),i=n(94713),s=n(21876).Buffer;function l(e){const t="data:image/svg+xml;base64,";e.startsWith(t)&&(e=e.slice(t.length));const n=function(e){if("undefined"!==typeof s)return s.from(e,"base64").toString("binary");if("function"===typeof window.atob)return window.atob(e);throw new Error("Base64 decoding not supported in this environment")}(e),a=new Array(n.length);for(let r=0;r<n.length;r++)a[r]=n.charCodeAt(r);const o=new Uint8Array(a);return new TextDecoder("utf-8").decode(o)}function c(e){const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let a=0;a<e;a++){const e=Math.floor(Math.random()*t.length);n+=t.charAt(e)}return n}function d(e,t){return new Promise((async(n,a)=>{try{const a={...e};for(const[n,o]of Object.entries(e))if(o&&v(o)){const e=await t(n,o);e&&Object.assign(a,e)}n(a)}catch(o){a(o)}}))}function u(e,t){const[n,a]=t.split(","),o=n.match(/data:(.*?);base64/);if(!o)throw new Error("Invalid base64 data format");const r=o[1],i=atob(a),s=i.length,l=new Uint8Array(s);for(let u=0;u<s;u++)l[u]=i.charCodeAt(u);const c=new Blob([l],{type:r}),d="".concat(e,".").concat(r.split("/")[1]);return{id:e,image:new File([c],d,{type:r})}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data.json";const n=JSON.stringify(e,null,2),a=new Blob([n],{type:"application/json"}),o=new File([a],t,{type:"application/json"});return o}function f(e){const t=Object.entries(e);t.sort(((e,t)=>{let[,n]=e,[,a]=t;const o=(n.index||"").toString(),r=(a.index||"").toString();return o.localeCompare(r)}));const n={};for(const[a,o]of t)n[a]=o;return n}const p=e=>{const t=Object.entries(e);t.sort(((e,t)=>{const n=e[1].name.toUpperCase(),a=t[1].name.toUpperCase();return n<a?-1:n>a?1:0}));const n={};return t.forEach((e=>{let[t,a]=e;n[t]=a})),n};function g(e,t){return x(e)&&(0,r.zD)(e).toLowerCase()===(0,r.zD)(t).toLowerCase()}const m=(e,t)=>new Promise((async(n,a)=>{if(!t)return n(e);const o={};o.svg=e.svg;const i=[];for(const[r,s]of Object.entries(t.fields)){const t=e.fields[r];if(t){if(t.type!=s.type)i.push("The ".concat(s.type.split("_").join(" "),' field, "').concat(s.name,'" is misrepresented as "').concat(t.type.split("_").join(" "),'" in the new template.'));else if(s.options&&!(null===t||void 0===t?void 0:t.options))i.push("The ".concat(s.type.split("_").join(" "),' field, "').concat(s.name,'" is missing options in the new template.'));else if(s.options&&t.options)for(const e of Object.values(s.options))t.options[e.id]?t.options[e.id].type!=e.type&&i.push("The ".concat(s.type.split("_").join(" ")," ").concat(s.name,' option, "').concat(e.name,'" is misrepresented as "').concat(t.options[e.id].type.split("_").join(" "),'" in the new template.')):i.push("The ".concat(s.type.split("_").join(" ")," ").concat(s.name,' option, "').concat(e.name,'" is missing in the new template.'))}else i.push("The ".concat(s.type.split("_").join(" "),' field, "').concat(s.name,'" is missing in the new template.'))}if(Object.keys(t.images||{}).length>0&&0==Object.keys(e.images||{}).length)i.push("Images are missing in missing in the new template.");else if(Object.keys(t.images||{}).length>0)for(const r of Object.keys(t.images))e.images[r]||r.includes(".select")||i.push("The image with the id, ".concat(r," is missing in the new template."));o.fields={...t.fields,...e.fields};for(const[e,t]of Object.entries(o.fields))t.options&&(o.fields[e].options=f(t.options));if(o.images=await(0,r.sH)(t.images,{...t.images,...e.images}),i.length>0)return a(new Error(i.join("\n")));n(o)})),x=e=>e.startsWith("http"),v=e=>e.startsWith("data:image")||e.startsWith("data:img"),w=(e,t,n,a)=>{console.log("parsedSvg.geImage: ",e,t,n);var o=t[e];return!o||x(o)||v(o)?o&&(o=t["".concat(e).concat(n||"")]):o=t["".concat(t[e]).concat(n||"")],o||!n||a||(o=t[e]),o},y=async(e,t,n,r,i)=>{const s=await(0,a.dq)(e,t,"https://r2.softbaker.com/"),l=[...n],c=[],d=[],u=[];return s.forEach((e=>{(0,o.N4)(e.error)?(l.push(e),c.push(e.id)):(i&&i("Failed to upload file with error, ".concat(e.error||"",". Would be retried later."),e.id,!0),d.push(e))})),t.forEach((e=>{c.includes(e.id)||u.push(e)})),u.length>0?r?(i&&i("Faied files upload retry stopped for ".concat(u.length," files.")),[...l,...d]):(i&&i("Sleeping for 5 seconds to retry ".concat(u.length," failed file uploads. Make sure you're connected to the internet....")),await(0,a._v)(5e3),i&&i("Resuming program to retry the ".concat(u.length," failed file uploads. Make sure you're connected to the internet...")),y(e,u,l,u.length==t.length,i)):l},b=(e,t,n,i,s,l,c,d,f,p)=>{const m=(e,t)=>{p&&p(e,t)},b=e=>{m(e,0)};return new Promise((async(p,k)=>{try{m("Template assets upload started..."),console.log("uploadTemplates: ",s);const I=[];if(i.id||I.push("ID is missing in the template"),i.name||I.push("Please provide the template's name"),i.logo||I.push("Please provide the template's logo"),I.length>0)return k(new Error(I.join("\n")));const C=i.id;if((null===l||void 0===l?void 0:l.logo)&&x(l.logo)&&v(i.logo)){const e=l.logo,t=await(0,r.tY)(e,!0);t&&(0,r.pu)(t,i.logo)&&(i.logo=l.logo)}m("Stacking template images and logo to upload...");const O=[];for(const[e,n]of Object.entries(s.images))if(v(n)){const{image:o}=u(e,n);O.push({id:e,file:o,fileName:"templates-".concat(t,"-").concat(C,"-").concat(e,"-image.").concat((0,a.tD)(o.name).ext),dir:"templates"})}const P="templates-".concat(t,"-").concat(C,"-logo");if(v(i.logo)){const e=u(P,i.logo);O.push({id:P,file:e.image,fileName:"".concat(P,".").concat((0,a.tD)(e.image.name).ext),dir:"templates"})}m("Uploading template images and logo...");const F=await y(e,O,[],!1,b);console.log("parsedSvg:imagesUploadResults",F,O);const A={};var j=null,S=null;m("Linking template images IDs and logo to the uploaded images..."),F.forEach((e=>{(0,o.N4)(e.error)?e.id!=P?A[e.id]=e.url:j=e.url:(S=new Error(e.error),m('The image, "'.concat(e.id,"\" failed to upload. Please make sure you're connected to the internet.")))}));for(const[e,t]of Object.entries(A))c&&w(e,c.images)&&g(w(e,c.images),t)?s.images[e]=(0,r._P)(w(e,c.images)):s.images[e]=t;if(j&&((null===l||void 0===l?void 0:l.logo)&&g(l.logo,j)?i.logo=(0,r._P)(l.logo):i.logo=j),f&&f(i,s),S)return k(S);var _=null;if(m("Checking if any changes need to be written to the template data file..."),s.svg!=(null===c||void 0===c?void 0:c.svg)||JSON.stringify(s.fields||{})!=JSON.stringify((null===c||void 0===c?void 0:c.fields)||{})||JSON.stringify(s.images||{})!=JSON.stringify((null===c||void 0===c?void 0:c.images)||{})||JSON.stringify(s.masks||{})!=JSON.stringify((null===c||void 0===c?void 0:c.masks)||{})||JSON.stringify(s.cssActions||{})!=JSON.stringify((null===c||void 0===c?void 0:c.cssActions)||{})){m("Uploading the template data file with the changes made...");const n=h(s),r="templates-".concat(t,"-").concat(C,"-data");if(_=await y(e,[{id:r,file:n,fileName:"".concat(r,".").concat((0,a.tD)(n.name).ext),dir:"templates"}],[],!1,b),console.log("parsedSvg:uploadedData",_),!(0,o.N4)(_[0].error))return k(new Error(_[0].error))}var E=null;if(i.name!==(null===l||void 0===l?void 0:l.name)||i.logo!==(null===l||void 0===l?void 0:l.logo)||i.is_default!==(null===l||void 0===l?void 0:l.is_default)||_){_&&((null===l||void 0===l?void 0:l.data_url)&&g(l.data_url,_[0].url)?i.data_url=(0,r._P)(l.data_url):i.data_url=_[0].url,f&&f(i,s)),m("Updating the the tool's template list data file with the new template's data...");const c=h({...n,[C]:i}),d="templates-".concat(t);if(E=await y(e,[{id:d,file:c,fileName:"".concat(d,".").concat((0,a.tD)(c.name).ext),dir:"templates"}],[],!1,b),console.log("parsedSvg:uploadedTemplates",E[0].url,E),!(0,o.N4)(E[0].error))return k(new Error(E[0].error))}var T=E?E[0].url:null;d&&T&&g(d,T)?(T=(0,r._P)(d),m("Template updated with no error \u2714\u2714")):m(d?"No changes found in the template.":"Template created with no error \u2714\u2714"),p(T)}catch(I){k(I)}}))},k=e=>{const{type:t}=(0,i.py)(e);return!(!t||!["text","textarea"].includes(t))}},75863:function(e,t,n){var a=n(85893),o=n(51857),r=n.n(o),i=n(34292),s=n(57747),l=n(71293),c=n(85970),d=n(5418),u=n(6089),h=n(67294),f=n(94345),p=n(53754),g=n(49626);const m=e=>{let{id:t,link:n,downloadImage:o,title:r,image:c,thumbnail:d,...u}=e;return(0,a.jsxs)(i.U,{cursor:"pointer",justifyContent:"flex-start",alignItems:"flex-end",mb:4,...u,children:[(0,a.jsx)(s.xu,{as:"image",w:"40px",h:"40px",backgroundColor:"#dfdfdf",style:{backgroundImage:"url(".concat(d,")")},backgroundRepeat:"no-repeat",backgroundSize:"cover"}),(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:r})]})};t.Z=e=>{let{title:t,helperText:n,info:o,textTransform:x,labelEndIcon:v,image:w,thumbnail:y,imageTitle:b,options:k,onChange:j,disabled:S,..._}=e;const[E,T]=(0,h.useState)(!1);return(0,a.jsxs)(s.xu,{..._,children:[(0,a.jsxs)(c.NI,{opacity:S?.4:1,cursor:S?"not-allowed":"pointer",children:[(0,a.jsxs)(i.U,{w:"100%",justifyContent:"space-between",alignItems:"center",children:[!t||(0,p.N4)(o)||S?(0,a.jsx)(d.l,{textTransform:x||"capitalize",mb:"0px",children:t}):(0,a.jsx)(g.Z,{as:d.l,info:o,textTransform:x||"capitalize",children:t}),v||null]}),(0,a.jsxs)(i.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),S||T(!0)},children:[(0,a.jsx)(s.xu,{width:"auto",height:"40px",bg:"#dfdfdf",children:y?(0,a.jsx)(u.E,{src:y,width:"auto",h:"40px",objectFit:"cover"}):null}),(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:b})]}),(0,p.N4)(n)||S?null:(0,a.jsx)(c.Q6,{children:n})]}),(0,a.jsx)(f.Z,{title:t,isOpen:E,onClose:()=>{T(!1)},overflowY:"auto",children:(k||[]).map(((e,t)=>(0,a.jsx)(m,{...e,onClick:()=>{j(e),T(!1)}},t)))}),(0,a.jsx)(r(),{id:"95178590041dfe1a",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})}},62122:function(e,t,n){var a=n(85893),o=n(51857),r=n.n(o),i=n(34292),s=n(6089),l=n(71293),c=n(57747),d=n(85970),u=n(49626),h=n(36238),f=n(67294),p=n(94345),g=n(98687),m=n(55154);const x=e=>{let{id:t,name:n,logo:o,onDelete:r,...d}=e;return(0,a.jsxs)(i.U,{cursor:"pointer",justifyContent:"space-between",alignItems:"flex-end",mb:1,mx:"0.5rem",...d,children:[(0,a.jsxs)(i.U,{justifyContent:"flex-start",alignItems:"flex-end",children:[(0,a.jsx)(s.E,{src:o||"/res/svg-icon.png",w:"35px",h:"35px",borderRadius:"5px",border:"1px solid #dfdfdf"}),(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:n||"No name yet"})]}),r?(0,a.jsx)(c.xu,{p:"0.5rem",onClick:()=>{r(t)},children:(0,a.jsx)(m.Xm5,{color:"#e53e3e"})}):null]})};t.Z=e=>{let{id:t,title:n,templates:o,createdTemplatesKeys:m,value:v,onChange:w,onNewTemplateSvgUploaded:y,disabled:b,errorMessage:k,info:j,helperText:S,onDelete:_,contactLink:E,...T}=e;const[I,C]=(0,f.useState)(!1),[O,P]=(0,f.useState)(),[F,A]=(0,f.useState)([]);return(0,f.useEffect)((()=>{v&&P(v)}),[v]),(0,a.jsxs)(c.xu,{...T,children:[(0,a.jsxs)(d.NI,{opacity:b?.4:1,cursor:b?"not-allowed":"pointer",children:[(0,a.jsx)(u.Z,{textTransform:"capitalize",info:j,children:n}),(0,a.jsxs)(i.U,{className:"image-selector-button",onClick:e=>{e.preventDefault(),b||C(!0)},children:[O?(0,a.jsx)(s.E,{src:O.logo||"/res/svg-icon.png",w:"35px",h:"35px",borderRadius:"5px",border:"1px solid #dfdfdf"}):null,(0,a.jsx)(l.x,{as:"div",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:O?O.name||"No name yet":"Select Template"})]})]}),(0,a.jsx)(h.Z,{type:h.Z.TYPES.none,helperText:S,errorMessage:k}),I?(0,a.jsxs)(p.Z,{title:n,isOpen:!0,onClose:()=>{C(!1)},children:[y?(0,a.jsx)(i.U,{children:(0,a.jsx)(g.Z,{showAsButton:!0,isOtherFiles:!0,w:"100%",id:"Form_".concat(t,"logo"),title:"Add Template",mb:4,info:"This is where you upload your SVG file to generate a template from.",helperText:"Click to select upload an SVG file to use as a template.",message:"Drag and Drop file here",hoverMessage:"Drop the file here",ruleMessage:"Make sure you're uploading a .svg file.",useImageText:"Use File",onChange:(e,t)=>{C(!1),y(e,t)}},"Form_".concat(t,"logo"))}):null,(0,a.jsxs)(c.xu,{height:"50vh",pos:"relative",overflowY:"auto",children:[Object.values(o).map(((e,t)=>(0,a.jsx)(x,{...e,onClick:()=>{C(!1),w(e)},border:v&&v.id===(null===e||void 0===e?void 0:e.id)?"1px dashed":"none",borderRadius:v&&v.id===(null===e||void 0===e?void 0:e.id)?"5px":"0px",_hover:{opacity:"0.4"},onDelete:m&&m.length>0&&!m.includes(e.id)?_:null},t))),!y&&E?(0,a.jsxs)(c.xu,{w:"100%",textAlign:"center",fontSize:"14px",pb:"0.5rem",children:[(0,a.jsx)(l.x,{as:"div",children:"Can't find the type you want?"}),(0,a.jsx)(l.x,{as:"a",href:E,target:"_blank",color:"#38a169",textDecoration:"underline",children:"Click here to tell us what you want."})]}):null]})]}):null,(0,a.jsx)(r(),{id:"42ccd62b5c30613c",children:".image-selector-button{width:100%;min-width:0px;outline:2px solid transparent;outline-offset:2px;position:relative;-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;-webkit-transition-property:var(--chakra-transition-property-common);-moz-transition-timing-function:var(--chakra-transition-property-common);-o-transition-timing-function:var(--chakra-transition-property-common);transition-property:var(--chakra-transition-property-common);-webkit-transition-duration:var(--chakra-transition-duration-normal);-moz-transition-duration:var(--chakra-transition-duration-normal);-o-transition-duration:var(--chakra-transition-duration-normal);transition-duration:var(--chakra-transition-duration-normal);font-size:var(--chakra-fontSizes-md);-webkit-padding-start:var(--chakra-space-4);-moz-padding-start:var(--chakra-space-4);padding-inline-start:var(--chakra-space-4);-webkit-padding-end:var(--chakra-space-10);-moz-padding-end:var(--chakra-space-10);padding-inline-end:var(--chakra-space-10);height:var(--chakra-sizes-10);-webkit-border-radius:var(--chakra-radii-md);-moz-border-radius:var(--chakra-radii-md);border-radius:var(--chakra-radii-md);border:1px solid;border-color:inherit;background:inherit}"})]})}},25723:function(e,t,n){n.d(t,{_v:function(){return i},dq:function(){return s},tD:function(){return r}});var a=n(5121),o=n(11802);function r(e){const t=e.split("."),n=t.length>1&&t.pop()||"";return{name:t.join("."),ext:n}}const i=e=>new Promise((t=>setTimeout(t,e))),s=async function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const l=[];for(const d of t){const{id:t,file:u,fileName:h,dir:f,onFileName:p}=d,{name:g,ext:m}=r(u.name),x=p?p(g,m):h||u.name;try{const r=await e.getIdToken(),i=await a.Z.post("".concat(o.Lu,"/get-presigned-url"),{id:t,fileName:x,fileType:u.type,dir:f},{headers:{Authorization:r}}),{presignedUrl:s}=i.data;if(200===(await a.Z.put(s,u,{headers:{"Content-Type":u.type}})).status){const e=n?"".concat(n).concat(n.endsWith("/")?"":"/").concat(f||"").concat((f||"").endsWith("/")?"":"/").concat(x):s.split("?")[0];l.push({id:t,url:e})}else l.push({id:t,url:"",error:"Upload failed"})}catch(c){console.log("parsedSvg: error",t,c),l.push({id:t,url:"",error:c.message})}await i(s)}return l}},80203:function(e,t,n){function a(e){return new Promise((t=>{const n=new Image;n.onload=()=>t(n),n.src=e}))}function o(e){return e.toDataURL()}function r(e,t,n){const a=document.createElement("canvas"),o=a.getContext("2d");return o&&(a.width=t,a.height=n,o.drawImage(e,0,0,t,n)),a}function i(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function s(e,t){return new Promise(((n,a)=>{const o=document.createElement("canvas");o.width=e.width,o.height=e.height;const r=o.getContext("2d");if(!r)return a(new Error("Could not get canvas context"));r.drawImage(e,0,0);const i=r.getImageData(0,0,e.width,e.height).data,s=t=>{for(let n=0;n<e.width;n++){const a=4*(t*e.width+n);if(0!==i[a+3])return!1}return!0};let l=0;for(let t=0;t<e.height&&s(t);t++)l++;if(l>=t)return n(e);const c=t-l,d=document.createElement("canvas");d.width=e.width,d.height=e.height;const u=d.getContext("2d");if(!u)return a(new Error("Could not get canvas context"));u.clearRect(0,0,d.width,d.height),u.drawImage(e,0,0,e.width,e.height-c,0,c,e.width,e.height-c),n(d)}))}function l(e,t,n,a,o,r,i,s,l,c,d){const u=document.createElement("canvas"),h=u.getContext("2d");if(!h)throw new Error("Could not get canvas context");if(u.width=s,u.height=l,h.translate(s/2,l/2),h.rotate(t*Math.PI/180),h.transform(n,o,r,a,0,0),i){const e=i.x-s/2,t=i.y-l/2;h.translate(e,t)}h.drawImage(e,-e.width/2,-e.height/2);const f=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d");if(!o)throw new Error("Could not get canvas context");o.clearRect(0,0,a.width,a.height);const{topLeft:r,topRight:i,bottomRight:s,bottomLeft:l}=t;return o.beginPath(),o.moveTo(r.x,r.y),o.lineTo(i.x,i.y),o.lineTo(s.x,s.y),o.lineTo(l.x,l.y),o.closePath(),o.save(),o.clip(),o.drawImage(e,0,0),o.restore(),n&&(o.strokeStyle=n,o.lineWidth=2,o.beginPath(),o.moveTo(r.x,r.y),o.lineTo(i.x,i.y),o.lineTo(s.x,s.y),o.lineTo(l.x,l.y),o.closePath(),o.stroke()),a}(u,c,null===d||void 0===d?void 0:d.border);return f}async function c(e){const t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("Could not get canvas context");t.width=e.width,t.height=e.height,n.drawImage(e,0,0);const a=n.getImageData(0,0,t.width,t.height).data,o=await function(e){return new Promise(((t,n)=>{const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d");if(!o)return n(new Error("Could not get canvas context"));o.drawImage(e,0,0);const r=o.getImageData(0,0,a.width,a.height),i=r.data,s=[];for(let e=0;e<r.height;e++)for(let t=0;t<r.width;t++){const n=4*(e*r.width+t),a=i[n],o=i[n+1];i[n+2]>=200&&a<50&&o<50&&s.push({x:t,y:e})}if(0===s.length)return t(null);const l={x:1/0,y:1/0},c={x:-1/0,y:1/0},d={x:1/0,y:-1/0},u={x:-1/0,y:-1/0};s.forEach((e=>{e.x+e.y<l.x+l.y&&(l.x=e.x,l.y=e.y),e.x-e.y>c.x-c.y&&(c.x=e.x,c.y=e.y),e.x-e.y<d.x-d.y&&(d.x=e.x,d.y=e.y),e.x+e.y>u.x+u.y&&(u.x=e.x,u.y=e.y)})),t({topLeft:l,topRight:c,bottomRight:u,bottomLeft:d})}))}(e);if(!o)throw new Error("Blue border box not found!");const{topLeft:r,topRight:s,bottomLeft:l,bottomRight:c}=o;let d={x:[],y:[]};for(let i=0;i<t.height;i++)for(let e=0;e<t.width;e++){const n=4*(i*t.width+e),o=a[n],r=a[n+1],s=a[n+2];255===o&&0===r&&0===s&&(d.x.push(e),d.y.push(i))}if(!r||!c)throw new Error("Bounding box corners not found");const u=await function(e){return new Promise(((t,n)=>{const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d");if(!o)return n(new Error("Could not get canvas context"));o.drawImage(e,0,0);const r=o.getImageData(0,0,a.width,a.height).data;let i={x:1/0,y:0},s={x:0,y:1/0},l={x:0,y:0},c={x:0,y:0};for(let e=0;e<a.height;e++)for(let t=0;t<a.width;t++){const n=4*(e*a.width+t),o=(r[n],r[n+1]);r[n+2],255===o&&(t<i.x&&(i={x:t,y:e}),t>l.x&&(l={x:t,y:e}),e<s.y&&(s={x:t,y:e}),e>c.y&&(c={x:t,y:e}))}const d=e.height>e.width,u=d?i:s,h=d?l:c;if(!u||!h)return n(new Error("No green line found"));t({startPoint:u,endPoint:h})}))}(e),{startPoint:h,endPoint:f}=u,p=(g=h,m=f,{x:Math.round((g.x+m.x)/2),y:Math.round((g.y+m.y)/2)});var g,m;const x={x:d.x[d.x.length-1],y:d.y[d.y.length-1]},v=Math.round(i(x,p)),w={x:x.x,y:x.y+v},y=2*(e.height>e.width?-1:1)+Math.round(function(e,t,n){const{x:a,y:o}=e,{x:r,y:i}=t,{x:s,y:l}=n;function c(e,t){return Math.atan2(t-o,e-a)}const d=c(r,i);let u=c(s,l)-d;u<0&&(u+=2*Math.PI);return u*(180/Math.PI)}(x,w,p));let b=parseFloat((i(r,s)/e.width).toPrecision(12)),k=parseFloat((i(r,l)/e.height).toPrecision(12));b+=.04,k+=.04;return{rotationAngle:y,scaleX:b,scaleY:k,shearX:0,shearY:0,center:x,width:e.width,height:e.height,corners:o}}async function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3?arguments[3]:void 0,c=await a(t);const{rotationAngle:d,scaleX:u,scaleY:h,shearX:f,shearY:p,center:g,width:m,height:x,corners:v}=e;c.width===m&&c.height===x||(c=x>m?r(c,m,x):r(c,x,m));const w=Math.round(n*c.height/100);c=await s(c,w);const y=l(c,d,u,h,f,p,g,m,x,v,i);return o(y)}n.d(t,{RA:function(){return c},cr:function(){return d},qM:function(){return a}})},10151:function(e,t,n){n.d(t,{l:function(){return o}});class a{random(){const e=1e4*Math.sin(this.seed++);return e-Math.floor(e)}randomInt(e,t){return Math.floor(this.random()*(t-e+1))+e}constructor(e){this.seed=e}}function o(e,t,n){if(!e||!t)return"";function o(o,r,i){const s=n?function(e,t,n,a){if(null===e||void 0===e||null===n||void 0===n||null===t||void 0===t||null===a||void 0===a)return 0;const o=(e+Object.keys(n).filter((e=>a(e))).map((e=>n[e].toString().replace(/\s+/g,""))).join("")+t.toString()).toLowerCase();let r=0;for(let i=0;i<o.length;i++)r=(r<<5)-r+o.charCodeAt(i),r|=0;return r}(e,i,t,n):1e6*Math.random(),l=new a(s),c=e=>"string"===typeof e&&e.endsWith("d"),d=e=>!isNaN(e)&&!c("".concat(e));if(d(o)&&d(r))return l.randomInt(parseInt(o),parseInt(r)).toString();if(c(o)&&c(r)){const e=parseInt(o),t=parseInt(r);let n="",a=0;const i=l.randomInt(e,t);for(;a<i;){n+=l.randomInt(1,9).toString(),a=n.length}return n}if(c(o)){const e=parseInt(o);let t=l.randomInt(1,9).toString();for(let n=1;n<e;n++){t+=l.randomInt(0,9).toString()}return t}return d(o)?Math.round(l.random()*parseInt(o)).toString():"Invalid arguments for randomNumber function: "+"Min: ".concat(o," - ").concat(typeof o," | Max: ").concat(r," - ").concat(typeof r)}function r(e){if(!t)return"";const n=(e=e.replace(/[{}]+/g,"")).match(/(.+)\[w(\d+)\]/);if(n){const[,e,a]=n;return(t[e]||"").split(" ")[parseInt(a)-1]||""}return e in t?t[e]:""}function i(e,t,n){var a=null;if("cut"===t)if(n&&2==n.length)try{var o=parseInt(n[0]),r=parseInt(n[1]);a=e.substring(o-1,r)}catch(i){}return a}const s=[];let l=0,c=e.replace(/\(([^()]*)\)/g,((e,t)=>{if(t.startsWith("rn[")){const[e,n]=t.slice(3,-1).split(",");return o(e,n,l++)}if(t.match(/^([^*]+)(\*{1,2})(\d+)$/)){const[,e,n,a]=t.match(/^([^*]+)(\*{1,2})(\d+)$/)||[],o=parseInt(a);if("*"==n)return e.repeat(o);{const t="<".concat(Math.floor(1e9*Math.random()),">");return s.push({id:t,char:e,count:o}),t}}if(t.includes("{")&&t.includes("}")){var n=function(e){const t=/{([^{}]+?)}(\.\w+\[(.*?)\])?/g,n=[];let a;for(;null!==(a=t.exec(e));){const e=a[1],t=a[2]?a[2].split("[")[0].slice(1):null,o=a[3]?a[3].split(",").map((e=>e.trim())):[],r=a.index,i=a.index+a[0].length-1;n.push({varKey:e,varFunc:t||void 0,varFuncArgs:o.length?o:void 0,replacementStart:r,replacementEnd:i})}return n}(t);n.sort(((e,t)=>t.replacementStart-e.replacementStart));for(const e of n){var a=r(e.varKey);if(e.varFunc&&(a=i(a,e.varFunc,e.varFuncArgs)),!(a&&t.length>0)){t="";break}c=t,d=a,u=e.replacementStart,h=e.replacementEnd,t=c.slice(0,u)+d+c.slice(h+1)}return t}return t;var c,d,u,h}));for(const a of s){const e=c.length-a.id.length;if(e>=a.count)break;const t=a.char.repeat(a.count-e);c=c.replace(a.id,t)}return c}}}]);